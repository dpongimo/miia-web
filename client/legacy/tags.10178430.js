import{W as n,C as t,D as e,_ as r,a as i,b as o,c as a,i as u,s as c,d as s,S as l,Z as f,e as h,f as d,g as p,j as v,k as y,v as m,l as g,z as b,o as _,$ as w,B as x,O as k,t as E,h as j,R as P,m as O,u as S,n as A,A as I,p as D,r as R,q as K,y as C,M as T,a0 as $,a1 as B,N as M,I as F,J as N,E as q,G as V,H as U,L,K as W,P as z,a2 as G,a3 as H,F as Y,X}from"./client.9d5b7c5c.js";import{G as Q,I as J,T as Z}from"./TagSearch.8be4b4c4.js";import{P as nn}from"./PageSection.39481e90.js";var tn=function(){return(tn=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)};function en(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;var r=Array(n),i=0;for(t=0;t<e;t++)for(var o=arguments[t],a=0,u=o.length;a<u;a++,i++)r[i]=o[a];return r}var rn=Object.keys,on=Array.isArray,an="undefined"!=typeof self?self:"undefined"!=typeof window?window:global;function un(t,e){return"object"!==n(e)||rn(e).forEach((function(n){t[n]=e[n]})),t}"undefined"==typeof Promise||an.Promise||(an.Promise=Promise);var cn=Object.getPrototypeOf,sn={}.hasOwnProperty;function ln(n,t){return sn.call(n,t)}function fn(n,t){"function"==typeof t&&(t=t(cn(n))),rn(t).forEach((function(e){dn(n,e,t[e])}))}var hn=Object.defineProperty;function dn(n,t,e,r){hn(n,t,un(e&&ln(e,"get")&&"function"==typeof e.get?{get:e.get,set:e.set,configurable:!0}:{value:e,configurable:!0,writable:!0},r))}function pn(n){return{from:function(t){return n.prototype=Object.create(t.prototype),dn(n.prototype,"constructor",n),{extend:fn.bind(null,n.prototype)}}}}var vn=Object.getOwnPropertyDescriptor;var yn=[].slice;function mn(n,t,e){return yn.call(n,t,e)}function gn(n,t){return t(n)}function bn(n){if(!n)throw new Error("Assertion Failed")}function _n(n){an.setImmediate?setImmediate(n):setTimeout(n,0)}function wn(n,t){return n.reduce((function(n,e,r){var i=t(e,r);return i&&(n[i[0]]=i[1]),n}),{})}function xn(n,t){if(ln(n,t))return n[t];if(!t)return n;if("string"!=typeof t){for(var e=[],r=0,i=t.length;r<i;++r){var o=xn(n,t[r]);e.push(o)}return e}var a=t.indexOf(".");if(-1!==a){var u=n[t.substr(0,a)];return void 0===u?void 0:xn(u,t.substr(a+1))}}function kn(n,t,e){if(n&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(n)))if("string"!=typeof t&&"length"in t){bn("string"!=typeof e&&"length"in e);for(var r=0,i=t.length;r<i;++r)kn(n,t[r],e[r])}else{var o=t.indexOf(".");if(-1!==o){var a=t.substr(0,o),u=t.substr(o+1);if(""===u)void 0===e?on(n)&&!isNaN(parseInt(a))?n.splice(a,1):delete n[a]:n[a]=e;else{var c=n[a];c||(c=n[a]={}),kn(c,u,e)}}else void 0===e?on(n)&&!isNaN(parseInt(t))?n.splice(t,1):delete n[t]:n[t]=e}}function En(n){var t={};for(var e in n)ln(n,e)&&(t[e]=n[e]);return t}var jn=[].concat;function Pn(n){return jn.apply([],n)}var On="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(Pn([8,16,32,64].map((function(n){return["Int","Uint","Float"].map((function(t){return t+n+"Array"}))})))).filter((function(n){return an[n]})),Sn=On.map((function(n){return an[n]})),An=wn(On,(function(n){return[n,!0]}));function In(t){if(!t||"object"!==n(t))return t;var e;if(on(t)){e=[];for(var r=0,i=t.length;r<i;++r)e.push(In(t[r]))}else if(Sn.indexOf(t.constructor)>=0)e=t;else for(var o in e=t.constructor?Object.create(t.constructor.prototype):{},t)ln(t,o)&&(e[o]=In(t[o]));return e}var Dn={}.toString;function Rn(n){return Dn.call(n).slice(8,-1)}var Kn=function n(t,e){return"Array"===e?""+t.map((function(t){return n(t,Rn(t))})):"ArrayBuffer"===e?""+new Uint8Array(t):"Date"===e?t.getTime():ArrayBuffer.isView(t)?""+new Uint8Array(t.buffer):t};function Cn(t,e,r,i){return r=r||{},i=i||"",rn(t).forEach((function(o){if(ln(e,o)){var a=t[o],u=e[o];if("object"===n(a)&&"object"===n(u)&&a&&u){var c=Rn(a),s=Rn(u);c===s?An[c]?Kn(a,c)!==Kn(u,s)&&(r[i+o]=e[o]):Cn(a,u,r,i+o+"."):r[i+o]=e[o]}else a!==u&&(r[i+o]=e[o])}else r[i+o]=void 0})),rn(e).forEach((function(n){ln(t,n)||(r[i+n]=e[n])})),r}var Tn="undefined"!=typeof Symbol&&Symbol.iterator,$n=Tn?function(n){var t;return null!=n&&(t=n[Tn])&&t.apply(n)}:function(){return null},Bn={};function Mn(n){var t,e,r,i;if(1===arguments.length){if(on(n))return n.slice();if(this===Bn&&"string"==typeof n)return[n];if(i=$n(n)){for(e=[];!(r=i.next()).done;)e.push(r.value);return e}if(null==n)return[n];if("number"==typeof(t=n.length)){for(e=new Array(t);t--;)e[t]=n[t];return e}return[n]}for(t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return e}var Fn="undefined"!=typeof Symbol?function(n){return"AsyncFunction"===n[Symbol.toStringTag]}:function(){return!1},Nn="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function qn(n,t){Nn=n,Vn=t}var Vn=function(){return!0},Un=!new Error("").stack;function Ln(){if(Un)try{throw new Error}catch(n){return n}return new Error}function Wn(n,t){var e=n.stack;return e?(t=t||0,0===e.indexOf(n.name)&&(t+=(n.name+n.message).split("\n").length),e.split("\n").slice(t).filter(Vn).map((function(n){return"\n"+n})).join("")):""}var zn=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Gn=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(zn),Hn={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function Yn(n,t){this._e=Ln(),this.name=n,this.message=t}function Xn(n,t){return n+". Errors: "+Object.keys(t).map((function(n){return t[n].toString()})).filter((function(n,t,e){return e.indexOf(n)===t})).join("\n")}function Qn(n,t,e,r){this._e=Ln(),this.failures=t,this.failedKeys=r,this.successCount=e,this.message=Xn(n,t)}function Jn(n,t){this._e=Ln(),this.name="BulkError",this.failures=t,this.message=Xn(n,t)}pn(Yn).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Wn(this._e,2))}},toString:function(){return this.name+": "+this.message}}),pn(Qn).from(Yn),pn(Jn).from(Yn);var Zn=Gn.reduce((function(n,t){return n[t]=t+"Error",n}),{}),nt=Yn,tt=Gn.reduce((function(t,e){var r=e+"Error";function i(t,i){this._e=Ln(),this.name=r,t?"string"==typeof t?(this.message=t+(i?"\n "+i:""),this.inner=i||null):"object"===n(t)&&(this.message=t.name+" "+t.message,this.inner=t):(this.message=Hn[e]||r,this.inner=null)}return pn(i).from(nt),t[e]=i,t}),{});tt.Syntax=SyntaxError,tt.Type=TypeError,tt.Range=RangeError;var et=zn.reduce((function(n,t){return n[t+"Error"]=tt[t],n}),{});var rt=Gn.reduce((function(n,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(n[t+"Error"]=tt[t]),n}),{});function it(){}function ot(n){return n}function at(n,t){return null==n||n===ot?t:function(e){return t(n(e))}}function ut(n,t){return function(){n.apply(this,arguments),t.apply(this,arguments)}}function ct(n,t){return n===it?t:function(){var e=n.apply(this,arguments);void 0!==e&&(arguments[0]=e);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?ut(r,this.onsuccess):r),i&&(this.onerror=this.onerror?ut(i,this.onerror):i),void 0!==o?o:e}}function st(n,t){return n===it?t:function(){n.apply(this,arguments);var e=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),e&&(this.onsuccess=this.onsuccess?ut(e,this.onsuccess):e),r&&(this.onerror=this.onerror?ut(r,this.onerror):r)}}function lt(n,t){return n===it?t:function(e){var r=n.apply(this,arguments);un(e,r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?ut(i,this.onsuccess):i),o&&(this.onerror=this.onerror?ut(o,this.onerror):o),void 0===r?void 0===a?void 0:a:un(r,a)}}function ft(n,t){return n===it?t:function(){return!1!==t.apply(this,arguments)&&n.apply(this,arguments)}}function ht(n,t){return n===it?t:function(){var e=n.apply(this,arguments);if(e&&"function"==typeof e.then){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return e.then((function(){return t.apply(r,o)}))}return t.apply(this,arguments)}}rt.ModifyError=Qn,rt.DexieError=Yn,rt.BulkError=Jn;var dt={},pt="undefined"==typeof Promise?[]:function(){var n=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[n,n.__proto__,n];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,t.__proto__,n]}(),vt=pt[0],yt=pt[1],mt=pt[2],gt=yt&&yt.then,bt=vt&&vt.constructor,_t=!!mt,wt=!1,xt=mt?function(){mt.then(Lt)}:an.setImmediate?setImmediate.bind(null,Lt):an.MutationObserver?function(){var n=document.createElement("div");new MutationObserver((function(){Lt(),n=null})).observe(n,{attributes:!0}),n.setAttribute("i","1")}:function(){setTimeout(Lt,0)},kt=function(n,t){Rt.push([n,t]),jt&&(xt(),jt=!1)},Et=!0,jt=!0,Pt=[],Ot=[],St=null,At=ot,It={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:de,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((function(n){try{de(n[0],n[1])}catch(n){}}))}},Dt=It,Rt=[],Kt=0,Ct=[];function Tt(t){if("object"!==n(this))throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=it,this._lib=!1;var e=this._PSD=Dt;if(Nn&&(this._stackHolder=Ln(),this._prev=null,this._numPrev=0),"function"!=typeof t){if(t!==dt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Ft(this,this._value))}this._state=null,this._value=null,++e.ref,Mt(this,t)}var $t={get:function(){var n=Dt,t=ne;function e(e,r){var i=this,o=!n.global&&(n!==Dt||t!==ne);o&&ie();var a=new Tt((function(t,a){qt(i,new Bt(fe(e,n,o),fe(r,n,o),t,a,n))}));return Nn&&Ut(a,this),a}return e.prototype=dt,e},set:function(n){dn(this,"then",n&&n.prototype===dt?$t:{get:function(){return n},set:$t.set})}};function Bt(n,t,e,r,i){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof t?t:null,this.resolve=e,this.reject=r,this.psd=i}function Mt(n,t){try{t((function(t){if(null===n._state){if(t===n)throw new TypeError("A promise cannot be resolved with itself.");var e=n._lib&&Wt();t&&"function"==typeof t.then?Mt(n,(function(n,e){t instanceof Tt?t._then(n,e):t.then(n,e)})):(n._state=!0,n._value=t,Nt(n)),e&&zt()}}),Ft.bind(null,n))}catch(t){Ft(n,t)}}function Ft(t,e){if(Ot.push(e),null===t._state){var r=t._lib&&Wt();e=At(e),t._state=!1,t._value=e,Nn&&null!==e&&"object"===n(e)&&!e._promise&&function(n,t,e){try{n.apply(null,e)}catch(n){t&&t(n)}}((function(){var n=function n(t,e){var r;return vn(t,e)||(r=cn(t))&&n(r,e)}(e,"stack");e._promise=t,dn(e,"stack",{get:function(){return wt?n&&(n.get?n.get.apply(e):n.value):t.stack}})})),function(n){Pt.some((function(t){return t._value===n._value}))||Pt.push(n)}(t),Nt(t),r&&zt()}}function Nt(n){var t=n._listeners;n._listeners=[];for(var e=0,r=t.length;e<r;++e)qt(n,t[e]);var i=n._PSD;--i.ref||i.finalize(),0===Kt&&(++Kt,kt((function(){0==--Kt&&Gt()}),[]))}function qt(n,t){if(null!==n._state){var e=n._state?t.onFulfilled:t.onRejected;if(null===e)return(n._state?t.resolve:t.reject)(n._value);++t.psd.ref,++Kt,kt(Vt,[e,n,t])}else n._listeners.push(t)}function Vt(n,t,e){try{St=t;var r,i=t._value;t._state?r=n(i):(Ot.length&&(Ot=[]),r=n(i),-1===Ot.indexOf(i)&&function(n){var t=Pt.length;for(;t;)if(Pt[--t]._value===n._value)return void Pt.splice(t,1)}(t)),e.resolve(r)}catch(n){e.reject(n)}finally{St=null,0==--Kt&&Gt(),--e.psd.ref||e.psd.finalize()}}function Ut(n,t){var e=t?t._numPrev+1:0;e<100&&(n._prev=t,n._numPrev=e)}function Lt(){Wt()&&zt()}function Wt(){var n=Et;return Et=!1,jt=!1,n}function zt(){var n,t,e;do{for(;Rt.length>0;)for(n=Rt,Rt=[],e=n.length,t=0;t<e;++t){var r=n[t];r[0].apply(null,r[1])}}while(Rt.length>0);Et=!0,jt=!0}function Gt(){var n=Pt;Pt=[],n.forEach((function(n){n._PSD.onunhandled.call(null,n._value,n)}));for(var t=Ct.slice(0),e=t.length;e;)t[--e]()}function Ht(n){return new Tt(dt,!1,n)}function Yt(n,t){var e=Dt;return function(){var r=Wt(),i=Dt;try{return ce(e,!0),n.apply(this,arguments)}catch(n){t&&t(n)}finally{ce(i,!1),r&&zt()}}}fn(Tt.prototype,{then:$t,_then:function(n,t){qt(this,new Bt(null,null,n,t,Dt))},catch:function(n){if(1===arguments.length)return this.then(null,n);var t=arguments[0],e=arguments[1];return"function"==typeof t?this.then(null,(function(n){return n instanceof t?e(n):Ht(n)})):this.then(null,(function(n){return n&&n.name===t?e(n):Ht(n)}))},finally:function(n){return this.then((function(t){return n(),t}),(function(t){return n(),Ht(t)}))},stack:{get:function(){if(this._stack)return this._stack;try{wt=!0;var n=function n(t,e,r){if(e.length===r)return e;var i="";if(!1===t._state){var o,a,u=t._value;null!=u?(o=u.name||"Error",a=u.message||u,i=Wn(u,0)):(o=u,a=""),e.push(o+(a?": "+a:"")+i)}Nn&&((i=Wn(t._stackHolder,2))&&-1===e.indexOf(i)&&e.push(i),t._prev&&n(t._prev,e,r));return e}(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=n),n}finally{wt=!1}}},timeout:function(n,t){var e=this;return n<1/0?new Tt((function(r,i){var o=setTimeout((function(){return i(new tt.Timeout(t))}),n);e.then(r,i).finally(clearTimeout.bind(null,o))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&dn(Tt.prototype,Symbol.toStringTag,"Dexie.Promise"),It.env=se(),fn(Tt,{all:function(){var n=Mn.apply(null,arguments).map(oe);return new Tt((function(t,e){0===n.length&&t([]);var r=n.length;n.forEach((function(i,o){return Tt.resolve(i).then((function(e){n[o]=e,--r||t(n)}),e)}))}))},resolve:function(n){if(n instanceof Tt)return n;if(n&&"function"==typeof n.then)return new Tt((function(t,e){n.then(t,e)}));var t=new Tt(dt,!0,n);return Ut(t,St),t},reject:Ht,race:function(){var n=Mn.apply(null,arguments).map(oe);return new Tt((function(t,e){n.map((function(n){return Tt.resolve(n).then(t,e)}))}))},PSD:{get:function(){return Dt},set:function(n){return Dt=n}},newPSD:ee,usePSD:le,scheduler:{get:function(){return kt},set:function(n){kt=n}},rejectionMapper:{get:function(){return At},set:function(n){At=n}},follow:function(n,t){return new Tt((function(e,r){return ee((function(t,e){var r=Dt;r.unhandleds=[],r.onunhandled=e,r.finalize=ut((function(){var n=this;!function(n){Ct.push((function t(){n(),Ct.splice(Ct.indexOf(t),1)})),++Kt,kt((function(){0==--Kt&&Gt()}),[])}((function(){0===n.unhandleds.length?t():e(n.unhandleds[0])}))}),r.finalize),n()}),t,e,r)}))}}),bt&&(bt.allSettled&&dn(Tt,"allSettled",(function(){var n=Mn.apply(null,arguments).map(oe);return new Tt((function(t){0===n.length&&t([]);var e=n.length,r=new Array(e);n.forEach((function(n,i){return Tt.resolve(n).then((function(n){return r[i]={status:"fulfilled",value:n}}),(function(n){return r[i]={status:"rejected",reason:n}})).then((function(){return--e||t(r)}))}))}))})),bt.any&&"undefined"!=typeof AggregateError&&dn(Tt,"any",(function(){var n=Mn.apply(null,arguments).map(oe);return new Tt((function(t,e){0===n.length&&e(new AggregateError([]));var r=n.length,i=new Array(r);n.forEach((function(n,o){return Tt.resolve(n).then((function(n){return t(n)}),(function(n){i[o]=n,--r||e(new AggregateError(i))}))}))}))})));var Xt={awaits:0,echoes:0,id:0},Qt=0,Jt=[],Zt=0,ne=0,te=0;function ee(n,t,e,r){var i=Dt,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++te;var a=It.env;o.env=_t?{Promise:Tt,PromiseProp:{value:Tt,configurable:!0,writable:!0},all:Tt.all,race:Tt.race,allSettled:Tt.allSettled,any:Tt.any,resolve:Tt.resolve,reject:Tt.reject,nthen:he(a.nthen,o),gthen:he(a.gthen,o)}:{},t&&un(o,t),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=le(o,n,e,r);return 0===o.ref&&o.finalize(),u}function re(){return Xt.id||(Xt.id=++Qt),++Xt.awaits,Xt.echoes+=100,Xt.id}function ie(n){!Xt.awaits||n&&n!==Xt.id||(0==--Xt.awaits&&(Xt.id=0),Xt.echoes=100*Xt.awaits)}function oe(n){return Xt.echoes&&n&&n.constructor===bt?(re(),n.then((function(n){return ie(),n}),(function(n){return ie(),pe(n)}))):n}function ae(n){++ne,Xt.echoes&&0!=--Xt.echoes||(Xt.echoes=Xt.id=0),Jt.push(Dt),ce(n,!0)}function ue(){var n=Jt[Jt.length-1];Jt.pop(),ce(n,!1)}function ce(n,t){var e,r=Dt;if((t?!Xt.echoes||Zt++&&n===Dt:!Zt||--Zt&&n===Dt)||(e=t?ae.bind(null,n):ue,gt.call(vt,e)),n!==Dt&&(Dt=n,r===It&&(It.env=se()),_t)){var i=It.env.Promise,o=n.env;yt.then=o.nthen,i.prototype.then=o.gthen,(r.global||n.global)&&(Object.defineProperty(an,"Promise",o.PromiseProp),i.all=o.all,i.race=o.race,i.resolve=o.resolve,i.reject=o.reject,o.allSettled&&(i.allSettled=o.allSettled),o.any&&(i.any=o.any))}}function se(){var n=an.Promise;return _t?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(an,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject,nthen:yt.then,gthen:n.prototype.then}:{}}function le(n,t,e,r,i){var o=Dt;try{return ce(n,!0),t(e,r,i)}finally{ce(o,!1)}}function fe(n,t,e){return"function"!=typeof n?n:function(){var r=Dt;e&&re(),ce(t,!0);try{return n.apply(this,arguments)}finally{ce(r,!1)}}}function he(n,t){return function(e,r){return n.call(this,fe(e,t,!1),fe(r,t,!1))}}-1===(""+gt).indexOf("[native code]")&&(re=ie=it);function de(n,t){var e;try{e=t.onuncatched(n)}catch(n){}if(!1!==e)try{var r,i={promise:t,reason:n};if(an.document&&document.createEvent?((r=document.createEvent("Event")).initEvent("unhandledrejection",!0,!0),un(r,i)):an.CustomEvent&&un(r=new CustomEvent("unhandledrejection",{detail:i}),i),r&&an.dispatchEvent&&(dispatchEvent(r),!an.PromiseRejectionEvent&&an.onunhandledrejection))try{an.onunhandledrejection(r)}catch(n){}Nn&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(n.stack||n))}catch(n){}}var pe=Tt.reject;var ve=String.fromCharCode(65535),ye="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",me=[],ge="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),be=ge,_e=ge,we=function(n){return!/(dexie\.js|dexie\.min\.js)/.test(n)};function xe(n,t){return n?t?function(){return n.apply(this,arguments)&&t.apply(this,arguments)}:n:t}var ke={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1},Ee=function(){function t(){}return t.prototype._trans=function(n,t,e){var r=this._tx||Dt.trans,i=this.name;function o(n,e,r){if(!r.schema[i])throw new tt.NotFound("Table "+i+" not part of transaction");return t(r.idbtrans,r)}var a=Wt();try{return r&&r.db===this.db?r===Dt.trans?r._promise(n,o,e):ee((function(){return r._promise(n,o,e)}),{trans:r,transless:Dt.transless||Dt}):function n(t,e,r,i){if(t._state.openComplete||Dt.letThrough){var o=t._createTransaction(e,r,t._dbSchema);try{o.create()}catch(n){return pe(n)}return o._promise(e,(function(n,t){return ee((function(){return Dt.trans=o,i(n,t,o)}))})).then((function(n){return o._completion.then((function(){return n}))}))}if(!t._state.isBeingOpened){if(!t._options.autoOpen)return pe(new tt.DatabaseClosed);t.open().catch(it)}return t._state.dbReadyPromise.then((function(){return n(t,e,r,i)}))}(this.db,n,[this.name],o)}finally{a&&zt()}},t.prototype.get=function(n,t){var e=this;return n&&n.constructor===Object?this.where(n).first(t):this._trans("readonly",(function(t){return e.core.get({trans:t,key:n}).then((function(n){return e.hook.reading.fire(n)}))})).then(t)},t.prototype.where=function(n){if("string"==typeof n)return new this.db.WhereClause(this,n);if(on(n))return new this.db.WhereClause(this,"["+n.join("+")+"]");var t=rn(n);if(1===t.length)return this.where(t[0]).equals(n[t[0]]);var e=this.schema.indexes.concat(this.schema.primKey).filter((function(n){return n.compound&&t.every((function(t){return n.keyPath.indexOf(t)>=0}))&&n.keyPath.every((function(n){return t.indexOf(n)>=0}))}))[0];if(e&&this.db._maxKey!==ve)return this.where(e.name).equals(e.keyPath.map((function(t){return n[t]})));!e&&Nn&&console.warn("The query "+JSON.stringify(n)+" on "+this.name+" would benefit of a compound index ["+t.join("+")+"]");var r=this.schema.idxByName,i=this.db._deps.indexedDB;function o(n,t){try{return 0===i.cmp(n,t)}catch(n){return!1}}var a=t.reduce((function(t,e){var i=t[0],a=t[1],u=r[e],c=n[e];return[i||u,i||!u?xe(a,u&&u.multi?function(n){var t=xn(n,e);return on(t)&&t.some((function(n){return o(c,n)}))}:function(n){return o(c,xn(n,e))}):a]}),[null,null]),u=a[0],c=a[1];return u?this.where(u.name).equals(n[u.keyPath]).filter(c):e?this.filter(c):this.where(t).equals("")},t.prototype.filter=function(n){return this.toCollection().and(n)},t.prototype.count=function(n){return this.toCollection().count(n)},t.prototype.offset=function(n){return this.toCollection().offset(n)},t.prototype.limit=function(n){return this.toCollection().limit(n)},t.prototype.each=function(n){return this.toCollection().each(n)},t.prototype.toArray=function(n){return this.toCollection().toArray(n)},t.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},t.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,on(n)?"["+n.join("+")+"]":n))},t.prototype.reverse=function(){return this.toCollection().reverse()},t.prototype.mapToClass=function(n){this.schema.mappedClass=n;var t=function(t){if(!t)return t;var e=Object.create(n.prototype);for(var r in t)if(ln(t,r))try{e[r]=t[r]}catch(n){}return e};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=t,this.hook("reading",t),n},t.prototype.defineClass=function(){return this.mapToClass((function(n){un(this,n)}))},t.prototype.add=function(n,t){var e=this;return this._trans("readwrite",(function(r){return e.core.mutate({trans:r,type:"add",keys:null!=t?[t]:null,values:[n]})})).then((function(n){return n.numFailures?Tt.reject(n.failures[0]):n.lastResult})).then((function(t){if(!e.core.schema.primaryKey.outbound)try{kn(n,e.core.schema.primaryKey.keyPath,t)}catch(n){}return t}))},t.prototype.update=function(t,e){if("object"!==n(e)||on(e))throw new tt.InvalidArgument("Modifications must be an object.");if("object"!==n(t)||on(t))return this.where(":id").equals(t).modify(e);rn(e).forEach((function(n){kn(t,n,e[n])}));var r=xn(t,this.schema.primKey.keyPath);return void 0===r?pe(new tt.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(r).modify(e)},t.prototype.put=function(n,t){var e=this;return this._trans("readwrite",(function(r){return e.core.mutate({trans:r,type:"put",values:[n],keys:null!=t?[t]:null})})).then((function(n){return n.numFailures?Tt.reject(n.failures[0]):n.lastResult})).then((function(t){if(!e.core.schema.primaryKey.outbound)try{kn(n,e.core.schema.primaryKey.keyPath,t)}catch(n){}return t}))},t.prototype.delete=function(n){var t=this;return this._trans("readwrite",(function(e){return t.core.mutate({trans:e,type:"delete",keys:[n]})})).then((function(n){return n.numFailures?Tt.reject(n.failures[0]):void 0}))},t.prototype.clear=function(){var n=this;return this._trans("readwrite",(function(t){return n.core.mutate({trans:t,type:"deleteRange",range:ke})})).then((function(n){return n.numFailures?Tt.reject(n.failures[0]):void 0}))},t.prototype.bulkGet=function(n){var t=this;return this._trans("readonly",(function(e){return t.core.getMany({keys:n,trans:e})}))},t.prototype.bulkAdd=function(n,t,e){var r=this,i=Array.isArray(t)?t:void 0,o=(e=e||(i?void 0:t))?e.allKeys:void 0;return this._trans("readwrite",(function(t){if(!r.core.schema.primaryKey.outbound&&i)throw new tt.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==n.length)throw new tt.InvalidArgument("Arguments objects and keys must have the same length");var e=n.length;return r.core.mutate({trans:t,type:"add",keys:i,values:n,wantResults:o}).then((function(n){var t=n.numFailures,i=n.results,a=n.lastResult,u=n.failures;if(0===t)return o?i:a;throw new Jn(r.name+".bulkAdd(): "+t+" of "+e+" operations failed",Object.keys(u).map((function(n){return u[n]})))}))}))},t.prototype.bulkPut=function(n,t,e){var r=this,i=Array.isArray(t)?t:void 0,o=(e=e||(i?void 0:t))?e.allKeys:void 0;return this._trans("readwrite",(function(t){if(!r.core.schema.primaryKey.outbound&&i)throw new tt.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==n.length)throw new tt.InvalidArgument("Arguments objects and keys must have the same length");var e=n.length;return r.core.mutate({trans:t,type:"put",keys:i,values:n,wantResults:o}).then((function(n){var t=n.numFailures,i=n.results,a=n.lastResult,u=n.failures;if(0===t)return o?i:a;throw new Jn(r.name+".bulkPut(): "+t+" of "+e+" operations failed",Object.keys(u).map((function(n){return u[n]})))}))}))},t.prototype.bulkDelete=function(n){var t=this,e=n.length;return this._trans("readwrite",(function(e){return t.core.mutate({trans:e,type:"delete",keys:n})})).then((function(n){var r=n.numFailures,i=n.lastResult,o=n.failures;if(0===r)return i;throw new Jn(t.name+".bulkDelete(): "+r+" of "+e+" operations failed",o)}))},t}();function je(t){var e={},r=function(n,r){if(r){for(var i=arguments.length,o=new Array(i-1);--i;)o[i-1]=arguments[i];return e[n].subscribe.apply(null,o),t}if("string"==typeof n)return e[n]};r.addEventType=a;for(var i=1,o=arguments.length;i<o;++i)a(arguments[i]);return r;function a(t,i,o){if("object"===n(t))return u(t);i||(i=ft),o||(o=it);var a={subscribers:[],fire:o,subscribe:function(n){-1===a.subscribers.indexOf(n)&&(a.subscribers.push(n),a.fire=i(a.fire,n))},unsubscribe:function(n){a.subscribers=a.subscribers.filter((function(t){return t!==n})),a.fire=a.subscribers.reduce(i,o)}};return e[t]=r[t]=a,a}function u(n){rn(n).forEach((function(t){var e=n[t];if(on(e))a(t,n[t][0],n[t][1]);else{if("asap"!==e)throw new tt.InvalidArgument("Invalid event config");var r=a(t,ot,(function(){for(var n=arguments.length,t=new Array(n);n--;)t[n]=arguments[n];r.subscribers.forEach((function(n){_n((function(){n.apply(null,t)}))}))}))}}))}}function Pe(n,t){return pn(t).from({prototype:n}),t}function Oe(n,t){return!(n.filter||n.algorithm||n.or)&&(t?n.justLimit:!n.replayFilter)}function Se(n,t){n.filter=xe(n.filter,t)}function Ae(n,t,e){var r=n.replayFilter;n.replayFilter=r?function(){return xe(r(),t())}:t,n.justLimit=e&&!r}function Ie(n,t){if(n.isPrimKey)return t.primaryKey;var e=t.getIndexByKeyPath(n.index);if(!e)throw new tt.Schema("KeyPath "+n.index+" on object store "+t.name+" is not indexed");return e}function De(n,t,e){var r=Ie(n,t.schema);return t.openCursor({trans:e,values:!n.keysOnly,reverse:"prev"===n.dir,unique:!!n.unique,query:{index:r,range:n.range}})}function Re(n,t,e,r){var i=n.replayFilter?xe(n.filter,n.replayFilter()):n.filter;if(n.or){var o={},a=function(n,e,r){if(!i||i(e,r,(function(n){return e.stop(n)}),(function(n){return e.fail(n)}))){var a=e.primaryKey,u=""+a;"[object ArrayBuffer]"===u&&(u=""+new Uint8Array(a)),ln(o,u)||(o[u]=!0,t(n,e,r))}};return Promise.all([n.or._iterate(a,e),Ke(De(n,r,e),n.algorithm,a,!n.keysOnly&&n.valueMapper)])}return Ke(De(n,r,e),xe(n.algorithm,i),t,!n.keysOnly&&n.valueMapper)}function Ke(n,t,e,r){var i=Yt(r?function(n,t,i){return e(r(n),t,i)}:e);return n.then((function(n){if(n)return n.start((function(){var e=function(){return n.continue()};t&&!t(n,(function(n){return e=n}),(function(t){n.stop(t),e=it}),(function(t){n.fail(t),e=it}))||i(n.value,n,(function(n){return e=n})),e()}))}))}var Ce=function(){function n(){}return n.prototype._read=function(n,t){var e=this._ctx;return e.error?e.table._trans(null,pe.bind(null,e.error)):e.table._trans("readonly",n).then(t)},n.prototype._write=function(n){var t=this._ctx;return t.error?t.table._trans(null,pe.bind(null,t.error)):t.table._trans("readwrite",n,"locked")},n.prototype._addAlgorithm=function(n){var t=this._ctx;t.algorithm=xe(t.algorithm,n)},n.prototype._iterate=function(n,t){return Re(this._ctx,n,t,this._ctx.table.core)},n.prototype.clone=function(n){var t=Object.create(this.constructor.prototype),e=Object.create(this._ctx);return n&&un(e,n),t._ctx=e,t},n.prototype.raw=function(){return this._ctx.valueMapper=null,this},n.prototype.each=function(n){var t=this._ctx;return this._read((function(e){return Re(t,n,e,t.table.core)}))},n.prototype.count=function(n){var t=this;return this._read((function(n){var e=t._ctx,r=e.table.core;if(Oe(e,!0))return r.count({trans:n,query:{index:Ie(e,r.schema),range:e.range}}).then((function(n){return Math.min(n,e.limit)}));var i=0;return Re(e,(function(){return++i,!1}),n,r).then((function(){return i}))})).then(n)},n.prototype.sortBy=function(n,t){var e=n.split(".").reverse(),r=e[0],i=e.length-1;function o(n,t){return t?o(n[e[t]],t-1):n[r]}var a="next"===this._ctx.dir?1:-1;function u(n,t){var e=o(n,i),r=o(t,i);return e<r?-a:e>r?a:0}return this.toArray((function(n){return n.sort(u)})).then(t)},n.prototype.toArray=function(n){var t=this;return this._read((function(n){var e=t._ctx;if("next"===e.dir&&Oe(e,!0)&&e.limit>0){var r=e.valueMapper,i=Ie(e,e.table.core.schema);return e.table.core.query({trans:n,limit:e.limit,values:!0,query:{index:i,range:e.range}}).then((function(n){var t=n.result;return r?t.map(r):t}))}var o=[];return Re(e,(function(n){return o.push(n)}),n,e.table.core).then((function(){return o}))}),n)},n.prototype.offset=function(n){var t=this._ctx;return n<=0||(t.offset+=n,Oe(t)?Ae(t,(function(){var t=n;return function(n,e){return 0===t||(1===t?(--t,!1):(e((function(){n.advance(t),t=0})),!1))}})):Ae(t,(function(){var t=n;return function(){return--t<0}}))),this},n.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),Ae(this._ctx,(function(){var t=n;return function(n,e,r){return--t<=0&&e(r),t>=0}}),!0),this},n.prototype.until=function(n,t){return Se(this._ctx,(function(e,r,i){return!n(e.value)||(r(i),t)})),this},n.prototype.first=function(n){return this.limit(1).toArray((function(n){return n[0]})).then(n)},n.prototype.last=function(n){return this.reverse().first(n)},n.prototype.filter=function(n){var t,e;return Se(this._ctx,(function(t){return n(t.value)})),t=this._ctx,e=n,t.isMatch=xe(t.isMatch,e),this},n.prototype.and=function(n){return this.filter(n)},n.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},n.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},n.prototype.desc=function(){return this.reverse()},n.prototype.eachKey=function(n){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,e){n(e.key,e)}))},n.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},n.prototype.eachPrimaryKey=function(n){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,e){n(e.primaryKey,e)}))},n.prototype.keys=function(n){var t=this._ctx;t.keysOnly=!t.isMatch;var e=[];return this.each((function(n,t){e.push(t.key)})).then((function(){return e})).then(n)},n.prototype.primaryKeys=function(n){var t=this._ctx;if("next"===t.dir&&Oe(t,!0)&&t.limit>0)return this._read((function(n){var e=Ie(t,t.table.core.schema);return t.table.core.query({trans:n,values:!1,limit:t.limit,query:{index:e,range:t.range}})})).then((function(n){return n.result})).then(n);t.keysOnly=!t.isMatch;var e=[];return this.each((function(n,t){e.push(t.primaryKey)})).then((function(){return e})).then(n)},n.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},n.prototype.firstKey=function(n){return this.limit(1).keys((function(n){return n[0]})).then(n)},n.prototype.lastKey=function(n){return this.reverse().firstKey(n)},n.prototype.distinct=function(){var n=this._ctx,t=n.index&&n.table.schema.idxByName[n.index];if(!t||!t.multi)return this;var e={};return Se(this._ctx,(function(n){var t=n.primaryKey.toString(),r=ln(e,t);return e[t]=!0,!r})),this},n.prototype.modify=function(n){var t=this,e=this._ctx;return this._write((function(r){var i;if("function"==typeof n)i=n;else{var o=rn(n),a=o.length;i=function(t){for(var e=!1,r=0;r<a;++r){var i=o[r],u=n[i];xn(t,i)!==u&&(kn(t,i,u),e=!0)}return e}}var u=e.table.core,c=u.schema.primaryKey,s=c.outbound,l=c.extractKey,f="testmode"in Er?1:2e3,h=t.db.core.cmp,d=[],p=0,v=[],y=function(n,t){var e=t.failures,r=t.numFailures;p+=n-r;for(var i=0,o=rn(e);i<o.length;i++){var a=o[i];d.push(e[a])}};return t.clone().primaryKeys().then((function(n){return function t(e){var o=Math.min(f,n.length-e);return u.getMany({trans:r,keys:n.slice(e,e+o)}).then((function(a){for(var c=[],d=[],p=s?[]:null,v=[],m=0;m<o;++m){var g=a[m],b={value:In(g),primKey:n[e+m]};!1!==i.call(b,b.value,b)&&(null==b.value?v.push(n[e+m]):s||0===h(l(g),l(b.value))?(d.push(b.value),s&&p.push(n[e+m])):(v.push(n[e+m]),c.push(b.value)))}return Promise.resolve(c.length>0&&u.mutate({trans:r,type:"add",values:c}).then((function(n){for(var t in n.failures)v.splice(parseInt(t),1);y(c.length,n)}))).then((function(n){return d.length>0&&u.mutate({trans:r,type:"put",keys:p,values:d}).then((function(n){return y(d.length,n)}))})).then((function(){return v.length>0&&u.mutate({trans:r,type:"delete",keys:v}).then((function(n){return y(v.length,n)}))})).then((function(){return n.length>e+o&&t(e+f)}))}))}(0).then((function(){if(d.length>0)throw new Qn("Error modifying one or more objects",d,p,v);return n.length}))}))}))},n.prototype.delete=function(){var n=this._ctx,t=n.range;return Oe(n)&&(n.isPrimKey&&!_e||3===t.type)?this._write((function(e){var r=n.table.core.schema.primaryKey,i=t;return n.table.core.count({trans:e,query:{index:r,range:i}}).then((function(t){return n.table.core.mutate({trans:e,type:"deleteRange",range:i}).then((function(n){var e=n.failures,r=(n.lastResult,n.results,n.numFailures);if(r)throw new Qn("Could not delete some values",Object.keys(e).map((function(n){return e[n]})),t-r);return t-r}))}))})):this.modify((function(n,t){return t.value=null}))},n}();function Te(n,t){return n<t?-1:n===t?0:1}function $e(n,t){return n>t?-1:n===t?0:1}function Be(n,t,e){var r=n instanceof Ue?new n.Collection(n):n;return r._ctx.error=e?new e(t):new TypeError(t),r}function Me(n){return new n.Collection(n,(function(){return Ve("")})).limit(0)}function Fe(n,t,e,r,i,o){for(var a=Math.min(n.length,r.length),u=-1,c=0;c<a;++c){var s=t[c];if(s!==r[c])return i(n[c],e[c])<0?n.substr(0,c)+e[c]+e.substr(c+1):i(n[c],r[c])<0?n.substr(0,c)+r[c]+e.substr(c+1):u>=0?n.substr(0,u)+t[u]+e.substr(u+1):null;i(n[c],s)<0&&(u=c)}return a<r.length&&"next"===o?n+e.substr(n.length):a<n.length&&"prev"===o?n.substr(0,e.length):u<0?null:n.substr(0,u)+r[u]+e.substr(u+1)}function Ne(n,t,e,r){var i,o,a,u,c,s,l,f=e.length;if(!e.every((function(n){return"string"==typeof n})))return Be(n,"String expected.");function h(n){i=function(n){return"next"===n?function(n){return n.toUpperCase()}:function(n){return n.toLowerCase()}}(n),o=function(n){return"next"===n?function(n){return n.toLowerCase()}:function(n){return n.toUpperCase()}}(n),a="next"===n?Te:$e;var t=e.map((function(n){return{lower:o(n),upper:i(n)}})).sort((function(n,t){return a(n.lower,t.lower)}));u=t.map((function(n){return n.upper})),c=t.map((function(n){return n.lower})),s=n,l="next"===n?"":r}h("next");var d=new n.Collection(n,(function(){return qe(u[0],c[f-1]+r)}));d._ondirectionchange=function(n){h(n)};var p=0;return d._addAlgorithm((function(n,e,r){var i=n.key;if("string"!=typeof i)return!1;var h=o(i);if(t(h,c,p))return!0;for(var d=null,v=p;v<f;++v){var y=Fe(i,h,u[v],c[v],a,s);null===y&&null===d?p=v+1:(null===d||a(d,y)>0)&&(d=y)}return e(null!==d?function(){n.continue(d+l)}:r),!1})),d}function qe(n,t,e,r){return{type:2,lower:n,upper:t,lowerOpen:e,upperOpen:r}}function Ve(n){return{type:1,lower:n,upper:n}}var Ue=function(){function n(){}return Object.defineProperty(n.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!0,configurable:!0}),n.prototype.between=function(n,t,e,r){e=!1!==e,r=!0===r;try{return this._cmp(n,t)>0||0===this._cmp(n,t)&&(e||r)&&(!e||!r)?Me(this):new this.Collection(this,(function(){return qe(n,t,!e,!r)}))}catch(n){return Be(this,ye)}},n.prototype.equals=function(n){return new this.Collection(this,(function(){return Ve(n)}))},n.prototype.above=function(n){return null==n?Be(this,ye):new this.Collection(this,(function(){return qe(n,void 0,!0)}))},n.prototype.aboveOrEqual=function(n){return null==n?Be(this,ye):new this.Collection(this,(function(){return qe(n,void 0,!1)}))},n.prototype.below=function(n){return null==n?Be(this,ye):new this.Collection(this,(function(){return qe(void 0,n,!1,!0)}))},n.prototype.belowOrEqual=function(n){return null==n?Be(this,ye):new this.Collection(this,(function(){return qe(void 0,n)}))},n.prototype.startsWith=function(n){return"string"!=typeof n?Be(this,"String expected."):this.between(n,n+ve,!0,!0)},n.prototype.startsWithIgnoreCase=function(n){return""===n?this.startsWith(n):Ne(this,(function(n,t){return 0===n.indexOf(t[0])}),[n],ve)},n.prototype.equalsIgnoreCase=function(n){return Ne(this,(function(n,t){return n===t[0]}),[n],"")},n.prototype.anyOfIgnoreCase=function(){var n=Mn.apply(Bn,arguments);return 0===n.length?Me(this):Ne(this,(function(n,t){return-1!==t.indexOf(n)}),n,"")},n.prototype.startsWithAnyOfIgnoreCase=function(){var n=Mn.apply(Bn,arguments);return 0===n.length?Me(this):Ne(this,(function(n,t){return t.some((function(t){return 0===n.indexOf(t)}))}),n,ve)},n.prototype.anyOf=function(){var n=this,t=Mn.apply(Bn,arguments),e=this._cmp;try{t.sort(e)}catch(n){return Be(this,ye)}if(0===t.length)return Me(this);var r=new this.Collection(this,(function(){return qe(t[0],t[t.length-1])}));r._ondirectionchange=function(r){e="next"===r?n._ascending:n._descending,t.sort(e)};var i=0;return r._addAlgorithm((function(n,r,o){for(var a=n.key;e(a,t[i])>0;)if(++i===t.length)return r(o),!1;return 0===e(a,t[i])||(r((function(){n.continue(t[i])})),!1)})),r},n.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},n.prototype.noneOf=function(){var n=Mn.apply(Bn,arguments);if(0===n.length)return new this.Collection(this);try{n.sort(this._ascending)}catch(n){return Be(this,ye)}var t=n.reduce((function(n,t){return n?n.concat([[n[n.length-1][1],t]]):[[-1/0,t]]}),null);return t.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},n.prototype.inAnyRange=function(n,t){var e=this,r=this._cmp,i=this._ascending,o=this._descending,a=this._min,u=this._max;if(0===n.length)return Me(this);if(!n.every((function(n){return void 0!==n[0]&&void 0!==n[1]&&i(n[0],n[1])<=0})))return Be(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",tt.InvalidArgument);var c=!t||!1!==t.includeLowers,s=t&&!0===t.includeUppers;var l,f=i;function h(n,t){return f(n[0],t[0])}try{(l=n.reduce((function(n,t){for(var e=0,i=n.length;e<i;++e){var o=n[e];if(r(t[0],o[1])<0&&r(t[1],o[0])>0){o[0]=a(o[0],t[0]),o[1]=u(o[1],t[1]);break}}return e===i&&n.push(t),n}),[])).sort(h)}catch(n){return Be(this,ye)}var d=0,p=s?function(n){return i(n,l[d][1])>0}:function(n){return i(n,l[d][1])>=0},v=c?function(n){return o(n,l[d][0])>0}:function(n){return o(n,l[d][0])>=0};var y=p,m=new this.Collection(this,(function(){return qe(l[0][0],l[l.length-1][1],!c,!s)}));return m._ondirectionchange=function(n){"next"===n?(y=p,f=i):(y=v,f=o),l.sort(h)},m._addAlgorithm((function(n,t,r){for(var o=n.key;y(o);)if(++d===l.length)return t(r),!1;return!!function(n){return!p(n)&&!v(n)}(o)||(0===e._cmp(o,l[d][1])||0===e._cmp(o,l[d][0])||t((function(){f===i?n.continue(l[d][0]):n.continue(l[d][1])})),!1)})),m},n.prototype.startsWithAnyOf=function(){var n=Mn.apply(Bn,arguments);return n.every((function(n){return"string"==typeof n}))?0===n.length?Me(this):this.inAnyRange(n.map((function(n){return[n,n+ve]}))):Be(this,"startsWithAnyOf() only works with strings")},n}();function Le(n){return 1===n.length?n[0]:n}function We(n){try{return n.only([[]]),[[]]}catch(n){return ve}}function ze(n){return Yt((function(t){return Ge(t),n(t.target.error),!1}))}function Ge(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var He=function(){function n(){}return n.prototype._lock=function(){return bn(!Dt.global),++this._reculock,1!==this._reculock||Dt.global||(Dt.lockOwnerFor=this),this},n.prototype._unlock=function(){if(bn(!Dt.global),0==--this._reculock)for(Dt.global||(Dt.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var n=this._blockedFuncs.shift();try{le(n[1],n[0])}catch(n){}}return this},n.prototype._locked=function(){return this._reculock&&Dt.lockOwnerFor!==this},n.prototype.create=function(n){var t=this;if(!this.mode)return this;var e=this.db.idbdb,r=this.db._state.dbOpenError;if(bn(!this.idbtrans),!n&&!e)switch(r&&r.name){case"DatabaseClosedError":throw new tt.DatabaseClosed(r);case"MissingAPIError":throw new tt.MissingAPI(r.message,r);default:throw new tt.OpenFailed(r)}if(!this.active)throw new tt.TransactionInactive;return bn(null===this._completion._state),(n=this.idbtrans=n||e.transaction(Le(this.storeNames),this.mode)).onerror=Yt((function(e){Ge(e),t._reject(n.error)})),n.onabort=Yt((function(e){Ge(e),t.active&&t._reject(new tt.Abort(n.error)),t.active=!1,t.on("abort").fire(e)})),n.oncomplete=Yt((function(){t.active=!1,t._resolve()})),this},n.prototype._promise=function(n,t,e){var r=this;if("readwrite"===n&&"readwrite"!==this.mode)return pe(new tt.ReadOnly("Transaction is readonly"));if(!this.active)return pe(new tt.TransactionInactive);if(this._locked())return new Tt((function(i,o){r._blockedFuncs.push([function(){r._promise(n,t,e).then(i,o)},Dt])}));if(e)return ee((function(){var n=new Tt((function(n,e){r._lock();var i=t(n,e,r);i&&i.then&&i.then(n,e)}));return n.finally((function(){return r._unlock()})),n._lib=!0,n}));var i=new Tt((function(n,e){var i=t(n,e,r);i&&i.then&&i.then(n,e)}));return i._lib=!0,i},n.prototype._root=function(){return this.parent?this.parent._root():this},n.prototype.waitFor=function(n){var t=this._root(),e=Tt.resolve(n);if(t._waitingFor)t._waitingFor=t._waitingFor.then((function(){return e}));else{t._waitingFor=e,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);!function n(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=n)}()}var i=t._waitingFor;return new Tt((function(n,r){e.then((function(e){return t._waitingQueue.push(Yt(n.bind(null,e)))}),(function(n){return t._waitingQueue.push(Yt(r.bind(null,n)))})).finally((function(){t._waitingFor===i&&(t._waitingFor=null)}))}))},n.prototype.abort=function(){this.active&&this._reject(new tt.Abort),this.active=!1},n.prototype.table=function(n){var t=this._memoizedTables||(this._memoizedTables={});if(ln(t,n))return t[n];var e=this.schema[n];if(!e)throw new tt.NotFound("Table "+n+" not part of transaction");var r=new this.db.Table(n,e,this);return r.core=this.db.core.table(n),t[n]=r,r},n}();function Ye(n,t,e,r,i,o,a){return{name:n,keyPath:t,unique:e,multi:r,auto:i,compound:o,src:(e&&!a?"&":"")+(r?"*":"")+(i?"++":"")+Xe(t)}}function Xe(n){return"string"==typeof n?n:n?"["+[].join.call(n,"+")+"]":""}function Qe(n,t,e){return{name:n,primKey:t,indexes:e,mappedClass:null,idxByName:wn(e,(function(n){return[n.name,n]}))}}function Je(n){return null==n?function(){}:"string"==typeof n?function(n){return 1===n.split(".").length?function(t){return t[n]}:function(t){return xn(t,n)}}(n):function(t){return xn(t,n)}}function Ze(n,t){return"delete"===t.type?t.keys:t.keys||t.values.map(n.extractKey)}function nr(n){return[].slice.call(n)}var tr=0;function er(n){return null==n?":id":"string"==typeof n?n:"["+n.join("+")+"]"}function rr(n,t,e,r){var i=t.cmp.bind(t);function o(n){if(3===n.type)return null;if(4===n.type)throw new Error("Cannot convert never type to IDBKeyRange");var t=n.lower,r=n.upper,i=n.lowerOpen,o=n.upperOpen;return void 0===t?void 0===r?null:e.upperBound(r,!!o):void 0===r?e.lowerBound(t,!!i):e.bound(t,r,!!i,!!o)}var a=function(n,t){var e=nr(n.objectStoreNames);return{schema:{name:n.name,tables:e.map((function(n){return t.objectStore(n)})).map((function(n){var t=n.keyPath,e=n.autoIncrement,r=on(t),i=null==t,o={},a={name:n.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:i,compound:r,keyPath:t,autoIncrement:e,unique:!0,extractKey:Je(t)},indexes:nr(n.indexNames).map((function(t){return n.index(t)})).map((function(n){var t=n.name,e=n.unique,r=n.multiEntry,i=n.keyPath,a={name:t,compound:on(i),keyPath:i,unique:e,multiEntry:r,extractKey:Je(i)};return o[er(i)]=a,a})),getIndexByKeyPath:function(n){return o[er(n)]}};return o[":id"]=a.primaryKey,null!=t&&(o[er(t)]=a.primaryKey),a}))},hasGetAll:e.length>0&&"getAll"in t.objectStore(e[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(n,r),u=a.schema,c=a.hasGetAll,s=u.tables.map((function(n){return function(n){var t=n.name;return{name:t,schema:n,mutate:function(e){var r=e.trans,i=e.type,a=e.keys,u=e.values,c=e.range,s=e.wantResults;return new Promise((function(e,l){e=Yt(e);var f=r.objectStore(t),h=null==f.keyPath,d="put"===i||"add"===i;if(!d&&"delete"!==i&&"deleteRange"!==i)throw new Error("Invalid operation type: "+i);var p=(a||u||{length:1}).length;if(a&&u&&a.length!==u.length)throw new Error("Given keys array must have same length as given values array.");if(0===p)return e({numFailures:0,failures:{},results:[],lastResult:void 0});var v,y=s&&en(a||Ze(n.primaryKey,{type:i,keys:a,values:u})),m=[],g=0,b=function(n){++g,Ge(n),y&&(y[n.target._reqno]=void 0),m[n.target._reqno]=n.target.error},_=function(n){var t=n.target;y[t._reqno]=t.result};if("deleteRange"===i){if(4===c.type)return e({numFailures:g,failures:m,results:y,lastResult:void 0});v=3===c.type?f.clear():f.delete(o(c))}else{var w=d?h?[u,a]:[u,null]:[a,null],x=w[0],k=w[1];if(d)for(var E=0;E<p;++E)(v=k&&void 0!==k[E]?f[i](x[E],k[E]):f[i](x[E]))._reqno=E,y&&void 0===y[E]&&(v.onsuccess=_),v.onerror=b;else for(E=0;E<p;++E)(v=f[i](x[E]))._reqno=E,v.onerror=b}var j=function(n){var t=n.target.result;y&&(y[p-1]=t),e({numFailures:g,failures:m,results:y,lastResult:t})};v.onerror=function(n){b(n),j(n)},v.onsuccess=j}))},getMany:function(n){var e=n.trans,r=n.keys;return new Promise((function(n,i){n=Yt(n);for(var o,a=e.objectStore(t),u=r.length,c=new Array(u),s=0,l=0,f=function(t){var e=t.target;c[e._pos]=e.result,++l===s&&n(c)},h=ze(i),d=0;d<u;++d){null!=r[d]&&((o=a.get(r[d]))._pos=d,o.onsuccess=f,o.onerror=h,++s)}0===s&&n(c)}))},get:function(n){var e=n.trans,r=n.key;return new Promise((function(n,i){n=Yt(n);var o=e.objectStore(t).get(r);o.onsuccess=function(t){return n(t.target.result)},o.onerror=ze(i)}))},query:function(n){return function(e){return new Promise((function(r,i){r=Yt(r);var a=e.trans,u=e.values,c=e.limit,s=e.query,l=c===1/0?void 0:c,f=s.index,h=s.range,d=a.objectStore(t),p=f.isPrimaryKey?d:d.index(f.name),v=o(h);if(0===c)return r({result:[]});if(n){var y=u?p.getAll(v,l):p.getAllKeys(v,l);y.onsuccess=function(n){return r({result:n.target.result})},y.onerror=ze(i)}else{var m=0,g=u||!("openKeyCursor"in p)?p.openCursor(v):p.openKeyCursor(v),b=[];g.onsuccess=function(n){var t=g.result;return t?(b.push(u?t.value:t.primaryKey),++m===c?r({result:b}):void t.continue()):r({result:b})},g.onerror=ze(i)}}))}}(c),openCursor:function(n){var e=n.trans,r=n.values,i=n.query,a=n.reverse,u=n.unique;return new Promise((function(n,c){n=Yt(n);var s=i.index,l=i.range,f=e.objectStore(t),h=s.isPrimaryKey?f:f.index(s.name),d=a?u?"prevunique":"prev":u?"nextunique":"next",p=r||!("openKeyCursor"in h)?h.openCursor(o(l),d):h.openKeyCursor(o(l),d);p.onerror=ze(c),p.onsuccess=Yt((function(t){var r=p.result;if(r){r.___id=++tr,r.done=!1;var i=r.continue.bind(r),o=r.continuePrimaryKey;o&&(o=o.bind(r));var a=r.advance.bind(r),u=function(){throw new Error("Cursor not stopped")};r.trans=e,r.stop=r.continue=r.continuePrimaryKey=r.advance=function(){throw new Error("Cursor not started")},r.fail=Yt(c),r.next=function(){var n=this,t=1;return this.start((function(){return t--?n.continue():n.stop()})).then((function(){return n}))},r.start=function(n){var t=new Promise((function(n,t){n=Yt(n),p.onerror=ze(t),r.fail=t,r.stop=function(t){r.stop=r.continue=r.continuePrimaryKey=r.advance=u,n(t)}})),e=function(){if(p.result)try{n()}catch(n){r.fail(n)}else r.done=!0,r.start=function(){throw new Error("Cursor behind last entry")},r.stop()};return p.onsuccess=Yt((function(n){p.onsuccess=e,e()})),r.continue=i,r.continuePrimaryKey=o,r.advance=a,e(),t},n(r)}else n(null)}),c)}))},count:function(n){var e=n.query,r=n.trans,i=e.index,a=e.range;return new Promise((function(n,e){var u=r.objectStore(t),c=i.isPrimaryKey?u:u.index(i.name),s=o(a),l=s?c.count(s):c.count();l.onsuccess=Yt((function(t){return n(t.target.result)})),l.onerror=ze(e)}))}}}(n)})),l={};return s.forEach((function(n){return l[n.name]=n})),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(n){if(!l[n])throw new Error("Table '"+n+"' not found");return l[n]},cmp:i,MIN_KEY:-1/0,MAX_KEY:We(e),schema:u}}function ir(n,t,e,r){var i=e.IDBKeyRange;return{dbcore:function(n,t){return t.reduce((function(n,t){var e=t.create;return tn(tn({},n),e(n))}),n)}(rr(t,e.indexedDB,i,r),n.dbcore)}}function or(n,t){var e=t.db,r=ir(n._middlewares,e,n._deps,t);n.core=r.dbcore,n.tables.forEach((function(t){var e=t.name;n.core.schema.tables.some((function(n){return n.name===e}))&&(t.core=n.core.table(e),n[e]instanceof n.Table&&(n[e].core=t.core))}))}function ar(n,t,e,r){e.forEach((function(e){var i=r[e];t.forEach((function(t){e in t||(t===n.Transaction.prototype||t instanceof n.Transaction?dn(t,e,{get:function(){return this.table(e)},set:function(n){hn(this,e,{value:n,writable:!0,configurable:!0,enumerable:!0})}}):t[e]=new n.Table(e,i))}))}))}function ur(n,t){t.forEach((function(t){for(var e in t)t[e]instanceof n.Table&&delete t[e]}))}function cr(n,t){return n._cfg.version-t._cfg.version}function sr(n,t,e,r){var i=n._dbSchema,o=n._createTransaction("readwrite",n._storeNames,i);o.create(e),o._completion.catch(r);var a=o._reject.bind(o),u=Dt.transless||Dt;ee((function(){Dt.trans=o,Dt.transless=u,0===t?(rn(i).forEach((function(n){lr(e,n,i[n].primKey,i[n].indexes)})),or(n,e),Tt.follow((function(){return n.on.populate.fire(o)})).catch(a)):function(n,t,e,r){var i=[],o=n._versions,a=n._dbSchema=hr(n,n.idbdb,r),u=!1;function c(){return i.length?Tt.resolve(i.shift()(e.idbtrans)).then(c):Tt.resolve()}return o.filter((function(n){return n._cfg.version>=t})).forEach((function(o){i.push((function(){var i=a,c=o._cfg.dbschema;dr(n,i,r),dr(n,c,r),a=n._dbSchema=c;var s=function(n,t){var e,r={del:[],add:[],change:[]};for(e in n)t[e]||r.del.push(e);for(e in t){var i=n[e],o=t[e];if(i){var a={name:e,def:o,recreate:!1,del:[],add:[],change:[]};if(i.primKey.src===o.primKey.src||ge){var u=i.idxByName,c=o.idxByName,s=void 0;for(s in u)c[s]||a.del.push(s);for(s in c){var l=u[s],f=c[s];l?l.src!==f.src&&a.change.push(f):a.add.push(f)}(a.del.length>0||a.add.length>0||a.change.length>0)&&r.change.push(a)}else a.recreate=!0,r.change.push(a)}else r.add.push([e,o])}return r}(i,c);s.add.forEach((function(n){lr(r,n[0],n[1].primKey,n[1].indexes)})),s.change.forEach((function(n){if(n.recreate)throw new tt.Upgrade("Not yet support for changing primary key");var t=r.objectStore(n.name);n.add.forEach((function(n){return fr(t,n)})),n.change.forEach((function(n){t.deleteIndex(n.name),fr(t,n)})),n.del.forEach((function(n){return t.deleteIndex(n)}))}));var l=o._cfg.contentUpgrade;if(l&&o._cfg.version>t){or(n,r),u=!0;var f=En(c);s.del.forEach((function(n){f[n]=i[n]})),ur(n,[n.Transaction.prototype]),ar(n,[n.Transaction.prototype],rn(f),f),e.schema=f;var h,d=Fn(l);d&&re();var p=Tt.follow((function(){if((h=l(e))&&d){var n=ie.bind(null,null);h.then(n,n)}}));return h&&"function"==typeof h.then?Tt.resolve(h):p.then((function(){return h}))}})),i.push((function(t){u&&be||function(n,t){for(var e=0;e<t.db.objectStoreNames.length;++e){var r=t.db.objectStoreNames[e];null==n[r]&&t.db.deleteObjectStore(r)}}(o._cfg.dbschema,t);ur(n,[n.Transaction.prototype]),ar(n,[n.Transaction.prototype],n._storeNames,n._dbSchema),e.schema=n._dbSchema}))})),c().then((function(){var n,t;t=r,rn(n=a).forEach((function(e){t.db.objectStoreNames.contains(e)||lr(t,e,n[e].primKey,n[e].indexes)}))}))}(n,t,o,e).catch(a)}))}function lr(n,t,e,r){var i=n.db.createObjectStore(t,e.keyPath?{keyPath:e.keyPath,autoIncrement:e.auto}:{autoIncrement:e.auto});return r.forEach((function(n){return fr(i,n)})),i}function fr(n,t){n.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function hr(n,t,e){var r={};return mn(t.objectStoreNames,0).forEach((function(n){for(var t=e.objectStore(n),i=t.keyPath,o=Ye(Xe(i),i||"",!1,!1,!!t.autoIncrement,i&&"string"!=typeof i,!0),a=[],u=0;u<t.indexNames.length;++u){var c=t.index(t.indexNames[u]);i=c.keyPath;var s=Ye(c.name,i,!!c.unique,!!c.multiEntry,!1,i&&"string"!=typeof i,!1);a.push(s)}r[n]=Qe(n,o,a)})),r}function dr(n,t,e){for(var r=e.db.objectStoreNames,i=0;i<r.length;++i){var o=r[i],a=e.objectStore(o);n._hasGetAll="getAll"in a;for(var u=0;u<a.indexNames.length;++u){var c=a.indexNames[u],s=a.index(c).keyPath,l="string"==typeof s?s:"["+mn(s).join("+")+"]";if(t[o]){var f=t[o].idxByName[l];f&&(f.name=c,delete t[o].idxByName[l],t[o].idxByName[c]=f)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&an.WorkerGlobalScope&&an instanceof an.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}var pr,vr=function(){function n(){}return n.prototype._parseStoresSpec=function(n,t){rn(n).forEach((function(e){if(null!==n[e]){var r=n[e].split(",").map((function(n,t){var e=(n=n.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(e)?e.match(/^\[(.*)\]$/)[1].split("+"):e;return Ye(e,r||null,/\&/.test(n),/\*/.test(n),/\+\+/.test(n),on(r),0===t)})),i=r.shift();if(i.multi)throw new tt.Schema("Primary key cannot be multi-valued");r.forEach((function(n){if(n.auto)throw new tt.Schema("Only primary key can be marked as autoIncrement (++)");if(!n.keyPath)throw new tt.Schema("Index must have a name and cannot be an empty string")})),t[e]=Qe(e,i,r)}}))},n.prototype.stores=function(n){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?un(this._cfg.storesSource,n):n;var e=t._versions,r={},i={};return e.forEach((function(n){un(r,n._cfg.storesSource),i=n._cfg.dbschema={},n._parseStoresSpec(r,i)})),t._dbSchema=i,ur(t,[t._allTables,t,t.Transaction.prototype]),ar(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],rn(i),i),t._storeNames=rn(i),this},n.prototype.upgrade=function(n){return this._cfg.contentUpgrade=n,this},n}();function yr(n){return ee((function(){return Dt.letThrough=!0,n()}))}function mr(n){var t=n._state,e=n._deps.indexedDB;if(t.isBeingOpened||n.idbdb)return t.dbReadyPromise.then((function(){return t.dbOpenError?pe(t.dbOpenError):n}));Nn&&(t.openCanceller._stackHolder=Ln()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.dbReadyResolve,i=null;return Tt.race([t.openCanceller,new Tt((function(r,o){if(!e)throw new tt.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var a=n.name,u=t.autoSchema?e.open(a):e.open(a,Math.round(10*n.verno));if(!u)throw new tt.MissingAPI("IndexedDB API not available");u.onerror=ze(o),u.onblocked=Yt(n._fireOnBlocked),u.onupgradeneeded=Yt((function(r){if(i=u.transaction,t.autoSchema&&!n._options.allowEmptyDB){u.onerror=Ge,i.abort(),u.result.close();var c=e.deleteDatabase(a);c.onsuccess=c.onerror=Yt((function(){o(new tt.NoSuchDatabase("Database "+a+" doesnt exist"))}))}else{i.onerror=ze(o);var s=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;n.idbdb=u.result,sr(n,s/10,i,o)}}),o),u.onsuccess=Yt((function(){i=null;var e=n.idbdb=u.result,o=mn(e.objectStoreNames);if(o.length>0)try{var c=e.transaction(Le(o),"readonly");t.autoSchema?function(n,t,e){n.verno=t.version/10;var r=n._dbSchema=hr(0,t,e);n._storeNames=mn(t.objectStoreNames,0),ar(n,[n._allTables],rn(r),r)}(n,e,c):dr(n,n._dbSchema,c),or(n,c)}catch(n){}me.push(n),e.onversionchange=Yt((function(e){t.vcFired=!0,n.on("versionchange").fire(e)})),pr.add(a),r()}),o)}))]).then((function(){return t.onReadyBeingFired=[],Tt.resolve(yr(n.on.ready.fire)).then((function n(){if(t.onReadyBeingFired.length>0){var e=t.onReadyBeingFired.reduce(ht,it);return t.onReadyBeingFired=[],Tt.resolve(yr(e)).then(n)}}))})).finally((function(){t.onReadyBeingFired=null})).then((function(){return t.isBeingOpened=!1,n})).catch((function(e){try{i&&i.abort()}catch(n){}return t.isBeingOpened=!1,n.close(),t.dbOpenError=e,pe(t.dbOpenError)})).finally((function(){t.openComplete=!0,r()}))}function gr(n){var t=function(t){return n.next(t)},e=i(t),r=i((function(t){return n.throw(t)}));function i(n){return function(t){var i=n(t),o=i.value;return i.done?o:o&&"function"==typeof o.then?o.then(e,r):on(o)?Promise.all(o).then(e,r):e(o)}}return i(t)()}function br(n,t,e){var r=arguments.length;if(r<2)throw new tt.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];e=i.pop();var o=Pn(i);return[n,o,e]}function _r(n,t,e,r,i){return Tt.resolve().then((function(){var o=Dt.transless||Dt,a=n._createTransaction(t,e,n._dbSchema,r),u={trans:a,transless:o};r?a.idbtrans=r.idbtrans:a.create();var c,s=Fn(i);s&&re();var l=Tt.follow((function(){if(c=i.call(a,a))if(s){var n=ie.bind(null,null);c.then(n,n)}else"function"==typeof c.next&&"function"==typeof c.throw&&(c=gr(c))}),u);return(c&&"function"==typeof c.then?Tt.resolve(c).then((function(n){return a.active?n:pe(new tt.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):l.then((function(){return c}))).then((function(n){return r&&a._resolve(),a._completion.then((function(){return n}))})).catch((function(n){return a._reject(n),pe(n)}))}))}function wr(n,t,e){for(var r=on(n)?n.slice():[n],i=0;i<e;++i)r.push(t);return r}var xr={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return tn(tn({},n),{table:function(t){var e=n.table(t),r=e.schema,i={},o=[];function a(n,t,e){var r=er(n),u=i[r]=i[r]||[],c=null==n?0:"string"==typeof n?1:n.length,s=t>0,l=tn(tn({},e),{isVirtual:s,isPrimaryKey:!s&&e.isPrimaryKey,keyTail:t,keyLength:c,extractKey:Je(n),unique:!s&&e.unique});(u.push(l),l.isPrimaryKey||o.push(l),c>1)&&a(2===c?n[0]:n.slice(0,c-1),t+1,e);return u.sort((function(n,t){return n.keyTail-t.keyTail})),l}var u=a(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[u];for(var c=0,s=r.indexes;c<s.length;c++){var l=s[c];a(l.keyPath,0,l)}function f(t){var e,r,i=t.query.index;return i.isVirtual?tn(tn({},t),{query:{index:i,range:(e=t.query.range,r=i.keyTail,{type:1===e.type?2:e.type,lower:wr(e.lower,e.lowerOpen?n.MAX_KEY:n.MIN_KEY,r),lowerOpen:!0,upper:wr(e.upper,e.upperOpen?n.MIN_KEY:n.MAX_KEY,r),upperOpen:!0})}}):t}return tn(tn({},e),{schema:tn(tn({},r),{primaryKey:u,indexes:o,getIndexByKeyPath:function(n){var t=i[er(n)];return t&&t[0]}}),count:function(n){return e.count(f(n))},query:function(n){return e.query(f(n))},openCursor:function(t){var r=t.query.index,i=r.keyTail,o=r.isVirtual,a=r.keyLength;if(!o)return e.openCursor(t);return e.openCursor(f(t)).then((function(e){return e&&function(e){return Object.create(e,{continue:{value:function(r){null!=r?e.continue(wr(r,t.reverse?n.MAX_KEY:n.MIN_KEY,i)):t.unique?e.continue(wr(e.key,t.reverse?n.MIN_KEY:n.MAX_KEY,i)):e.continue()}},continuePrimaryKey:{value:function(t,r){e.continuePrimaryKey(wr(t,n.MAX_KEY,i),r)}},key:{get:function(){var n=e.key;return 1===a?n[0]:n.slice(0,a)}},value:{get:function(){return e.value}}})}(e)}))}})}})}},kr={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return tn(tn({},n),{table:function(t){var e=n.table(t),r=e.schema.primaryKey;return tn(tn({},e),{mutate:function(n){var i=Dt.trans,o=i.table(t).hook,a=o.deleting,u=o.creating,c=o.updating;switch(n.type){case"add":if(u.fire===it)break;return i._promise("readwrite",(function(){return s(n)}),!0);case"put":if(u.fire===it&&c.fire===it)break;return i._promise("readwrite",(function(){return s(n)}),!0);case"delete":if(a.fire===it)break;return i._promise("readwrite",(function(){return s(n)}),!0);case"deleteRange":if(a.fire===it)break;return i._promise("readwrite",(function(){return function(n){return function n(t,i,o){return e.query({trans:t,values:!1,query:{index:r,range:i},limit:o}).then((function(e){var r=e.result;return s({type:"delete",keys:r,trans:t}).then((function(e){return e.numFailures>0?Promise.reject(e.failures[0]):r.length<o?{failures:[],numFailures:0,lastResult:void 0}:n(t,tn(tn({},i),{lower:r[r.length-1],lowerOpen:!0}),o)}))}))}(n.trans,n.range,1e4)}(n)}),!0)}return e.mutate(n);function s(n){var t=Dt.trans,i=n.keys||Ze(r,n);if(!i)throw new Error("Keys missing");return"delete"!==(n="add"===n.type||"put"===n.type?tn(tn({},n),{keys:i,wantResults:!0}):tn({},n)).type&&(n.values=en(n.values)),n.keys&&(n.keys=en(n.keys)),function(n,t,e){return"add"===t.type?Promise.resolve(new Array(t.values.length)):n.getMany({trans:t.trans,keys:e})}(e,n,i).then((function(o){var s=i.map((function(e,i){var s=o[i],l={onerror:null,onsuccess:null};if("delete"===n.type)a.fire.call(l,e,s,t);else if("add"===n.type||void 0===s){var f=u.fire.call(l,e,n.values[i],t);null==e&&null!=f&&(e=f,n.keys[i]=e,r.outbound||kn(n.values[i],r.keyPath,e))}else{var h=Cn(s,n.values[i]),d=c.fire.call(l,h,e,s,t);if(d){var p=n.values[i];Object.keys(d).forEach((function(n){kn(p,n,d[n])}))}}return l}));return e.mutate(n).then((function(t){for(var e=t.failures,r=t.results,a=t.numFailures,u=t.lastResult,c=0;c<i.length;++c){var l=r?r[c]:i[c],f=s[c];null==l?f.onerror&&f.onerror(e[c]):f.onsuccess&&f.onsuccess("put"===n.type&&o[c]?n.values[c]:l)}return{failures:e,results:r,numFailures:a,lastResult:u}})).catch((function(n){return s.forEach((function(t){return t.onerror&&t.onerror(n)})),Promise.reject(n)}))}))}}})}})}},Er=function(){function n(t,e){var r=this;this._middlewares={},this.verno=0;var i=n.dependencies;this._options=e=tn({addons:n.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},e),this._deps={indexedDB:e.indexedDB,IDBKeyRange:e.IDBKeyRange};var o=e.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null;var a={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:it,dbReadyPromise:null,cancelOpen:it,openCanceller:null,autoSchema:!0};a.dbReadyPromise=new Tt((function(n){a.dbReadyResolve=n})),a.openCanceller=new Tt((function(n,t){a.cancelOpen=t})),this._state=a,this.name=t,this.on=je(this,"populate","blocked","versionchange",{ready:[ht,it]}),this.on.ready.subscribe=gn(this.on.ready.subscribe,(function(t){return function(e,i){n.vip((function(){var n=r._state;if(n.openComplete)n.dbOpenError||Tt.resolve().then(e),i&&t(e);else if(n.onReadyBeingFired)n.onReadyBeingFired.push(e),i&&t(e);else{t(e);var o=r;i||t((function n(){o.on.ready.unsubscribe(e),o.on.ready.unsubscribe(n)}))}}))}})),this.Collection=function(n){return Pe(Ce.prototype,(function(t,e){this.db=n;var r=ke,i=null;if(e)try{r=e()}catch(n){i=n}var o=t._ctx,a=o.table,u=a.hook.reading.fire;this._ctx={table:a,index:o.index,isPrimKey:!o.index||a.schema.primKey.keyPath&&o.index===a.schema.primKey.name,range:r,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:i,or:o.or,valueMapper:u!==ot?u:null}}))}(this),this.Table=function(n){return Pe(Ee.prototype,(function(t,e,r){this.db=n,this._tx=r,this.name=t,this.schema=e,this.hook=n._allTables[t]?n._allTables[t].hook:je(null,{creating:[ct,it],reading:[at,ot],updating:[lt,it],deleting:[st,it]})}))}(this),this.Transaction=function(n){return Pe(He.prototype,(function(t,e,r,i){var o=this;this.db=n,this.mode=t,this.storeNames=e,this.schema=r,this.idbtrans=null,this.on=je(this,"complete","error","abort"),this.parent=i||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Tt((function(n,t){o._resolve=n,o._reject=t})),this._completion.then((function(){o.active=!1,o.on.complete.fire()}),(function(n){var t=o.active;return o.active=!1,o.on.error.fire(n),o.parent?o.parent._reject(n):t&&o.idbtrans&&o.idbtrans.abort(),pe(n)}))}))}(this),this.Version=function(n){return Pe(vr.prototype,(function(t){this.db=n,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(n){return Pe(Ue.prototype,(function(t,e,r){this.db=n,this._ctx={table:t,index:":id"===e?null:e,or:r};var i=n._deps.indexedDB;if(!i)throw new tt.MissingAPI("indexedDB API missing");this._cmp=this._ascending=i.cmp.bind(i),this._descending=function(n,t){return i.cmp(t,n)},this._max=function(n,t){return i.cmp(n,t)>0?n:t},this._min=function(n,t){return i.cmp(n,t)<0?n:t},this._IDBKeyRange=n._deps.IDBKeyRange}))}(this),this.on("versionchange",(function(n){n.newVersion>0?console.warn("Another connection wants to upgrade database '"+r.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+r.name+"'. Closing db now to resume the delete request."),r.close()})),this.on("blocked",(function(n){!n.newVersion||n.newVersion<n.oldVersion?console.warn("Dexie.delete('"+r.name+"') was blocked"):console.warn("Upgrade '"+r.name+"' blocked by other connection holding version "+n.oldVersion/10)})),this._maxKey=We(e.IDBKeyRange),this._createTransaction=function(n,t,e,i){return new r.Transaction(n,t,e,i)},this._fireOnBlocked=function(n){r.on("blocked").fire(n),me.filter((function(n){return n.name===r.name&&n!==r&&!n._state.vcFired})).map((function(t){return t.on("versionchange").fire(n)}))},this.use(xr),this.use(kr),o.forEach((function(n){return n(r)}))}return n.prototype.version=function(n){if(isNaN(n)||n<.1)throw new tt.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new tt.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var t=this._versions,e=t.filter((function(t){return t._cfg.version===n}))[0];return e||(e=new this.Version(n),t.push(e),t.sort(cr),e.stores({}),this._state.autoSchema=!1,e)},n.prototype._whenReady=function(n){var t=this;return this._state.openComplete||Dt.letThrough?n():new Tt((function(n,e){if(!t._state.isBeingOpened){if(!t._options.autoOpen)return void e(new tt.DatabaseClosed);t.open().catch(it)}t._state.dbReadyPromise.then(n,e)})).then(n)},n.prototype.use=function(n){var t=n.stack,e=n.create,r=n.level,i=n.name;i&&this.unuse({stack:t,name:i});var o=this._middlewares[t]||(this._middlewares[t]=[]);return o.push({stack:t,create:e,level:null==r?10:r,name:i}),o.sort((function(n,t){return n.level-t.level})),this},n.prototype.unuse=function(n){var t=n.stack,e=n.name,r=n.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter((function(n){return r?n.create!==r:!!e&&n.name!==e}))),this},n.prototype.open=function(){return mr(this)},n.prototype.close=function(){var n=me.indexOf(this),t=this._state;if(n>=0&&me.splice(n,1),this.idbdb){try{this.idbdb.close()}catch(n){}this.idbdb=null}this._options.autoOpen=!1,t.dbOpenError=new tt.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError),t.dbReadyPromise=new Tt((function(n){t.dbReadyResolve=n})),t.openCanceller=new Tt((function(n,e){t.cancelOpen=e}))},n.prototype.delete=function(){var n=this,t=arguments.length>0,e=this._state;return new Tt((function(r,i){var o=function(){n.close();var t=n._deps.indexedDB.deleteDatabase(n.name);t.onsuccess=Yt((function(){pr.remove(n.name),r()})),t.onerror=ze(i),t.onblocked=n._fireOnBlocked};if(t)throw new tt.InvalidArgument("Arguments not allowed in db.delete()");e.isBeingOpened?e.dbReadyPromise.then(o):o()}))},n.prototype.backendDB=function(){return this.idbdb},n.prototype.isOpen=function(){return null!==this.idbdb},n.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&"DatabaseClosed"===n.name},n.prototype.hasFailed=function(){return null!==this._state.dbOpenError},n.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(n.prototype,"tables",{get:function(){var n=this;return rn(this._allTables).map((function(t){return n._allTables[t]}))},enumerable:!0,configurable:!0}),n.prototype.transaction=function(){var n=br.apply(this,arguments);return this._transaction.apply(this,n)},n.prototype._transaction=function(n,t,e){var r=this,i=Dt.trans;i&&i.db===this&&-1===n.indexOf("!")||(i=null);var o,a,u=-1!==n.indexOf("?");n=n.replace("!","").replace("?","");try{if(a=t.map((function(n){var t=n instanceof r.Table?n.name:n;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t})),"r"==n||"readonly"===n)o="readonly";else{if("rw"!=n&&"readwrite"!=n)throw new tt.InvalidArgument("Invalid transaction mode: "+n);o="readwrite"}if(i){if("readonly"===i.mode&&"readwrite"===o){if(!u)throw new tt.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&a.forEach((function(n){if(i&&-1===i.storeNames.indexOf(n)){if(!u)throw new tt.SubTransaction("Table "+n+" not included in parent transaction.");i=null}})),u&&i&&!i.active&&(i=null)}}catch(n){return i?i._promise(null,(function(t,e){e(n)})):pe(n)}var c=_r.bind(null,this,o,a,i,e);return i?i._promise(o,c,"lock"):Dt.trans?le(Dt.transless,(function(){return r._whenReady(c)})):this._whenReady(c)},n.prototype.table=function(n){if(!ln(this._allTables,n))throw new tt.InvalidTable("Table "+n+" does not exist");return this._allTables[n]},n}(),jr=Er;function Pr(n,t){var e;if("undefined"==typeof Symbol||null==n[Symbol.iterator]){if(Array.isArray(n)||(e=function(n,t){if(!n)return;if("string"==typeof n)return Or(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);"Object"===e&&n.constructor&&(e=n.constructor.name);if("Map"===e||"Set"===e)return Array.from(n);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Or(n,t)}(n))||t&&n&&"number"==typeof n.length){e&&(n=e);var r=0,i=function(){};return{s:i,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=n[Symbol.iterator]()},n:function(){var n=e.next();return a=n.done,n},e:function(n){u=!0,o=n},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function Or(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}fn(jr,tn(tn({},rt),{delete:function(n){return new jr(n).delete()},exists:function(n){return new jr(n,{addons:[]}).open().then((function(n){return n.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(n){return pr?pr.getDatabaseNames().then(n):Tt.resolve([])},defineClass:function(){return function(n){un(this,n)}},ignoreTransaction:function(n){return Dt.trans?le(Dt.transless,n):n()},vip:yr,async:function(n){return function(){try{var t=gr(n.apply(this,arguments));return t&&"function"==typeof t.then?t:Tt.resolve(t)}catch(n){return pe(n)}}},spawn:function(n,t,e){try{var r=gr(n.apply(e,t||[]));return r&&"function"==typeof r.then?r:Tt.resolve(r)}catch(n){return pe(n)}},currentTransaction:{get:function(){return Dt.trans||null}},waitFor:function(n,t){var e=Tt.resolve("function"==typeof n?jr.ignoreTransaction(n):n).timeout(t||6e4);return Dt.trans?Dt.trans.waitFor(e):e},Promise:Tt,debug:{get:function(){return Nn},set:function(n){qn(n,"dexie"===n?function(){return!0}:we)}},derive:pn,extend:un,props:fn,override:gn,Events:je,getByKeyPath:xn,setByKeyPath:kn,delByKeyPath:function(n,t){"string"==typeof t?kn(n,t,void 0):"length"in t&&[].map.call(t,(function(t){kn(n,t,void 0)}))},shallowClone:En,deepClone:In,getObjectDiff:Cn,asap:_n,minKey:-1/0,addons:[],connections:me,errnames:Zn,dependencies:function(){try{return{indexedDB:an.indexedDB||an.mozIndexedDB||an.webkitIndexedDB||an.msIndexedDB,IDBKeyRange:an.IDBKeyRange||an.webkitIDBKeyRange}}catch(n){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:"3.0.1",version:"3.0.1".split(".").map((function(n){return parseInt(n)})).reduce((function(n,t,e){return n+t/Math.pow(10,2*e)})),default:jr,Dexie:jr})),jr.maxKey=We(jr.dependencies.IDBKeyRange),function(n){try{pr=function(n){var t,e=n&&"function"==typeof n.databases;if(!e){var r=new Er("__dbnames",{addons:[]});r.version(1).stores({dbnames:"name"}),t=r.table("dbnames")}return{getDatabaseNames:function(){return e?Tt.resolve(n.databases()).then((function(n){return n.map((function(n){return n.name})).filter((function(n){return"__dbnames"!==n}))})):t.toCollection().primaryKeys()},add:function(n){return!e&&"__dbnames"!==n&&t.put({name:n}).catch(it)},remove:function(n){return!e&&"__dbnames"!==n&&t.delete(n).catch(it)}}}(n)}catch(n){}}(Er.dependencies.indexedDB),Tt.rejectionMapper=function(n,t){if(!n||n instanceof Yn||n instanceof TypeError||n instanceof SyntaxError||!n.name||!et[n.name])return n;var e=new et[n.name](t||n.message,n);return"stack"in n&&dn(e,"stack",{get:function(){return this.inner.stack}}),e},qn(Nn,we);var Sr,Ar={files:"&file_id, hash, *user_tags, *service_names_to_statuses_to_tags.all_known_tags"};function Ir(){return Sr||(Sr=new Er("miia-cache")).version(1).stores(Ar),Sr.files}function Dr(){return(Dr=t(e.mark((function n(t){var r,i,o,a,u,c,s,l,f,h;return e.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=Q(),i=Ir(),o=0;case 3:if(!(o<t.length)){n.next=17;break}return a=t.slice(o,Math.min(o+20,t.length)),n.next=7,r.get_file_metadata({file_ids:a});case 7:u=n.sent,c=u.metadata,s=[],l=Pr(c);try{for(l.s();!(f=l.n()).done;)h=f.value,s.push(Rr(h))}catch(n){l.e(n)}finally{l.f()}return n.next=14,i.bulkPut(s);case 14:o+=20,n.next=3;break;case 17:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function Rr(n){if("service_names_to_statuses_to_tags"in n){var t=n.service_names_to_statuses_to_tags;for(var e in t){if(t.hasOwnProperty(e))t[e.split(" ").join("_")]=Kr(t[e]),delete t[e]}n.service_names_to_statuses_to_tags=t}return n}function Kr(n){var t=[];for(var e in n)n.hasOwnProperty(e)&&(t=t.concat(n[e]));return t}function Cr(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;return new Promise((function(e){setTimeout(e.bind(null,t),n)}))}function Tr(n){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(n){return!1}}();return function(){var e,r=i(n);if(t){var a=i(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return o(this,e)}}function $r(n){var t,e,r,i=n[13].message+"";return{c:function(){t=h("div"),e=h("pre"),r=E(i),this.h()},l:function(n){t=d(n,"DIV",{class:!0});var o=p(t);e=d(o,"PRE",{style:!0});var a=p(e);r=j(a,i),a.forEach(v),o.forEach(v),this.h()},h:function(){P(e,"color","red"),y(t,"class","card-body")},m:function(n,i){g(n,t,i),O(t,e),O(e,r)},p:function(n,t){1&t&&i!==(i=n[13].message+"")&&S(r,i)},d:function(n){n&&v(t)}}}function Br(n){var t,e,r,i;return{c:function(){t=h("img"),this.h()},l:function(n){t=d(n,"IMG",{src:!0,alt:!0,id:!0,class:!0}),this.h()},h:function(){t.src!==(e=URL.createObjectURL(n[12]))&&y(t,"src",e),y(t,"alt",n[0]),y(t,"id",n[0]),y(t,"class","svelte-1x1zhyt")},m:function(e,o){g(e,t,o),n[8](t),r||(i=[A(t,"load",n[4]),A(t,"click",n[5])],r=!0)},p:function(n,r){1&r&&t.src!==(e=URL.createObjectURL(n[12]))&&y(t,"src",e),1&r&&y(t,"alt",n[0]),1&r&&y(t,"id",n[0])},d:function(e){e&&v(t),n[8](null),r=!1,I(i)}}}function Mr(n){var t,e,r,i,o,a;return{c:function(){t=h("div"),e=h("div"),r=D(),i=h("p"),o=E("Querying "),a=E(n[0]),this.h()},l:function(u){t=d(u,"DIV",{class:!0});var c=p(t);e=d(c,"DIV",{class:!0,role:!0,"aria-hidden":!0}),p(e).forEach(v),r=R(c),i=d(c,"P",{});var s=p(i);o=j(s,"Querying "),a=j(s,n[0]),s.forEach(v),c.forEach(v),this.h()},h:function(){y(e,"class","spinner-border"),y(e,"role","status"),y(e,"aria-hidden","true"),y(t,"class","card-body loading svelte-1x1zhyt")},m:function(n,u){g(n,t,u),O(t,e),O(t,r),O(t,i),O(i,o),O(i,a)},p:function(n,t){1&t&&S(a,n[0])},d:function(n){n&&v(t)}}}function Fr(n){var t,e,r={ctx:n,current:null,token:null,pending:Mr,then:Br,catch:$r,value:12,error:13};return f(e=n[3](n[0]),r),{c:function(){t=h("div"),r.block.c(),this.h()},l:function(n){t=d(n,"DIV",{class:!0});var e=p(t);r.block.l(e),e.forEach(v),this.h()},h:function(){y(t,"class","card svelte-1x1zhyt"),m(t,"active",n[1])},m:function(n,e){g(n,t,e),r.block.m(t,r.anchor=null),r.mount=function(){return t},r.anchor=null},p:function(i,o){var a=b(o,1)[0];if(n=i,r.ctx=n,1&a&&e!==(e=n[3](n[0]))&&f(e,r));else{var u=n.slice();u[12]=r.resolved,r.block.p(u,a)}2&a&&m(t,"active",n[1])},i:_,o:_,d:function(n){n&&v(t),r.block.d(),r.token=null,r=null}}}function Nr(n,r,i){var o,a=r.file_id,u=r.max_width,c=void 0===u?200:u,s=r.max_height,l=void 0===s?200:s,f=r.active,h=void 0!==f&&f,d=w();function p(){return(p=t(e.mark((function n(t){var r;return e.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=Q(),n.next=3,r.get_thumbnail({file_id:t});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return x(t(e.mark((function n(){return e.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:case"end":return n.stop()}}),n)})))),n.$set=function(n){"file_id"in n&&i(0,a=n.file_id),"max_width"in n&&i(6,c=n.max_width),"max_height"in n&&i(7,l=n.max_height),"active"in n&&i(1,h=n.active)},[a,h,o,function(n){return p.apply(this,arguments)},function(){var n,t,e,r,a,u=(n=o.naturalWidth,t=o.naturalHeight,e=c,r=l,a=Math.min(e/n,r/t),{width:n*a,height:t*a});i(2,o.width=u.width,o),i(2,o.height=u.height,o)},function(n){d("click",{source_event:n,file_id:a,dom_image:o})},c,l,function(n){k[n?"unshift":"push"]((function(){i(2,o=n)}))}]}var qr=function(n){r(e,l);var t=Tr(e);function e(n){var r;return a(this,e),r=t.call(this),u(s(r),n,Nr,Fr,c,{file_id:0,max_width:6,max_height:7,active:1}),r}return e}();function Vr(n){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(n){return!1}}();return function(){var e,r=i(n);if(t){var a=i(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return o(this,e)}}function Ur(t){var e;function r(t,e){return"object"===n(t[0])?Wr:Lr}var i=r(t),o=i(t);return{c:function(){o.c(),e=K()},l:function(n){o.l(n),e=K()},m:function(n,t){o.m(n,t),g(n,e,t)},p:function(n,t){i===(i=r(n))&&o?o.p(n,t):(o.d(1),(o=i(n))&&(o.c(),o.m(e.parentNode,e)))},d:function(n){o.d(n),n&&v(e)}}}function Lr(n){var t,e=n[5]()+"";return{c:function(){t=E(e)},l:function(n){t=j(n,e)},m:function(n,e){g(n,t,e)},p:_,d:function(n){n&&v(t)}}}function Wr(n){var t,e,r={ctx:n,current:null,token:null,pending:Xr,then:Gr,catch:zr,value:10,error:11};return f(e=n[4](n[1]),r),{c:function(){t=K(),r.block.c()},l:function(n){t=K(),r.block.l(n)},m:function(n,e){g(n,t,e),r.block.m(n,r.anchor=e),r.mount=function(){return t.parentNode},r.anchor=t},p:function(t,i){if(n=t,r.ctx=n,2&i&&e!==(e=n[4](n[1]))&&f(e,r));else{var o=n.slice();o[10]=r.resolved,r.block.p(o,i)}},d:function(n){n&&v(t),r.block.d(n),r.token=null,r=null}}}function zr(n){var t,e,r,i,o=n[11].message+"";return{c:function(){t=h("div"),e=h("pre"),r=E(o),i=D(),this.h()},l:function(n){t=d(n,"DIV",{class:!0});var a=p(t);e=d(a,"PRE",{class:!0});var u=p(e);r=j(u,o),u.forEach(v),i=R(a),a.forEach(v),this.h()},h:function(){y(e,"class","svelte-1xd984e"),y(t,"class","error svelte-1xd984e")},m:function(n,o){g(n,t,o),O(t,e),O(e,r),O(t,i)},p:function(n,t){2&t&&o!==(o=n[11].message+"")&&S(r,o)},d:function(n){n&&v(t)}}}function Gr(n){var t,e;function r(n,e){return(null==t||1&e)&&(t=!!J(n[0].mime)),t?Yr:Hr}var i=r(n,-1),o=i(n);return{c:function(){o.c(),e=K()},l:function(n){o.l(n),e=K()},m:function(n,t){o.m(n,t),g(n,e,t)},p:function(n,t){i===(i=r(n,t))&&o?o.p(n,t):(o.d(1),(o=i(n))&&(o.c(),o.m(e.parentNode,e)))},d:function(n){o.d(n),n&&v(e)}}}function Hr(n){var t,e,r,i,o,a,u=n[0].mime+"";return{c:function(){t=h("div"),e=h("p"),r=E("File's MIME type was "),i=h("code"),o=E(u),a=E(" which can't be handled yet.\n          "),this.h()},l:function(n){t=d(n,"DIV",{class:!0});var c=p(t);e=d(c,"P",{class:!0});var s=p(e);r=j(s,"File's MIME type was "),i=d(s,"CODE",{class:!0});var l=p(i);o=j(l,u),l.forEach(v),a=j(s," which can't be handled yet.\n          "),s.forEach(v),c.forEach(v),this.h()},h:function(){y(i,"class","svelte-1xd984e"),y(e,"class","svelte-1xd984e"),y(t,"class","error svelte-1xd984e")},m:function(n,u){g(n,t,u),O(t,e),O(e,r),O(e,i),O(i,o),O(e,a)},p:function(n,t){1&t&&u!==(u=n[0].mime+"")&&S(o,u)},d:function(n){n&&v(t)}}}function Yr(n){var t,e;return{c:function(){t=h("img"),this.h()},l:function(n){t=d(n,"IMG",{class:!0,style:!0,src:!0,alt:!0}),this.h()},h:function(){y(t,"class","img-fluid svelte-1xd984e"),P(t,"object-fit",n[3]),P(t,"width","fill"===n[3]?"100%":""),P(t,"height","fill"===n[3]?"100%":""),t.src!==(e=n[10])&&y(t,"src",e),y(t,"alt","")},m:function(n,e){g(n,t,e)},p:function(n,r){8&r&&P(t,"object-fit",n[3]),8&r&&P(t,"width","fill"===n[3]?"100%":""),8&r&&P(t,"height","fill"===n[3]?"100%":""),2&r&&t.src!==(e=n[10])&&y(t,"src",e)},d:function(n){n&&v(t)}}}function Xr(n){var t,e,r,i,o;return{c:function(){t=h("div"),r=D(),i=h("h4"),o=E(n[1]),this.h()},l:function(e){t=d(e,"DIV",{class:!0,role:!0,title:!0,"aria-hidden":!0}),p(t).forEach(v),r=R(e),i=d(e,"H4",{class:!0});var a=p(i);o=j(a,n[1]),a.forEach(v),this.h()},h:function(){y(t,"class","spinner-border svelte-1xd984e"),y(t,"role","status"),y(t,"title",e="Downloading "+n[1]),y(t,"aria-hidden","true"),y(i,"class","svelte-1xd984e")},m:function(n,e){g(n,t,e),g(n,r,e),g(n,i,e),O(i,o)},p:function(n,r){2&r&&e!==(e="Downloading "+n[1])&&y(t,"title",e),2&r&&S(o,n[1])},d:function(n){n&&v(t),n&&v(r),n&&v(i)}}}function Qr(n){var t,e=n[2]&&Ur(n);return{c:function(){e&&e.c(),t=K()},l:function(n){e&&e.l(n),t=K()},m:function(n,r){e&&e.m(n,r),g(n,t,r)},p:function(n,r){var i=b(r,1)[0];n[2]?e?e.p(n,i):((e=Ur(n)).c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},i:_,o:_,d:function(n){e&&e.d(n),n&&v(t)}}}function Jr(n,t,r){var i,o=this&&this.__awaiter||function(n,t,e,r){return new(e||(e=Promise))((function(i,o){function a(n){try{c(r.next(n))}catch(n){o(n)}}function u(n){try{c(r.throw(n))}catch(n){o(n)}}function c(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(a,u)}c((r=r.apply(n,t||[])).next())}))},a=t.file_id,u=t.metadata,c=void 0===u?void 0:u,s=t.enabled,l=void 0!==s&&s,f=t.object_fit,h=void 0===f?"cover":f,d=t.file,p=void 0===d?void 0:d;return x((function(){return function(){i&&URL.revokeObjectURL(i)}})),n.$set=function(n){"file_id"in n&&r(1,a=n.file_id),"metadata"in n&&r(0,c=n.metadata),"enabled"in n&&r(2,l=n.enabled),"object_fit"in n&&r(3,h=n.object_fit),"file"in n&&r(6,p=n.file)},[c,a,l,h,function(n){return o(this,void 0,void 0,e.mark((function n(){var t,o;return e.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i&&URL.revokeObjectURL(i),t=Q(),n.next=4,t.get_file({file_id:a});case 4:return o=n.sent,r(6,p=new File([o],String(a)+c.ext,{type:c.mime})),i=URL.createObjectURL(p),n.abrupt("return",i);case 8:case"end":return n.stop()}}),n)})))},function(){return o(this,void 0,void 0,e.mark((function n(){var t;return e.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=Ir(),n.t0=r,n.next=4,t.get({file_id:a});case 4:n.t1=c=n.sent,(0,n.t0)(0,n.t1);case 6:case"end":return n.stop()}}),n)})))},p]}var Zr=function(n){r(e,l);var t=Vr(e);function e(n){var r;return a(this,e),r=t.call(this),u(s(r),n,Jr,Qr,c,{file_id:1,metadata:0,enabled:2,object_fit:3,file:6}),r}return e}();function ni(n){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(n){return!1}}();return function(){var e,r=i(n);if(t){var a=i(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return o(this,e)}}function ti(n,t,e){var r=n.slice();return r[23]=t[e],r[25]=e,r}function ei(n){for(var t,e,r,i,o,a,u,c,s,l=[],f=new Map,b=n[7],_=function(n){return n[23]},w=0;w<b.length;w+=1){var x=ti(n,b,w),k=_(x);f.set(k,l[w]=ri(k,x))}var S=function(n){var t,e,r=n[0]>0&&ii(n),i=n[0]<n[2].length-1&&oi(n);return{c:function(){r&&r.c(),t=D(),i&&i.c(),e=K()},l:function(n){r&&r.l(n),t=R(n),i&&i.l(n),e=K()},m:function(n,o){r&&r.m(n,o),g(n,t,o),i&&i.m(n,o),g(n,e,o)},p:function(n,o){n[0]>0?r?r.p(n,o):((r=ii(n)).c(),r.m(t.parentNode,t)):r&&(r.d(1),r=null),n[0]<n[2].length-1?i?i.p(n,o):((i=oi(n)).c(),i.m(e.parentNode,e)):i&&(i.d(1),i=null)},d:function(n){r&&r.d(n),n&&v(t),i&&i.d(n),n&&v(e)}}}(n);return{c:function(){t=h("div"),e=h("div");for(var n=0;n<l.length;n+=1)l[n].c();r=D(),S&&S.c(),i=D(),o=h("button"),a=E("❌"),this.h()},l:function(n){t=d(n,"DIV",{class:!0,style:!0});var u=p(t);e=d(u,"DIV",{class:!0,style:!0});for(var c=p(e),s=0;s<l.length;s+=1)l[s].l(c);c.forEach(v),r=R(u),S&&S.l(u),i=R(u),o=d(u,"BUTTON",{class:!0});var f=p(o);a=j(f,"❌"),f.forEach(v),u.forEach(v),this.h()},h:function(){y(e,"class","files svelte-1jbgus2"),P(e,"overflow-y",n[5]?"scroll":"hidden"),m(e,"cover","cover"===n[4]),m(e,"contain","contain"===n[4]),m(e,"fill","fill"===n[4]),m(e,"smooth",null===n[9]),y(o,"class","close svelte-1jbgus2"),y(t,"class","background svelte-1jbgus2"),P(t,"--n","max("+n[7].length+", 1)"),P(t,"--i",n[8]),P(t,"--tx",(null!==n[10]?n[10]:0)+"px")},m:function(f,h){g(f,t,h),O(t,e);for(var d=0;d<l.length;d+=1)l[d].m(e,null);n[16](e),O(t,r),S&&S.m(t,null),O(t,i),O(t,o),O(o,a),u=!0,c||(s=[A(e,"dblclick",C(n[11])),A(e,"mousedown",C(n[12])),A(e,"touchstart",C(n[12])),A(e,"mousemove",C(n[14])),A(e,"touchmove",C(n[14])),A(e,"mouseup",n[13]),A(e,"touchend",C(n[13])),A(o,"click",C(n[19]))],c=!0)},p:function(n,r){if(153&r){var i=n[7];T(),l=$(l,r,_,1,n,i,f,e,B,ri,null,ti),M()}(!u||32&r)&&P(e,"overflow-y",n[5]?"scroll":"hidden"),16&r&&m(e,"cover","cover"===n[4]),16&r&&m(e,"contain","contain"===n[4]),16&r&&m(e,"fill","fill"===n[4]),512&r&&m(e,"smooth",null===n[9]),S.p(n,r),(!u||128&r)&&P(t,"--n","max("+n[7].length+", 1)"),(!u||256&r)&&P(t,"--i",n[8]),(!u||1024&r)&&P(t,"--tx",(null!==n[10]?n[10]:0)+"px")},i:function(n){if(!u){for(var t=0;t<b.length;t+=1)F(l[t]);u=!0}},o:function(n){for(var t=0;t<l.length;t+=1)N(l[t]);u=!1},d:function(e){e&&v(t);for(var r=0;r<l.length;r+=1)l[r].d();n[16](null),S&&S.d(),c=!1,I(s)}}}function ri(n,t){var e,r,i,o,a;function u(n){t[15].call(null,n)}var c={file_id:t[23],enabled:!0};return void 0!==t[4]&&(c.object_fit=t[4]),r=new Zr({props:c}),k.push((function(){return z(r,"object_fit",u)})),{key:n,first:null,c:function(){e=h("div"),q(r.$$.fragment),o=D(),this.h()},l:function(n){e=d(n,"DIV",{class:!0});var t=p(e);V(r.$$.fragment,t),o=R(t),t.forEach(v),this.h()},h:function(){y(e,"class","file svelte-1jbgus2"),m(e,"current",t[0]===t[25]+Math.max(t[0]-t[3],0)),this.first=e},m:function(n,t){g(n,e,t),U(r,e,null),O(e,o),a=!0},p:function(n,t){var o={};128&t&&(o.file_id=n[23]),!i&&16&t&&(i=!0,o.object_fit=n[4],L((function(){return i=!1}))),r.$set(o),137&t&&m(e,"current",n[0]===n[25]+Math.max(n[0]-n[3],0))},i:function(n){a||(F(r.$$.fragment,n),a=!0)},o:function(n){N(r.$$.fragment,n),a=!1},d:function(n){n&&v(e),W(r)}}}function ii(n){var t,e,r,i;return{c:function(){t=h("button"),e=E("◀"),this.h()},l:function(n){t=d(n,"BUTTON",{id:!0,class:!0});var r=p(t);e=j(r,"◀"),r.forEach(v),this.h()},h:function(){y(t,"id","previous"),y(t,"class","nav-buttons svelte-1jbgus2")},m:function(o,a){g(o,t,a),O(t,e),r||(i=A(t,"click",n[17]),r=!0)},p:_,d:function(n){n&&v(t),r=!1,i()}}}function oi(n){var t,e,r,i;return{c:function(){t=h("button"),e=E("▶"),this.h()},l:function(n){t=d(n,"BUTTON",{id:!0,class:!0});var r=p(t);e=j(r,"▶"),r.forEach(v),this.h()},h:function(){y(t,"id","next"),y(t,"class","nav-buttons svelte-1jbgus2")},m:function(o,a){g(o,t,a),O(t,e),r||(i=A(t,"click",n[18]),r=!0)},p:_,d:function(n){n&&v(t),r=!1,i()}}}function ai(n){var t,e,r=n[1]&&ei(n);return{c:function(){r&&r.c(),t=K()},l:function(n){r&&r.l(n),t=K()},m:function(n,i){r&&r.m(n,i),g(n,t,i),e=!0},p:function(n,e){var i=b(e,1)[0];n[1]?r?(r.p(n,i),2&i&&F(r,1)):((r=ei(n)).c(),F(r,1),r.m(t.parentNode,t)):r&&(T(),N(r,1,1,(function(){r=null})),M())},i:function(n){e||(F(r),e=!0)},o:function(n){N(r),e=!1},d:function(n){r&&r.d(n),n&&v(t)}}}function ui(n){return n.changedTouches?n.changedTouches[0]:n}function ci(n,t,e){this&&this.__awaiter;var r,i=t.file_ids,o=void 0===i?[]:i,a=t.index,u=void 0===a?0:a,c=t.enabled,s=void 0!==c&&c,l=t.loaded_range,f=void 0===l?2:l,h="contain",d=!1,p=[];x((function(){}));var v=0,y=null,m=0;return n.$set=function(n){"file_ids"in n&&e(2,o=n.file_ids),"index"in n&&e(0,u=n.index),"enabled"in n&&e(1,s=n.enabled),"loaded_range"in n&&e(3,f=n.loaded_range)},n.$$.update=function(){13&n.$$.dirty&&e(7,p=o.slice(Math.max(u-f,0),Math.min(u+f+1,o.length))),3&n.$$.dirty&&s&&(console.log(u),e(4,h="contain")),16&n.$$.dirty&&e(5,d="contain"!==h),9&n.$$.dirty&&e(8,v=u-Math.max(u-f,0))},[u,s,o,f,h,d,r,p,v,y,m,function(n){"contain"===h?e(4,h="cover"):"cover"===h?e(4,h="fill"):(e(4,h="contain"),r.scroll({top:0,behavior:"smooth"})),console.log("Fit is now",h)},function(n){e(9,y=ui(n).clientX)},function(n){if(null!==y){var t=ui(n).clientX-y;0===Math.sign(t)||(Math.sign(t)<0?e(0,u=Math.min(u+1,o.length)):e(0,u=Math.max(u-1,0))),e(10,m=0),e(9,y=null)}},function(n){null!==y&&e(10,m=Math.round(ui(n).clientX-y))},function(n){e(4,h=n),e(1,s),e(0,u)},function(n){k[n?"unshift":"push"]((function(){e(6,r=n)}))},function(){e(0,u--,u)},function(){e(0,u++,u)},function(){e(1,s=!1)}]}var si=function(n){r(e,l);var t=ni(e);function e(n){var r;return a(this,e),r=t.call(this),u(s(r),n,ci,ai,c,{file_ids:2,index:0,enabled:1,loaded_range:3}),r}return e}();function li(n){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(n){return!1}}();return function(){var e,r=i(n);if(t){var a=i(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return o(this,e)}}function fi(n,t){var e;if("undefined"==typeof Symbol||null==n[Symbol.iterator]){if(Array.isArray(n)||(e=function(n,t){if(!n)return;if("string"==typeof n)return hi(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);"Object"===e&&n.constructor&&(e=n.constructor.name);if("Map"===e||"Set"===e)return Array.from(n);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return hi(n,t)}(n))||t&&n&&"number"==typeof n.length){e&&(n=e);var r=0,i=function(){};return{s:i,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=n[Symbol.iterator]()},n:function(){var n=e.next();return a=n.done,n},e:function(n){u=!0,o=n},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function hi(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}var di=H.Map;function pi(n,t,e){var r=n.slice();return r[22]=t[e],r[24]=e,r}function vi(n,t){var e,r,i,o=t[24];(r=new qr({props:{file_id:t[22],active:t[1]==t[24]}})).$on("click",(function(){for(var n,e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return(n=t)[12].apply(n,[t[24]].concat(r))}));var a=function(){return t[13](e,o)},u=function(){return t[13](null,o)};return{key:n,first:null,c:function(){e=h("div"),q(r.$$.fragment),this.h()},l:function(n){e=d(n,"DIV",{class:!0});var t=p(e);V(r.$$.fragment,t),t.forEach(v),this.h()},h:function(){y(e,"class","entry svelte-bpbmli"),this.first=e},m:function(n,t){g(n,e,t),U(r,e,null),a(),i=!0},p:function(n,e){t=n;var i={};4&e&&(i.file_id=t[22]),6&e&&(i.active=t[1]==t[24]),r.$set(i),o!==t[24]&&(u(),o=t[24],a())},i:function(n){i||(F(r.$$.fragment,n),i=!0)},o:function(n){N(r.$$.fragment,n),i=!1},d:function(n){n&&v(e),W(r),u()}}}function yi(n){var t,e,r,i,o,a,u,c,s,l,f,m,b,_,w,x,k,I,K,T,$=n[2].length+"",B=n[0].length+"",M=n[2].length+"";return{c:function(){t=h("div"),e=h("div"),r=h("p"),i=E("Loaded "),o=E($),a=E(" / "),u=E(B),c=D(),s=h("div"),l=h("div"),f=E(M),_=D(),w=h("div"),x=h("button"),k=E("Load More"),this.h()},l:function(n){t=d(n,"DIV",{class:!0});var h=p(t);e=d(h,"DIV",{class:!0});var y=p(e);r=d(y,"P",{});var m=p(r);i=j(m,"Loaded "),o=j(m,$),a=j(m," / "),u=j(m,B),m.forEach(v),c=R(y),s=d(y,"DIV",{class:!0});var g=p(s);l=d(g,"DIV",{class:!0,role:!0,style:!0,"aria-valuenow":!0,"aria-valuemin":!0,"aria-valuemax":!0});var b=p(l);f=j(b,M),b.forEach(v),g.forEach(v),y.forEach(v),h.forEach(v),_=R(n),w=d(n,"DIV",{class:!0});var E=p(w);x=d(E,"BUTTON",{class:!0,disabled:!0});var P=p(x);k=j(P,"Load More"),P.forEach(v),E.forEach(v),this.h()},h:function(){y(l,"class","progress-bar"),y(l,"role","progressbar"),P(l,"width",n[2].length/n[0].length*100+"%"),y(l,"aria-valuenow",m=n[2].length),y(l,"aria-valuemin","0"),y(l,"aria-valuemax",b=n[0].length),y(s,"class","progress"),y(e,"class","col col-12"),y(t,"class","row"),y(x,"class","btn btn-primary m-3"),x.disabled=I=n[2].length>=n[0].length,y(w,"class","col")},m:function(h,d){g(h,t,d),O(t,e),O(e,r),O(r,i),O(r,o),O(r,a),O(r,u),O(e,c),O(e,s),O(s,l),O(l,f),g(h,_,d),g(h,w,d),O(w,x),O(x,k),K||(T=A(x,"click",C(n[7])),K=!0)},p:function(n,t){4&t&&$!==($=n[2].length+"")&&S(o,$),1&t&&B!==(B=n[0].length+"")&&S(u,B),4&t&&M!==(M=n[2].length+"")&&S(f,M),5&t&&P(l,"width",n[2].length/n[0].length*100+"%"),4&t&&m!==(m=n[2].length)&&y(l,"aria-valuenow",m),1&t&&b!==(b=n[0].length)&&y(l,"aria-valuemax",b),5&t&&I!==(I=n[2].length>=n[0].length)&&(x.disabled=I)},d:function(n){n&&v(t),n&&v(_),n&&v(w),K=!1,T()}}}function mi(n){var t,e,r,i,o,a,u,c,s,l,f=[],m=new di;function _(t){n[9].call(null,t)}function w(t){n[10].call(null,t)}function x(t){n[11].call(null,t)}var E={};void 0!==n[1]&&(E.index=n[1]),void 0!==n[5]&&(E.enabled=n[5]),void 0!==n[0]&&(E.file_ids=n[0]),t=new si({props:E}),k.push((function(){return z(t,"index",_)})),k.push((function(){return z(t,"enabled",w)})),k.push((function(){return z(t,"file_ids",x)}));for(var j=n[2],S=function(n){return n[22]},A=0;A<j.length;A+=1){var I=pi(n,j,A),K=S(I);m.set(K,f[A]=vi(K,I))}var C=n[0]&&n[0].length>0&&yi(n);return{c:function(){q(t.$$.fragment),o=D(),a=h("div");for(var n=0;n<f.length;n+=1)f[n].c();u=D(),c=h("div"),s=h("div"),C&&C.c(),this.h()},l:function(n){V(t.$$.fragment,n),o=R(n),a=d(n,"DIV",{class:!0});for(var e=p(a),r=0;r<f.length;r+=1)f[r].l(e);u=R(e),c=d(e,"DIV",{class:!0,style:!0});var i=p(c);s=d(i,"DIV",{class:!0});var l=p(s);C&&C.l(l),l.forEach(v),i.forEach(v),e.forEach(v),this.h()},h:function(){y(s,"class","container"),y(c,"class","next-batch-placeholder text-center svelte-bpbmli"),P(c,"background-color",n[0]&&n[0].length?"":"transparent"),y(a,"class","gallery")},m:function(e,r){U(t,e,r),g(e,o,r),g(e,a,r);for(var i=0;i<f.length;i+=1)f[i].m(a,null);O(a,u),O(a,c),O(c,s),C&&C.m(s,null),n[14](c),n[15](a),l=!0},p:function(n,o){var h=b(o,1)[0],d={};if(!e&&2&h&&(e=!0,d.index=n[1],L((function(){return e=!1}))),!r&&32&h&&(r=!0,d.enabled=n[5],L((function(){return r=!1}))),!i&&1&h&&(i=!0,d.file_ids=n[0],L((function(){return i=!1}))),t.$set(d),46&h){var p=n[2];T(),f=$(f,h,S,1,n,p,m,a,B,vi,u,pi),M()}n[0]&&n[0].length>0?C?C.p(n,h):((C=yi(n)).c(),C.m(s,null)):C&&(C.d(1),C=null),(!l||1&h)&&P(c,"background-color",n[0]&&n[0].length?"":"transparent")},i:function(n){if(!l){F(t.$$.fragment,n);for(var e=0;e<j.length;e+=1)F(f[e]);l=!0}},o:function(n){N(t.$$.fragment,n);for(var e=0;e<f.length;e+=1)N(f[e]);l=!1},d:function(e){W(t,e),e&&v(o),e&&v(a);for(var r=0;r<f.length;r+=1)f[r].d();C&&C.d(),n[14](null),n[15](null)}}}function gi(n,r,i){var o,a,u=r.file_ids,c=void 0===u?[]:u,s=[],l=r.range,f=void 0===l?10:l,h=r.index,d=void 0===h?0:h,p=0,v=[],y=[],m=0,g=!1;function b(){if(c.length>0&&c.length!==v.length){var n=v.length,t=n+f-1,e=c.slice(n,Math.min(t,c.length));!function(n){Dr.apply(this,arguments)}(e),i(2,v=v.concat(e))}}function _(){return(_=t(e.mark((function n(){return e.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(o.scrollHeight<window.innerHeight)){n.next=8;break}return b(),n.next=4,G();case 4:return n.next=6,Cr(200);case 6:n.next=0;break;case 8:case"end":return n.stop()}}),n)})))).apply(this,arguments)}x((function(){var n=new IntersectionObserver((function(n){var t,e=fi(n);try{for(e.s();!(t=e.n()).done;){switch(t.value.target){case a:b()}}}catch(n){e.e(n)}finally{e.f()}}));return n.observe(a),function(){n.disconnect()}}));return n.$set=function(n){"file_ids"in n&&i(0,c=n.file_ids),"range"in n&&i(8,f=n.range),"index"in n&&i(1,d=n.index)},n.$$.update=function(){65537&n.$$.dirty&&c!==s&&(i(16,s=c),i(18,m=0),i(1,d=0),i(17,p=0),i(2,v=[])),262146&n.$$.dirty&&i(18,m=Math.max(d,m)),262149&n.$$.dirty&&m>=v.length-2&&c.length>0&&(0===v.length?function(){_.apply(this,arguments)}():b()),131083&n.$$.dirty&&c.length>0&&d!==p&&y&&y[d]&&(i(17,p=d),y[d].scrollIntoView({behavior:"smooth",block:"center",inline:"center"}))},[c,d,v,y,o,g,a,b,f,function(n){i(1,d=n)},function(n){i(5,g=n)},function(n){i(0,c=n)},function(n,t){i(1,d=n),i(5,g=!0)},function(n,t){y[t]!==n&&k[n?"unshift":"push"]((function(){y[t]=n,i(3,y),i(2,v)}))},function(n){k[n?"unshift":"push"]((function(){i(6,a=n)}))},function(n){k[n?"unshift":"push"]((function(){i(4,o=n)}))}]}var bi=function(n){r(e,l);var t=li(e);function e(n){var r;return a(this,e),r=t.call(this),u(s(r),n,gi,mi,c,{file_ids:0,range:8,index:1}),r}return e}();function _i(n){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(n){return!1}}();return function(){var e,r=i(n);if(t){var a=i(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return o(this,e)}}function wi(n,t,e){var r=n.slice();return r[12]=t[e],r}function xi(n){var t,e,r=n[12]+"";return{c:function(){t=h("span"),e=E(r),this.h()},l:function(n){t=d(n,"SPAN",{class:!0});var i=p(t);e=j(i,r),i.forEach(v),this.h()},h:function(){y(t,"class","badge bg-secondary")},m:function(n,r){g(n,t,r),O(t,e)},p:function(n,t){2&t&&r!==(r=n[12]+"")&&S(e,r)},d:function(n){n&&v(t)}}}function ki(n){for(var t,e,r,i,o,a,u,c,s,l,f,m=n[1],b=[],_=0;_<m.length;_+=1)b[_]=xi(wi(n,m,_));return l=new Z({props:{tags:n[1],onSearch:n[4]}}),{c:function(){t=h("div"),e=h("div"),r=h("details"),i=h("summary"),o=h("span"),a=E("Search:"),u=D();for(var n=0;n<b.length;n+=1)b[n].c();c=D(),s=h("div"),q(l.$$.fragment),this.h()},l:function(n){t=d(n,"DIV",{class:!0});var f=p(t);e=d(f,"DIV",{class:!0});var h=p(e);r=d(h,"DETAILS",{});var y=p(r);i=d(y,"SUMMARY",{class:!0});var m=p(i);o=d(m,"SPAN",{});var g=p(o);a=j(g,"Search:"),g.forEach(v),u=R(m);for(var _=0;_<b.length;_+=1)b[_].l(m);m.forEach(v),c=R(y),s=d(y,"DIV",{class:!0});var w=p(s);V(l.$$.fragment,w),w.forEach(v),y.forEach(v),h.forEach(v),f.forEach(v),this.h()},h:function(){y(i,"class","card-header"),y(s,"class","card-body"),y(e,"class","card"),y(t,"class","col")},m:function(h,d){g(h,t,d),O(t,e),O(e,r),O(r,i),O(i,o),O(o,a),O(i,u);for(var p=0;p<b.length;p+=1)b[p].m(i,null);n[3](i),O(r,c),O(r,s),U(l,s,null),f=!0},p:function(n,t){if(2&t){var e;for(m=n[1],e=0;e<m.length;e+=1){var r=wi(n,m,e);b[e]?b[e].p(r,t):(b[e]=xi(r),b[e].c(),b[e].m(i,null))}for(;e<b.length;e+=1)b[e].d(1);b.length=m.length}var o={};2&t&&(o.tags=n[1]),2&t&&(o.onSearch=n[4]),l.$set(o)},i:function(n){f||(F(l.$$.fragment,n),f=!0)},o:function(n){N(l.$$.fragment,n),f=!1},d:function(e){e&&v(t),X(b,e),n[3](null),W(l)}}}function Ei(n){var t,e,r,i,o,a,u;function c(t){n[5].call(null,t)}document.title=t=n[1].join(", ")+" - Miia Web!",r=new nn({props:{$$slots:{default:[ki]},$$scope:{ctx:n}}});var s={};return void 0!==n[0]&&(s.file_ids=n[0]),o=new bi({props:s}),k.push((function(){return z(o,"file_ids",c)})),{c:function(){e=D(),q(r.$$.fragment),i=D(),q(o.$$.fragment)},l:function(n){Y('[data-svelte="svelte-k5h265"]',document.head).forEach(v),e=R(n),V(r.$$.fragment,n),i=R(n),V(o.$$.fragment,n)},m:function(n,t){g(n,e,t),U(r,n,t),g(n,i,t),U(o,n,t),u=!0},p:function(n,e){var i=b(e,1)[0];(!u||2&i)&&t!==(t=n[1].join(", ")+" - Miia Web!")&&(document.title=t);var c={};32774&i&&(c.$$scope={dirty:i,ctx:n}),r.$set(c);var s={};!a&&1&i&&(a=!0,s.file_ids=n[0],L((function(){return a=!1}))),o.$set(s)},i:function(n){u||(F(r.$$.fragment,n),F(o.$$.fragment,n),u=!0)},o:function(n){N(r.$$.fragment,n),N(o.$$.fragment,n),u=!1},d:function(n){n&&v(e),W(r,n),n&&v(i),W(o,n)}}}function ji(n,t,r){var i,o=this&&this.__awaiter||function(n,t,e,r){return new(e||(e=Promise))((function(i,o){function a(n){try{c(r.next(n))}catch(n){o(n)}}function u(n){try{c(r.throw(n))}catch(n){o(n)}}function c(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(a,u)}c((r=r.apply(n,t||[])).next())}))},a=[],u=[],c=!1;x((function(){c=!0;var n=window.location.search,t=new URLSearchParams(n),e=t.get("q");if(e){var i=JSON.parse(e);r(1,u=i)}t.get("id")}));return n.$$.update=function(){2&n.$$.dirty&&function(n){o(this,void 0,void 0,e.mark((function t(){var i,o;return e.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!c){t.next=7;break}return i=Q(),t.next=4,i.search_files(n,!0,!0);case 4:o=t.sent,r(0,a=o.file_ids),console.log("Recieved ",a.length," files.");case 7:case"end":return t.stop()}}),t)})))}(u)},[a,u,i,function(n){k[n?"unshift":"push"]((function(){r(2,i=n)}))},function(n){console.log("tags set"),r(1,u=n)},function(n){r(0,a=n)}]}var Pi=function(n){r(e,l);var t=_i(e);function e(n){var r;return a(this,e),r=t.call(this),u(s(r),n,ji,Ei,c,{}),r}return e}();export default Pi;
