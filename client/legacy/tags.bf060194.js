import{W as n,_ as t,a as e,b as r,c as i,i as o,s as a,d as u,S as c,Z as s,e as l,f,g as h,j as d,k as p,v,l as y,z as m,o as g,$ as b,B as _,C as w,D as x,O as k,t as E,h as P,R as O,m as S,u as j,n as A,A as I,p as R,r as D,q as K,M as C,J as T,N as B,I as $,E as F,G as M,H as N,K as q,P as V,y as U,L,a0 as z,a1 as W,a2 as G,a3 as H,F as Q,X as Y}from"./client.8a9f4435.js";import{G as X,I as J,T as Z}from"./TagSearch.ad8b0885.js";import{P as nn}from"./PageSection.450797b4.js";var tn=function(){return(tn=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)};function en(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;var r=Array(n),i=0;for(t=0;t<e;t++)for(var o=arguments[t],a=0,u=o.length;a<u;a++,i++)r[i]=o[a];return r}var rn=Object.keys,on=Array.isArray,an="undefined"!=typeof self?self:"undefined"!=typeof window?window:global;function un(t,e){return"object"!==n(e)||rn(e).forEach((function(n){t[n]=e[n]})),t}"undefined"==typeof Promise||an.Promise||(an.Promise=Promise);var cn=Object.getPrototypeOf,sn={}.hasOwnProperty;function ln(n,t){return sn.call(n,t)}function fn(n,t){"function"==typeof t&&(t=t(cn(n))),rn(t).forEach((function(e){dn(n,e,t[e])}))}var hn=Object.defineProperty;function dn(n,t,e,r){hn(n,t,un(e&&ln(e,"get")&&"function"==typeof e.get?{get:e.get,set:e.set,configurable:!0}:{value:e,configurable:!0,writable:!0},r))}function pn(n){return{from:function(t){return n.prototype=Object.create(t.prototype),dn(n.prototype,"constructor",n),{extend:fn.bind(null,n.prototype)}}}}var vn=Object.getOwnPropertyDescriptor;var yn=[].slice;function mn(n,t,e){return yn.call(n,t,e)}function gn(n,t){return t(n)}function bn(n){if(!n)throw new Error("Assertion Failed")}function _n(n){an.setImmediate?setImmediate(n):setTimeout(n,0)}function wn(n,t){return n.reduce((function(n,e,r){var i=t(e,r);return i&&(n[i[0]]=i[1]),n}),{})}function xn(n,t){if(ln(n,t))return n[t];if(!t)return n;if("string"!=typeof t){for(var e=[],r=0,i=t.length;r<i;++r){var o=xn(n,t[r]);e.push(o)}return e}var a=t.indexOf(".");if(-1!==a){var u=n[t.substr(0,a)];return void 0===u?void 0:xn(u,t.substr(a+1))}}function kn(n,t,e){if(n&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(n)))if("string"!=typeof t&&"length"in t){bn("string"!=typeof e&&"length"in e);for(var r=0,i=t.length;r<i;++r)kn(n,t[r],e[r])}else{var o=t.indexOf(".");if(-1!==o){var a=t.substr(0,o),u=t.substr(o+1);if(""===u)void 0===e?on(n)&&!isNaN(parseInt(a))?n.splice(a,1):delete n[a]:n[a]=e;else{var c=n[a];c||(c=n[a]={}),kn(c,u,e)}}else void 0===e?on(n)&&!isNaN(parseInt(t))?n.splice(t,1):delete n[t]:n[t]=e}}function En(n){var t={};for(var e in n)ln(n,e)&&(t[e]=n[e]);return t}var Pn=[].concat;function On(n){return Pn.apply([],n)}var Sn="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(On([8,16,32,64].map((function(n){return["Int","Uint","Float"].map((function(t){return t+n+"Array"}))})))).filter((function(n){return an[n]})),jn=Sn.map((function(n){return an[n]})),An=wn(Sn,(function(n){return[n,!0]}));function In(t){if(!t||"object"!==n(t))return t;var e;if(on(t)){e=[];for(var r=0,i=t.length;r<i;++r)e.push(In(t[r]))}else if(jn.indexOf(t.constructor)>=0)e=t;else for(var o in e=t.constructor?Object.create(t.constructor.prototype):{},t)ln(t,o)&&(e[o]=In(t[o]));return e}var Rn={}.toString;function Dn(n){return Rn.call(n).slice(8,-1)}var Kn=function n(t,e){return"Array"===e?""+t.map((function(t){return n(t,Dn(t))})):"ArrayBuffer"===e?""+new Uint8Array(t):"Date"===e?t.getTime():ArrayBuffer.isView(t)?""+new Uint8Array(t.buffer):t};function Cn(t,e,r,i){return r=r||{},i=i||"",rn(t).forEach((function(o){if(ln(e,o)){var a=t[o],u=e[o];if("object"===n(a)&&"object"===n(u)&&a&&u){var c=Dn(a),s=Dn(u);c===s?An[c]?Kn(a,c)!==Kn(u,s)&&(r[i+o]=e[o]):Cn(a,u,r,i+o+"."):r[i+o]=e[o]}else a!==u&&(r[i+o]=e[o])}else r[i+o]=void 0})),rn(e).forEach((function(n){ln(t,n)||(r[i+n]=e[n])})),r}var Tn="undefined"!=typeof Symbol&&Symbol.iterator,Bn=Tn?function(n){var t;return null!=n&&(t=n[Tn])&&t.apply(n)}:function(){return null},$n={};function Fn(n){var t,e,r,i;if(1===arguments.length){if(on(n))return n.slice();if(this===$n&&"string"==typeof n)return[n];if(i=Bn(n)){for(e=[];!(r=i.next()).done;)e.push(r.value);return e}if(null==n)return[n];if("number"==typeof(t=n.length)){for(e=new Array(t);t--;)e[t]=n[t];return e}return[n]}for(t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return e}var Mn="undefined"!=typeof Symbol?function(n){return"AsyncFunction"===n[Symbol.toStringTag]}:function(){return!1},Nn="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function qn(n,t){Nn=n,Vn=t}var Vn=function(){return!0},Un=!new Error("").stack;function Ln(){if(Un)try{throw new Error}catch(n){return n}return new Error}function zn(n,t){var e=n.stack;return e?(t=t||0,0===e.indexOf(n.name)&&(t+=(n.name+n.message).split("\n").length),e.split("\n").slice(t).filter(Vn).map((function(n){return"\n"+n})).join("")):""}var Wn=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Gn=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Wn),Hn={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function Qn(n,t){this._e=Ln(),this.name=n,this.message=t}function Yn(n,t){return n+". Errors: "+Object.keys(t).map((function(n){return t[n].toString()})).filter((function(n,t,e){return e.indexOf(n)===t})).join("\n")}function Xn(n,t,e,r){this._e=Ln(),this.failures=t,this.failedKeys=r,this.successCount=e,this.message=Yn(n,t)}function Jn(n,t){this._e=Ln(),this.name="BulkError",this.failures=t,this.message=Yn(n,t)}pn(Qn).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+zn(this._e,2))}},toString:function(){return this.name+": "+this.message}}),pn(Xn).from(Qn),pn(Jn).from(Qn);var Zn=Gn.reduce((function(n,t){return n[t]=t+"Error",n}),{}),nt=Qn,tt=Gn.reduce((function(t,e){var r=e+"Error";function i(t,i){this._e=Ln(),this.name=r,t?"string"==typeof t?(this.message=t+(i?"\n "+i:""),this.inner=i||null):"object"===n(t)&&(this.message=t.name+" "+t.message,this.inner=t):(this.message=Hn[e]||r,this.inner=null)}return pn(i).from(nt),t[e]=i,t}),{});tt.Syntax=SyntaxError,tt.Type=TypeError,tt.Range=RangeError;var et=Wn.reduce((function(n,t){return n[t+"Error"]=tt[t],n}),{});var rt=Gn.reduce((function(n,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(n[t+"Error"]=tt[t]),n}),{});function it(){}function ot(n){return n}function at(n,t){return null==n||n===ot?t:function(e){return t(n(e))}}function ut(n,t){return function(){n.apply(this,arguments),t.apply(this,arguments)}}function ct(n,t){return n===it?t:function(){var e=n.apply(this,arguments);void 0!==e&&(arguments[0]=e);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?ut(r,this.onsuccess):r),i&&(this.onerror=this.onerror?ut(i,this.onerror):i),void 0!==o?o:e}}function st(n,t){return n===it?t:function(){n.apply(this,arguments);var e=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),e&&(this.onsuccess=this.onsuccess?ut(e,this.onsuccess):e),r&&(this.onerror=this.onerror?ut(r,this.onerror):r)}}function lt(n,t){return n===it?t:function(e){var r=n.apply(this,arguments);un(e,r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?ut(i,this.onsuccess):i),o&&(this.onerror=this.onerror?ut(o,this.onerror):o),void 0===r?void 0===a?void 0:a:un(r,a)}}function ft(n,t){return n===it?t:function(){return!1!==t.apply(this,arguments)&&n.apply(this,arguments)}}function ht(n,t){return n===it?t:function(){var e=n.apply(this,arguments);if(e&&"function"==typeof e.then){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return e.then((function(){return t.apply(r,o)}))}return t.apply(this,arguments)}}rt.ModifyError=Xn,rt.DexieError=Qn,rt.BulkError=Jn;var dt={},pt="undefined"==typeof Promise?[]:function(){var n=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[n,n.__proto__,n];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,t.__proto__,n]}(),vt=pt[0],yt=pt[1],mt=pt[2],gt=yt&&yt.then,bt=vt&&vt.constructor,_t=!!mt,wt=!1,xt=mt?function(){mt.then(Lt)}:an.setImmediate?setImmediate.bind(null,Lt):an.MutationObserver?function(){var n=document.createElement("div");new MutationObserver((function(){Lt(),n=null})).observe(n,{attributes:!0}),n.setAttribute("i","1")}:function(){setTimeout(Lt,0)},kt=function(n,t){Dt.push([n,t]),Pt&&(xt(),Pt=!1)},Et=!0,Pt=!0,Ot=[],St=[],jt=null,At=ot,It={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:de,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((function(n){try{de(n[0],n[1])}catch(n){}}))}},Rt=It,Dt=[],Kt=0,Ct=[];function Tt(t){if("object"!==n(this))throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=it,this._lib=!1;var e=this._PSD=Rt;if(Nn&&(this._stackHolder=Ln(),this._prev=null,this._numPrev=0),"function"!=typeof t){if(t!==dt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Mt(this,this._value))}this._state=null,this._value=null,++e.ref,Ft(this,t)}var Bt={get:function(){var n=Rt,t=ne;function e(e,r){var i=this,o=!n.global&&(n!==Rt||t!==ne);o&&ie();var a=new Tt((function(t,a){qt(i,new $t(fe(e,n,o),fe(r,n,o),t,a,n))}));return Nn&&Ut(a,this),a}return e.prototype=dt,e},set:function(n){dn(this,"then",n&&n.prototype===dt?Bt:{get:function(){return n},set:Bt.set})}};function $t(n,t,e,r,i){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof t?t:null,this.resolve=e,this.reject=r,this.psd=i}function Ft(n,t){try{t((function(t){if(null===n._state){if(t===n)throw new TypeError("A promise cannot be resolved with itself.");var e=n._lib&&zt();t&&"function"==typeof t.then?Ft(n,(function(n,e){t instanceof Tt?t._then(n,e):t.then(n,e)})):(n._state=!0,n._value=t,Nt(n)),e&&Wt()}}),Mt.bind(null,n))}catch(t){Mt(n,t)}}function Mt(t,e){if(St.push(e),null===t._state){var r=t._lib&&zt();e=At(e),t._state=!1,t._value=e,Nn&&null!==e&&"object"===n(e)&&!e._promise&&function(n,t,e){try{n.apply(null,e)}catch(n){t&&t(n)}}((function(){var n=function n(t,e){var r;return vn(t,e)||(r=cn(t))&&n(r,e)}(e,"stack");e._promise=t,dn(e,"stack",{get:function(){return wt?n&&(n.get?n.get.apply(e):n.value):t.stack}})})),function(n){Ot.some((function(t){return t._value===n._value}))||Ot.push(n)}(t),Nt(t),r&&Wt()}}function Nt(n){var t=n._listeners;n._listeners=[];for(var e=0,r=t.length;e<r;++e)qt(n,t[e]);var i=n._PSD;--i.ref||i.finalize(),0===Kt&&(++Kt,kt((function(){0==--Kt&&Gt()}),[]))}function qt(n,t){if(null!==n._state){var e=n._state?t.onFulfilled:t.onRejected;if(null===e)return(n._state?t.resolve:t.reject)(n._value);++t.psd.ref,++Kt,kt(Vt,[e,n,t])}else n._listeners.push(t)}function Vt(n,t,e){try{jt=t;var r,i=t._value;t._state?r=n(i):(St.length&&(St=[]),r=n(i),-1===St.indexOf(i)&&function(n){var t=Ot.length;for(;t;)if(Ot[--t]._value===n._value)return void Ot.splice(t,1)}(t)),e.resolve(r)}catch(n){e.reject(n)}finally{jt=null,0==--Kt&&Gt(),--e.psd.ref||e.psd.finalize()}}function Ut(n,t){var e=t?t._numPrev+1:0;e<100&&(n._prev=t,n._numPrev=e)}function Lt(){zt()&&Wt()}function zt(){var n=Et;return Et=!1,Pt=!1,n}function Wt(){var n,t,e;do{for(;Dt.length>0;)for(n=Dt,Dt=[],e=n.length,t=0;t<e;++t){var r=n[t];r[0].apply(null,r[1])}}while(Dt.length>0);Et=!0,Pt=!0}function Gt(){var n=Ot;Ot=[],n.forEach((function(n){n._PSD.onunhandled.call(null,n._value,n)}));for(var t=Ct.slice(0),e=t.length;e;)t[--e]()}function Ht(n){return new Tt(dt,!1,n)}function Qt(n,t){var e=Rt;return function(){var r=zt(),i=Rt;try{return ce(e,!0),n.apply(this,arguments)}catch(n){t&&t(n)}finally{ce(i,!1),r&&Wt()}}}fn(Tt.prototype,{then:Bt,_then:function(n,t){qt(this,new $t(null,null,n,t,Rt))},catch:function(n){if(1===arguments.length)return this.then(null,n);var t=arguments[0],e=arguments[1];return"function"==typeof t?this.then(null,(function(n){return n instanceof t?e(n):Ht(n)})):this.then(null,(function(n){return n&&n.name===t?e(n):Ht(n)}))},finally:function(n){return this.then((function(t){return n(),t}),(function(t){return n(),Ht(t)}))},stack:{get:function(){if(this._stack)return this._stack;try{wt=!0;var n=function n(t,e,r){if(e.length===r)return e;var i="";if(!1===t._state){var o,a,u=t._value;null!=u?(o=u.name||"Error",a=u.message||u,i=zn(u,0)):(o=u,a=""),e.push(o+(a?": "+a:"")+i)}Nn&&((i=zn(t._stackHolder,2))&&-1===e.indexOf(i)&&e.push(i),t._prev&&n(t._prev,e,r));return e}(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=n),n}finally{wt=!1}}},timeout:function(n,t){var e=this;return n<1/0?new Tt((function(r,i){var o=setTimeout((function(){return i(new tt.Timeout(t))}),n);e.then(r,i).finally(clearTimeout.bind(null,o))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&dn(Tt.prototype,Symbol.toStringTag,"Dexie.Promise"),It.env=se(),fn(Tt,{all:function(){var n=Fn.apply(null,arguments).map(oe);return new Tt((function(t,e){0===n.length&&t([]);var r=n.length;n.forEach((function(i,o){return Tt.resolve(i).then((function(e){n[o]=e,--r||t(n)}),e)}))}))},resolve:function(n){if(n instanceof Tt)return n;if(n&&"function"==typeof n.then)return new Tt((function(t,e){n.then(t,e)}));var t=new Tt(dt,!0,n);return Ut(t,jt),t},reject:Ht,race:function(){var n=Fn.apply(null,arguments).map(oe);return new Tt((function(t,e){n.map((function(n){return Tt.resolve(n).then(t,e)}))}))},PSD:{get:function(){return Rt},set:function(n){return Rt=n}},newPSD:ee,usePSD:le,scheduler:{get:function(){return kt},set:function(n){kt=n}},rejectionMapper:{get:function(){return At},set:function(n){At=n}},follow:function(n,t){return new Tt((function(e,r){return ee((function(t,e){var r=Rt;r.unhandleds=[],r.onunhandled=e,r.finalize=ut((function(){var n=this;!function(n){Ct.push((function t(){n(),Ct.splice(Ct.indexOf(t),1)})),++Kt,kt((function(){0==--Kt&&Gt()}),[])}((function(){0===n.unhandleds.length?t():e(n.unhandleds[0])}))}),r.finalize),n()}),t,e,r)}))}}),bt&&(bt.allSettled&&dn(Tt,"allSettled",(function(){var n=Fn.apply(null,arguments).map(oe);return new Tt((function(t){0===n.length&&t([]);var e=n.length,r=new Array(e);n.forEach((function(n,i){return Tt.resolve(n).then((function(n){return r[i]={status:"fulfilled",value:n}}),(function(n){return r[i]={status:"rejected",reason:n}})).then((function(){return--e||t(r)}))}))}))})),bt.any&&"undefined"!=typeof AggregateError&&dn(Tt,"any",(function(){var n=Fn.apply(null,arguments).map(oe);return new Tt((function(t,e){0===n.length&&e(new AggregateError([]));var r=n.length,i=new Array(r);n.forEach((function(n,o){return Tt.resolve(n).then((function(n){return t(n)}),(function(n){i[o]=n,--r||e(new AggregateError(i))}))}))}))})));var Yt={awaits:0,echoes:0,id:0},Xt=0,Jt=[],Zt=0,ne=0,te=0;function ee(n,t,e,r){var i=Rt,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++te;var a=It.env;o.env=_t?{Promise:Tt,PromiseProp:{value:Tt,configurable:!0,writable:!0},all:Tt.all,race:Tt.race,allSettled:Tt.allSettled,any:Tt.any,resolve:Tt.resolve,reject:Tt.reject,nthen:he(a.nthen,o),gthen:he(a.gthen,o)}:{},t&&un(o,t),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=le(o,n,e,r);return 0===o.ref&&o.finalize(),u}function re(){return Yt.id||(Yt.id=++Xt),++Yt.awaits,Yt.echoes+=100,Yt.id}function ie(n){!Yt.awaits||n&&n!==Yt.id||(0==--Yt.awaits&&(Yt.id=0),Yt.echoes=100*Yt.awaits)}function oe(n){return Yt.echoes&&n&&n.constructor===bt?(re(),n.then((function(n){return ie(),n}),(function(n){return ie(),pe(n)}))):n}function ae(n){++ne,Yt.echoes&&0!=--Yt.echoes||(Yt.echoes=Yt.id=0),Jt.push(Rt),ce(n,!0)}function ue(){var n=Jt[Jt.length-1];Jt.pop(),ce(n,!1)}function ce(n,t){var e,r=Rt;if((t?!Yt.echoes||Zt++&&n===Rt:!Zt||--Zt&&n===Rt)||(e=t?ae.bind(null,n):ue,gt.call(vt,e)),n!==Rt&&(Rt=n,r===It&&(It.env=se()),_t)){var i=It.env.Promise,o=n.env;yt.then=o.nthen,i.prototype.then=o.gthen,(r.global||n.global)&&(Object.defineProperty(an,"Promise",o.PromiseProp),i.all=o.all,i.race=o.race,i.resolve=o.resolve,i.reject=o.reject,o.allSettled&&(i.allSettled=o.allSettled),o.any&&(i.any=o.any))}}function se(){var n=an.Promise;return _t?{Promise:n,PromiseProp:Object.getOwnPropertyDescriptor(an,"Promise"),all:n.all,race:n.race,allSettled:n.allSettled,any:n.any,resolve:n.resolve,reject:n.reject,nthen:yt.then,gthen:n.prototype.then}:{}}function le(n,t,e,r,i){var o=Rt;try{return ce(n,!0),t(e,r,i)}finally{ce(o,!1)}}function fe(n,t,e){return"function"!=typeof n?n:function(){var r=Rt;e&&re(),ce(t,!0);try{return n.apply(this,arguments)}finally{ce(r,!1)}}}function he(n,t){return function(e,r){return n.call(this,fe(e,t,!1),fe(r,t,!1))}}-1===(""+gt).indexOf("[native code]")&&(re=ie=it);function de(n,t){var e;try{e=t.onuncatched(n)}catch(n){}if(!1!==e)try{var r,i={promise:t,reason:n};if(an.document&&document.createEvent?((r=document.createEvent("Event")).initEvent("unhandledrejection",!0,!0),un(r,i)):an.CustomEvent&&un(r=new CustomEvent("unhandledrejection",{detail:i}),i),r&&an.dispatchEvent&&(dispatchEvent(r),!an.PromiseRejectionEvent&&an.onunhandledrejection))try{an.onunhandledrejection(r)}catch(n){}Nn&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(n.stack||n))}catch(n){}}var pe=Tt.reject;var ve=String.fromCharCode(65535),ye="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",me=[],ge="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),be=ge,_e=ge,we=function(n){return!/(dexie\.js|dexie\.min\.js)/.test(n)};function xe(n,t){return n?t?function(){return n.apply(this,arguments)&&t.apply(this,arguments)}:n:t}var ke={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1},Ee=function(){function t(){}return t.prototype._trans=function(n,t,e){var r=this._tx||Rt.trans,i=this.name;function o(n,e,r){if(!r.schema[i])throw new tt.NotFound("Table "+i+" not part of transaction");return t(r.idbtrans,r)}var a=zt();try{return r&&r.db===this.db?r===Rt.trans?r._promise(n,o,e):ee((function(){return r._promise(n,o,e)}),{trans:r,transless:Rt.transless||Rt}):function n(t,e,r,i){if(t._state.openComplete||Rt.letThrough){var o=t._createTransaction(e,r,t._dbSchema);try{o.create()}catch(n){return pe(n)}return o._promise(e,(function(n,t){return ee((function(){return Rt.trans=o,i(n,t,o)}))})).then((function(n){return o._completion.then((function(){return n}))}))}if(!t._state.isBeingOpened){if(!t._options.autoOpen)return pe(new tt.DatabaseClosed);t.open().catch(it)}return t._state.dbReadyPromise.then((function(){return n(t,e,r,i)}))}(this.db,n,[this.name],o)}finally{a&&Wt()}},t.prototype.get=function(n,t){var e=this;return n&&n.constructor===Object?this.where(n).first(t):this._trans("readonly",(function(t){return e.core.get({trans:t,key:n}).then((function(n){return e.hook.reading.fire(n)}))})).then(t)},t.prototype.where=function(n){if("string"==typeof n)return new this.db.WhereClause(this,n);if(on(n))return new this.db.WhereClause(this,"["+n.join("+")+"]");var t=rn(n);if(1===t.length)return this.where(t[0]).equals(n[t[0]]);var e=this.schema.indexes.concat(this.schema.primKey).filter((function(n){return n.compound&&t.every((function(t){return n.keyPath.indexOf(t)>=0}))&&n.keyPath.every((function(n){return t.indexOf(n)>=0}))}))[0];if(e&&this.db._maxKey!==ve)return this.where(e.name).equals(e.keyPath.map((function(t){return n[t]})));!e&&Nn&&console.warn("The query "+JSON.stringify(n)+" on "+this.name+" would benefit of a compound index ["+t.join("+")+"]");var r=this.schema.idxByName,i=this.db._deps.indexedDB;function o(n,t){try{return 0===i.cmp(n,t)}catch(n){return!1}}var a=t.reduce((function(t,e){var i=t[0],a=t[1],u=r[e],c=n[e];return[i||u,i||!u?xe(a,u&&u.multi?function(n){var t=xn(n,e);return on(t)&&t.some((function(n){return o(c,n)}))}:function(n){return o(c,xn(n,e))}):a]}),[null,null]),u=a[0],c=a[1];return u?this.where(u.name).equals(n[u.keyPath]).filter(c):e?this.filter(c):this.where(t).equals("")},t.prototype.filter=function(n){return this.toCollection().and(n)},t.prototype.count=function(n){return this.toCollection().count(n)},t.prototype.offset=function(n){return this.toCollection().offset(n)},t.prototype.limit=function(n){return this.toCollection().limit(n)},t.prototype.each=function(n){return this.toCollection().each(n)},t.prototype.toArray=function(n){return this.toCollection().toArray(n)},t.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},t.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,on(n)?"["+n.join("+")+"]":n))},t.prototype.reverse=function(){return this.toCollection().reverse()},t.prototype.mapToClass=function(n){this.schema.mappedClass=n;var t=function(t){if(!t)return t;var e=Object.create(n.prototype);for(var r in t)if(ln(t,r))try{e[r]=t[r]}catch(n){}return e};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=t,this.hook("reading",t),n},t.prototype.defineClass=function(){return this.mapToClass((function(n){un(this,n)}))},t.prototype.add=function(n,t){var e=this;return this._trans("readwrite",(function(r){return e.core.mutate({trans:r,type:"add",keys:null!=t?[t]:null,values:[n]})})).then((function(n){return n.numFailures?Tt.reject(n.failures[0]):n.lastResult})).then((function(t){if(!e.core.schema.primaryKey.outbound)try{kn(n,e.core.schema.primaryKey.keyPath,t)}catch(n){}return t}))},t.prototype.update=function(t,e){if("object"!==n(e)||on(e))throw new tt.InvalidArgument("Modifications must be an object.");if("object"!==n(t)||on(t))return this.where(":id").equals(t).modify(e);rn(e).forEach((function(n){kn(t,n,e[n])}));var r=xn(t,this.schema.primKey.keyPath);return void 0===r?pe(new tt.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(r).modify(e)},t.prototype.put=function(n,t){var e=this;return this._trans("readwrite",(function(r){return e.core.mutate({trans:r,type:"put",values:[n],keys:null!=t?[t]:null})})).then((function(n){return n.numFailures?Tt.reject(n.failures[0]):n.lastResult})).then((function(t){if(!e.core.schema.primaryKey.outbound)try{kn(n,e.core.schema.primaryKey.keyPath,t)}catch(n){}return t}))},t.prototype.delete=function(n){var t=this;return this._trans("readwrite",(function(e){return t.core.mutate({trans:e,type:"delete",keys:[n]})})).then((function(n){return n.numFailures?Tt.reject(n.failures[0]):void 0}))},t.prototype.clear=function(){var n=this;return this._trans("readwrite",(function(t){return n.core.mutate({trans:t,type:"deleteRange",range:ke})})).then((function(n){return n.numFailures?Tt.reject(n.failures[0]):void 0}))},t.prototype.bulkGet=function(n){var t=this;return this._trans("readonly",(function(e){return t.core.getMany({keys:n,trans:e})}))},t.prototype.bulkAdd=function(n,t,e){var r=this,i=Array.isArray(t)?t:void 0,o=(e=e||(i?void 0:t))?e.allKeys:void 0;return this._trans("readwrite",(function(t){if(!r.core.schema.primaryKey.outbound&&i)throw new tt.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==n.length)throw new tt.InvalidArgument("Arguments objects and keys must have the same length");var e=n.length;return r.core.mutate({trans:t,type:"add",keys:i,values:n,wantResults:o}).then((function(n){var t=n.numFailures,i=n.results,a=n.lastResult,u=n.failures;if(0===t)return o?i:a;throw new Jn(r.name+".bulkAdd(): "+t+" of "+e+" operations failed",Object.keys(u).map((function(n){return u[n]})))}))}))},t.prototype.bulkPut=function(n,t,e){var r=this,i=Array.isArray(t)?t:void 0,o=(e=e||(i?void 0:t))?e.allKeys:void 0;return this._trans("readwrite",(function(t){if(!r.core.schema.primaryKey.outbound&&i)throw new tt.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==n.length)throw new tt.InvalidArgument("Arguments objects and keys must have the same length");var e=n.length;return r.core.mutate({trans:t,type:"put",keys:i,values:n,wantResults:o}).then((function(n){var t=n.numFailures,i=n.results,a=n.lastResult,u=n.failures;if(0===t)return o?i:a;throw new Jn(r.name+".bulkPut(): "+t+" of "+e+" operations failed",Object.keys(u).map((function(n){return u[n]})))}))}))},t.prototype.bulkDelete=function(n){var t=this,e=n.length;return this._trans("readwrite",(function(e){return t.core.mutate({trans:e,type:"delete",keys:n})})).then((function(n){var r=n.numFailures,i=n.lastResult,o=n.failures;if(0===r)return i;throw new Jn(t.name+".bulkDelete(): "+r+" of "+e+" operations failed",o)}))},t}();function Pe(t){var e={},r=function(n,r){if(r){for(var i=arguments.length,o=new Array(i-1);--i;)o[i-1]=arguments[i];return e[n].subscribe.apply(null,o),t}if("string"==typeof n)return e[n]};r.addEventType=a;for(var i=1,o=arguments.length;i<o;++i)a(arguments[i]);return r;function a(t,i,o){if("object"===n(t))return u(t);i||(i=ft),o||(o=it);var a={subscribers:[],fire:o,subscribe:function(n){-1===a.subscribers.indexOf(n)&&(a.subscribers.push(n),a.fire=i(a.fire,n))},unsubscribe:function(n){a.subscribers=a.subscribers.filter((function(t){return t!==n})),a.fire=a.subscribers.reduce(i,o)}};return e[t]=r[t]=a,a}function u(n){rn(n).forEach((function(t){var e=n[t];if(on(e))a(t,n[t][0],n[t][1]);else{if("asap"!==e)throw new tt.InvalidArgument("Invalid event config");var r=a(t,ot,(function(){for(var n=arguments.length,t=new Array(n);n--;)t[n]=arguments[n];r.subscribers.forEach((function(n){_n((function(){n.apply(null,t)}))}))}))}}))}}function Oe(n,t){return pn(t).from({prototype:n}),t}function Se(n,t){return!(n.filter||n.algorithm||n.or)&&(t?n.justLimit:!n.replayFilter)}function je(n,t){n.filter=xe(n.filter,t)}function Ae(n,t,e){var r=n.replayFilter;n.replayFilter=r?function(){return xe(r(),t())}:t,n.justLimit=e&&!r}function Ie(n,t){if(n.isPrimKey)return t.primaryKey;var e=t.getIndexByKeyPath(n.index);if(!e)throw new tt.Schema("KeyPath "+n.index+" on object store "+t.name+" is not indexed");return e}function Re(n,t,e){var r=Ie(n,t.schema);return t.openCursor({trans:e,values:!n.keysOnly,reverse:"prev"===n.dir,unique:!!n.unique,query:{index:r,range:n.range}})}function De(n,t,e,r){var i=n.replayFilter?xe(n.filter,n.replayFilter()):n.filter;if(n.or){var o={},a=function(n,e,r){if(!i||i(e,r,(function(n){return e.stop(n)}),(function(n){return e.fail(n)}))){var a=e.primaryKey,u=""+a;"[object ArrayBuffer]"===u&&(u=""+new Uint8Array(a)),ln(o,u)||(o[u]=!0,t(n,e,r))}};return Promise.all([n.or._iterate(a,e),Ke(Re(n,r,e),n.algorithm,a,!n.keysOnly&&n.valueMapper)])}return Ke(Re(n,r,e),xe(n.algorithm,i),t,!n.keysOnly&&n.valueMapper)}function Ke(n,t,e,r){var i=Qt(r?function(n,t,i){return e(r(n),t,i)}:e);return n.then((function(n){if(n)return n.start((function(){var e=function(){return n.continue()};t&&!t(n,(function(n){return e=n}),(function(t){n.stop(t),e=it}),(function(t){n.fail(t),e=it}))||i(n.value,n,(function(n){return e=n})),e()}))}))}var Ce=function(){function n(){}return n.prototype._read=function(n,t){var e=this._ctx;return e.error?e.table._trans(null,pe.bind(null,e.error)):e.table._trans("readonly",n).then(t)},n.prototype._write=function(n){var t=this._ctx;return t.error?t.table._trans(null,pe.bind(null,t.error)):t.table._trans("readwrite",n,"locked")},n.prototype._addAlgorithm=function(n){var t=this._ctx;t.algorithm=xe(t.algorithm,n)},n.prototype._iterate=function(n,t){return De(this._ctx,n,t,this._ctx.table.core)},n.prototype.clone=function(n){var t=Object.create(this.constructor.prototype),e=Object.create(this._ctx);return n&&un(e,n),t._ctx=e,t},n.prototype.raw=function(){return this._ctx.valueMapper=null,this},n.prototype.each=function(n){var t=this._ctx;return this._read((function(e){return De(t,n,e,t.table.core)}))},n.prototype.count=function(n){var t=this;return this._read((function(n){var e=t._ctx,r=e.table.core;if(Se(e,!0))return r.count({trans:n,query:{index:Ie(e,r.schema),range:e.range}}).then((function(n){return Math.min(n,e.limit)}));var i=0;return De(e,(function(){return++i,!1}),n,r).then((function(){return i}))})).then(n)},n.prototype.sortBy=function(n,t){var e=n.split(".").reverse(),r=e[0],i=e.length-1;function o(n,t){return t?o(n[e[t]],t-1):n[r]}var a="next"===this._ctx.dir?1:-1;function u(n,t){var e=o(n,i),r=o(t,i);return e<r?-a:e>r?a:0}return this.toArray((function(n){return n.sort(u)})).then(t)},n.prototype.toArray=function(n){var t=this;return this._read((function(n){var e=t._ctx;if("next"===e.dir&&Se(e,!0)&&e.limit>0){var r=e.valueMapper,i=Ie(e,e.table.core.schema);return e.table.core.query({trans:n,limit:e.limit,values:!0,query:{index:i,range:e.range}}).then((function(n){var t=n.result;return r?t.map(r):t}))}var o=[];return De(e,(function(n){return o.push(n)}),n,e.table.core).then((function(){return o}))}),n)},n.prototype.offset=function(n){var t=this._ctx;return n<=0||(t.offset+=n,Se(t)?Ae(t,(function(){var t=n;return function(n,e){return 0===t||(1===t?(--t,!1):(e((function(){n.advance(t),t=0})),!1))}})):Ae(t,(function(){var t=n;return function(){return--t<0}}))),this},n.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),Ae(this._ctx,(function(){var t=n;return function(n,e,r){return--t<=0&&e(r),t>=0}}),!0),this},n.prototype.until=function(n,t){return je(this._ctx,(function(e,r,i){return!n(e.value)||(r(i),t)})),this},n.prototype.first=function(n){return this.limit(1).toArray((function(n){return n[0]})).then(n)},n.prototype.last=function(n){return this.reverse().first(n)},n.prototype.filter=function(n){var t,e;return je(this._ctx,(function(t){return n(t.value)})),t=this._ctx,e=n,t.isMatch=xe(t.isMatch,e),this},n.prototype.and=function(n){return this.filter(n)},n.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},n.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},n.prototype.desc=function(){return this.reverse()},n.prototype.eachKey=function(n){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,e){n(e.key,e)}))},n.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},n.prototype.eachPrimaryKey=function(n){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,e){n(e.primaryKey,e)}))},n.prototype.keys=function(n){var t=this._ctx;t.keysOnly=!t.isMatch;var e=[];return this.each((function(n,t){e.push(t.key)})).then((function(){return e})).then(n)},n.prototype.primaryKeys=function(n){var t=this._ctx;if("next"===t.dir&&Se(t,!0)&&t.limit>0)return this._read((function(n){var e=Ie(t,t.table.core.schema);return t.table.core.query({trans:n,values:!1,limit:t.limit,query:{index:e,range:t.range}})})).then((function(n){return n.result})).then(n);t.keysOnly=!t.isMatch;var e=[];return this.each((function(n,t){e.push(t.primaryKey)})).then((function(){return e})).then(n)},n.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},n.prototype.firstKey=function(n){return this.limit(1).keys((function(n){return n[0]})).then(n)},n.prototype.lastKey=function(n){return this.reverse().firstKey(n)},n.prototype.distinct=function(){var n=this._ctx,t=n.index&&n.table.schema.idxByName[n.index];if(!t||!t.multi)return this;var e={};return je(this._ctx,(function(n){var t=n.primaryKey.toString(),r=ln(e,t);return e[t]=!0,!r})),this},n.prototype.modify=function(n){var t=this,e=this._ctx;return this._write((function(r){var i;if("function"==typeof n)i=n;else{var o=rn(n),a=o.length;i=function(t){for(var e=!1,r=0;r<a;++r){var i=o[r],u=n[i];xn(t,i)!==u&&(kn(t,i,u),e=!0)}return e}}var u=e.table.core,c=u.schema.primaryKey,s=c.outbound,l=c.extractKey,f="testmode"in Er?1:2e3,h=t.db.core.cmp,d=[],p=0,v=[],y=function(n,t){var e=t.failures,r=t.numFailures;p+=n-r;for(var i=0,o=rn(e);i<o.length;i++){var a=o[i];d.push(e[a])}};return t.clone().primaryKeys().then((function(n){return function t(e){var o=Math.min(f,n.length-e);return u.getMany({trans:r,keys:n.slice(e,e+o)}).then((function(a){for(var c=[],d=[],p=s?[]:null,v=[],m=0;m<o;++m){var g=a[m],b={value:In(g),primKey:n[e+m]};!1!==i.call(b,b.value,b)&&(null==b.value?v.push(n[e+m]):s||0===h(l(g),l(b.value))?(d.push(b.value),s&&p.push(n[e+m])):(v.push(n[e+m]),c.push(b.value)))}return Promise.resolve(c.length>0&&u.mutate({trans:r,type:"add",values:c}).then((function(n){for(var t in n.failures)v.splice(parseInt(t),1);y(c.length,n)}))).then((function(n){return d.length>0&&u.mutate({trans:r,type:"put",keys:p,values:d}).then((function(n){return y(d.length,n)}))})).then((function(){return v.length>0&&u.mutate({trans:r,type:"delete",keys:v}).then((function(n){return y(v.length,n)}))})).then((function(){return n.length>e+o&&t(e+f)}))}))}(0).then((function(){if(d.length>0)throw new Xn("Error modifying one or more objects",d,p,v);return n.length}))}))}))},n.prototype.delete=function(){var n=this._ctx,t=n.range;return Se(n)&&(n.isPrimKey&&!_e||3===t.type)?this._write((function(e){var r=n.table.core.schema.primaryKey,i=t;return n.table.core.count({trans:e,query:{index:r,range:i}}).then((function(t){return n.table.core.mutate({trans:e,type:"deleteRange",range:i}).then((function(n){var e=n.failures,r=(n.lastResult,n.results,n.numFailures);if(r)throw new Xn("Could not delete some values",Object.keys(e).map((function(n){return e[n]})),t-r);return t-r}))}))})):this.modify((function(n,t){return t.value=null}))},n}();function Te(n,t){return n<t?-1:n===t?0:1}function Be(n,t){return n>t?-1:n===t?0:1}function $e(n,t,e){var r=n instanceof Ue?new n.Collection(n):n;return r._ctx.error=e?new e(t):new TypeError(t),r}function Fe(n){return new n.Collection(n,(function(){return Ve("")})).limit(0)}function Me(n,t,e,r,i,o){for(var a=Math.min(n.length,r.length),u=-1,c=0;c<a;++c){var s=t[c];if(s!==r[c])return i(n[c],e[c])<0?n.substr(0,c)+e[c]+e.substr(c+1):i(n[c],r[c])<0?n.substr(0,c)+r[c]+e.substr(c+1):u>=0?n.substr(0,u)+t[u]+e.substr(u+1):null;i(n[c],s)<0&&(u=c)}return a<r.length&&"next"===o?n+e.substr(n.length):a<n.length&&"prev"===o?n.substr(0,e.length):u<0?null:n.substr(0,u)+r[u]+e.substr(u+1)}function Ne(n,t,e,r){var i,o,a,u,c,s,l,f=e.length;if(!e.every((function(n){return"string"==typeof n})))return $e(n,"String expected.");function h(n){i=function(n){return"next"===n?function(n){return n.toUpperCase()}:function(n){return n.toLowerCase()}}(n),o=function(n){return"next"===n?function(n){return n.toLowerCase()}:function(n){return n.toUpperCase()}}(n),a="next"===n?Te:Be;var t=e.map((function(n){return{lower:o(n),upper:i(n)}})).sort((function(n,t){return a(n.lower,t.lower)}));u=t.map((function(n){return n.upper})),c=t.map((function(n){return n.lower})),s=n,l="next"===n?"":r}h("next");var d=new n.Collection(n,(function(){return qe(u[0],c[f-1]+r)}));d._ondirectionchange=function(n){h(n)};var p=0;return d._addAlgorithm((function(n,e,r){var i=n.key;if("string"!=typeof i)return!1;var h=o(i);if(t(h,c,p))return!0;for(var d=null,v=p;v<f;++v){var y=Me(i,h,u[v],c[v],a,s);null===y&&null===d?p=v+1:(null===d||a(d,y)>0)&&(d=y)}return e(null!==d?function(){n.continue(d+l)}:r),!1})),d}function qe(n,t,e,r){return{type:2,lower:n,upper:t,lowerOpen:e,upperOpen:r}}function Ve(n){return{type:1,lower:n,upper:n}}var Ue=function(){function n(){}return Object.defineProperty(n.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!0,configurable:!0}),n.prototype.between=function(n,t,e,r){e=!1!==e,r=!0===r;try{return this._cmp(n,t)>0||0===this._cmp(n,t)&&(e||r)&&(!e||!r)?Fe(this):new this.Collection(this,(function(){return qe(n,t,!e,!r)}))}catch(n){return $e(this,ye)}},n.prototype.equals=function(n){return new this.Collection(this,(function(){return Ve(n)}))},n.prototype.above=function(n){return null==n?$e(this,ye):new this.Collection(this,(function(){return qe(n,void 0,!0)}))},n.prototype.aboveOrEqual=function(n){return null==n?$e(this,ye):new this.Collection(this,(function(){return qe(n,void 0,!1)}))},n.prototype.below=function(n){return null==n?$e(this,ye):new this.Collection(this,(function(){return qe(void 0,n,!1,!0)}))},n.prototype.belowOrEqual=function(n){return null==n?$e(this,ye):new this.Collection(this,(function(){return qe(void 0,n)}))},n.prototype.startsWith=function(n){return"string"!=typeof n?$e(this,"String expected."):this.between(n,n+ve,!0,!0)},n.prototype.startsWithIgnoreCase=function(n){return""===n?this.startsWith(n):Ne(this,(function(n,t){return 0===n.indexOf(t[0])}),[n],ve)},n.prototype.equalsIgnoreCase=function(n){return Ne(this,(function(n,t){return n===t[0]}),[n],"")},n.prototype.anyOfIgnoreCase=function(){var n=Fn.apply($n,arguments);return 0===n.length?Fe(this):Ne(this,(function(n,t){return-1!==t.indexOf(n)}),n,"")},n.prototype.startsWithAnyOfIgnoreCase=function(){var n=Fn.apply($n,arguments);return 0===n.length?Fe(this):Ne(this,(function(n,t){return t.some((function(t){return 0===n.indexOf(t)}))}),n,ve)},n.prototype.anyOf=function(){var n=this,t=Fn.apply($n,arguments),e=this._cmp;try{t.sort(e)}catch(n){return $e(this,ye)}if(0===t.length)return Fe(this);var r=new this.Collection(this,(function(){return qe(t[0],t[t.length-1])}));r._ondirectionchange=function(r){e="next"===r?n._ascending:n._descending,t.sort(e)};var i=0;return r._addAlgorithm((function(n,r,o){for(var a=n.key;e(a,t[i])>0;)if(++i===t.length)return r(o),!1;return 0===e(a,t[i])||(r((function(){n.continue(t[i])})),!1)})),r},n.prototype.notEqual=function(n){return this.inAnyRange([[-1/0,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},n.prototype.noneOf=function(){var n=Fn.apply($n,arguments);if(0===n.length)return new this.Collection(this);try{n.sort(this._ascending)}catch(n){return $e(this,ye)}var t=n.reduce((function(n,t){return n?n.concat([[n[n.length-1][1],t]]):[[-1/0,t]]}),null);return t.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},n.prototype.inAnyRange=function(n,t){var e=this,r=this._cmp,i=this._ascending,o=this._descending,a=this._min,u=this._max;if(0===n.length)return Fe(this);if(!n.every((function(n){return void 0!==n[0]&&void 0!==n[1]&&i(n[0],n[1])<=0})))return $e(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",tt.InvalidArgument);var c=!t||!1!==t.includeLowers,s=t&&!0===t.includeUppers;var l,f=i;function h(n,t){return f(n[0],t[0])}try{(l=n.reduce((function(n,t){for(var e=0,i=n.length;e<i;++e){var o=n[e];if(r(t[0],o[1])<0&&r(t[1],o[0])>0){o[0]=a(o[0],t[0]),o[1]=u(o[1],t[1]);break}}return e===i&&n.push(t),n}),[])).sort(h)}catch(n){return $e(this,ye)}var d=0,p=s?function(n){return i(n,l[d][1])>0}:function(n){return i(n,l[d][1])>=0},v=c?function(n){return o(n,l[d][0])>0}:function(n){return o(n,l[d][0])>=0};var y=p,m=new this.Collection(this,(function(){return qe(l[0][0],l[l.length-1][1],!c,!s)}));return m._ondirectionchange=function(n){"next"===n?(y=p,f=i):(y=v,f=o),l.sort(h)},m._addAlgorithm((function(n,t,r){for(var o=n.key;y(o);)if(++d===l.length)return t(r),!1;return!!function(n){return!p(n)&&!v(n)}(o)||(0===e._cmp(o,l[d][1])||0===e._cmp(o,l[d][0])||t((function(){f===i?n.continue(l[d][0]):n.continue(l[d][1])})),!1)})),m},n.prototype.startsWithAnyOf=function(){var n=Fn.apply($n,arguments);return n.every((function(n){return"string"==typeof n}))?0===n.length?Fe(this):this.inAnyRange(n.map((function(n){return[n,n+ve]}))):$e(this,"startsWithAnyOf() only works with strings")},n}();function Le(n){return 1===n.length?n[0]:n}function ze(n){try{return n.only([[]]),[[]]}catch(n){return ve}}function We(n){return Qt((function(t){return Ge(t),n(t.target.error),!1}))}function Ge(n){n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault()}var He=function(){function n(){}return n.prototype._lock=function(){return bn(!Rt.global),++this._reculock,1!==this._reculock||Rt.global||(Rt.lockOwnerFor=this),this},n.prototype._unlock=function(){if(bn(!Rt.global),0==--this._reculock)for(Rt.global||(Rt.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var n=this._blockedFuncs.shift();try{le(n[1],n[0])}catch(n){}}return this},n.prototype._locked=function(){return this._reculock&&Rt.lockOwnerFor!==this},n.prototype.create=function(n){var t=this;if(!this.mode)return this;var e=this.db.idbdb,r=this.db._state.dbOpenError;if(bn(!this.idbtrans),!n&&!e)switch(r&&r.name){case"DatabaseClosedError":throw new tt.DatabaseClosed(r);case"MissingAPIError":throw new tt.MissingAPI(r.message,r);default:throw new tt.OpenFailed(r)}if(!this.active)throw new tt.TransactionInactive;return bn(null===this._completion._state),(n=this.idbtrans=n||e.transaction(Le(this.storeNames),this.mode)).onerror=Qt((function(e){Ge(e),t._reject(n.error)})),n.onabort=Qt((function(e){Ge(e),t.active&&t._reject(new tt.Abort(n.error)),t.active=!1,t.on("abort").fire(e)})),n.oncomplete=Qt((function(){t.active=!1,t._resolve()})),this},n.prototype._promise=function(n,t,e){var r=this;if("readwrite"===n&&"readwrite"!==this.mode)return pe(new tt.ReadOnly("Transaction is readonly"));if(!this.active)return pe(new tt.TransactionInactive);if(this._locked())return new Tt((function(i,o){r._blockedFuncs.push([function(){r._promise(n,t,e).then(i,o)},Rt])}));if(e)return ee((function(){var n=new Tt((function(n,e){r._lock();var i=t(n,e,r);i&&i.then&&i.then(n,e)}));return n.finally((function(){return r._unlock()})),n._lib=!0,n}));var i=new Tt((function(n,e){var i=t(n,e,r);i&&i.then&&i.then(n,e)}));return i._lib=!0,i},n.prototype._root=function(){return this.parent?this.parent._root():this},n.prototype.waitFor=function(n){var t=this._root(),e=Tt.resolve(n);if(t._waitingFor)t._waitingFor=t._waitingFor.then((function(){return e}));else{t._waitingFor=e,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);!function n(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=n)}()}var i=t._waitingFor;return new Tt((function(n,r){e.then((function(e){return t._waitingQueue.push(Qt(n.bind(null,e)))}),(function(n){return t._waitingQueue.push(Qt(r.bind(null,n)))})).finally((function(){t._waitingFor===i&&(t._waitingFor=null)}))}))},n.prototype.abort=function(){this.active&&this._reject(new tt.Abort),this.active=!1},n.prototype.table=function(n){var t=this._memoizedTables||(this._memoizedTables={});if(ln(t,n))return t[n];var e=this.schema[n];if(!e)throw new tt.NotFound("Table "+n+" not part of transaction");var r=new this.db.Table(n,e,this);return r.core=this.db.core.table(n),t[n]=r,r},n}();function Qe(n,t,e,r,i,o,a){return{name:n,keyPath:t,unique:e,multi:r,auto:i,compound:o,src:(e&&!a?"&":"")+(r?"*":"")+(i?"++":"")+Ye(t)}}function Ye(n){return"string"==typeof n?n:n?"["+[].join.call(n,"+")+"]":""}function Xe(n,t,e){return{name:n,primKey:t,indexes:e,mappedClass:null,idxByName:wn(e,(function(n){return[n.name,n]}))}}function Je(n){return null==n?function(){}:"string"==typeof n?function(n){return 1===n.split(".").length?function(t){return t[n]}:function(t){return xn(t,n)}}(n):function(t){return xn(t,n)}}function Ze(n,t){return"delete"===t.type?t.keys:t.keys||t.values.map(n.extractKey)}function nr(n){return[].slice.call(n)}var tr=0;function er(n){return null==n?":id":"string"==typeof n?n:"["+n.join("+")+"]"}function rr(n,t,e,r){var i=t.cmp.bind(t);function o(n){if(3===n.type)return null;if(4===n.type)throw new Error("Cannot convert never type to IDBKeyRange");var t=n.lower,r=n.upper,i=n.lowerOpen,o=n.upperOpen;return void 0===t?void 0===r?null:e.upperBound(r,!!o):void 0===r?e.lowerBound(t,!!i):e.bound(t,r,!!i,!!o)}var a=function(n,t){var e=nr(n.objectStoreNames);return{schema:{name:n.name,tables:e.map((function(n){return t.objectStore(n)})).map((function(n){var t=n.keyPath,e=n.autoIncrement,r=on(t),i=null==t,o={},a={name:n.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:i,compound:r,keyPath:t,autoIncrement:e,unique:!0,extractKey:Je(t)},indexes:nr(n.indexNames).map((function(t){return n.index(t)})).map((function(n){var t=n.name,e=n.unique,r=n.multiEntry,i=n.keyPath,a={name:t,compound:on(i),keyPath:i,unique:e,multiEntry:r,extractKey:Je(i)};return o[er(i)]=a,a})),getIndexByKeyPath:function(n){return o[er(n)]}};return o[":id"]=a.primaryKey,null!=t&&(o[er(t)]=a.primaryKey),a}))},hasGetAll:e.length>0&&"getAll"in t.objectStore(e[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(n,r),u=a.schema,c=a.hasGetAll,s=u.tables.map((function(n){return function(n){var t=n.name;return{name:t,schema:n,mutate:function(e){var r=e.trans,i=e.type,a=e.keys,u=e.values,c=e.range,s=e.wantResults;return new Promise((function(e,l){e=Qt(e);var f=r.objectStore(t),h=null==f.keyPath,d="put"===i||"add"===i;if(!d&&"delete"!==i&&"deleteRange"!==i)throw new Error("Invalid operation type: "+i);var p=(a||u||{length:1}).length;if(a&&u&&a.length!==u.length)throw new Error("Given keys array must have same length as given values array.");if(0===p)return e({numFailures:0,failures:{},results:[],lastResult:void 0});var v,y=s&&en(a||Ze(n.primaryKey,{type:i,keys:a,values:u})),m=[],g=0,b=function(n){++g,Ge(n),y&&(y[n.target._reqno]=void 0),m[n.target._reqno]=n.target.error},_=function(n){var t=n.target;y[t._reqno]=t.result};if("deleteRange"===i){if(4===c.type)return e({numFailures:g,failures:m,results:y,lastResult:void 0});v=3===c.type?f.clear():f.delete(o(c))}else{var w=d?h?[u,a]:[u,null]:[a,null],x=w[0],k=w[1];if(d)for(var E=0;E<p;++E)(v=k&&void 0!==k[E]?f[i](x[E],k[E]):f[i](x[E]))._reqno=E,y&&void 0===y[E]&&(v.onsuccess=_),v.onerror=b;else for(E=0;E<p;++E)(v=f[i](x[E]))._reqno=E,v.onerror=b}var P=function(n){var t=n.target.result;y&&(y[p-1]=t),e({numFailures:g,failures:m,results:y,lastResult:t})};v.onerror=function(n){b(n),P(n)},v.onsuccess=P}))},getMany:function(n){var e=n.trans,r=n.keys;return new Promise((function(n,i){n=Qt(n);for(var o,a=e.objectStore(t),u=r.length,c=new Array(u),s=0,l=0,f=function(t){var e=t.target;c[e._pos]=e.result,++l===s&&n(c)},h=We(i),d=0;d<u;++d){null!=r[d]&&((o=a.get(r[d]))._pos=d,o.onsuccess=f,o.onerror=h,++s)}0===s&&n(c)}))},get:function(n){var e=n.trans,r=n.key;return new Promise((function(n,i){n=Qt(n);var o=e.objectStore(t).get(r);o.onsuccess=function(t){return n(t.target.result)},o.onerror=We(i)}))},query:function(n){return function(e){return new Promise((function(r,i){r=Qt(r);var a=e.trans,u=e.values,c=e.limit,s=e.query,l=c===1/0?void 0:c,f=s.index,h=s.range,d=a.objectStore(t),p=f.isPrimaryKey?d:d.index(f.name),v=o(h);if(0===c)return r({result:[]});if(n){var y=u?p.getAll(v,l):p.getAllKeys(v,l);y.onsuccess=function(n){return r({result:n.target.result})},y.onerror=We(i)}else{var m=0,g=u||!("openKeyCursor"in p)?p.openCursor(v):p.openKeyCursor(v),b=[];g.onsuccess=function(n){var t=g.result;return t?(b.push(u?t.value:t.primaryKey),++m===c?r({result:b}):void t.continue()):r({result:b})},g.onerror=We(i)}}))}}(c),openCursor:function(n){var e=n.trans,r=n.values,i=n.query,a=n.reverse,u=n.unique;return new Promise((function(n,c){n=Qt(n);var s=i.index,l=i.range,f=e.objectStore(t),h=s.isPrimaryKey?f:f.index(s.name),d=a?u?"prevunique":"prev":u?"nextunique":"next",p=r||!("openKeyCursor"in h)?h.openCursor(o(l),d):h.openKeyCursor(o(l),d);p.onerror=We(c),p.onsuccess=Qt((function(t){var r=p.result;if(r){r.___id=++tr,r.done=!1;var i=r.continue.bind(r),o=r.continuePrimaryKey;o&&(o=o.bind(r));var a=r.advance.bind(r),u=function(){throw new Error("Cursor not stopped")};r.trans=e,r.stop=r.continue=r.continuePrimaryKey=r.advance=function(){throw new Error("Cursor not started")},r.fail=Qt(c),r.next=function(){var n=this,t=1;return this.start((function(){return t--?n.continue():n.stop()})).then((function(){return n}))},r.start=function(n){var t=new Promise((function(n,t){n=Qt(n),p.onerror=We(t),r.fail=t,r.stop=function(t){r.stop=r.continue=r.continuePrimaryKey=r.advance=u,n(t)}})),e=function(){if(p.result)try{n()}catch(n){r.fail(n)}else r.done=!0,r.start=function(){throw new Error("Cursor behind last entry")},r.stop()};return p.onsuccess=Qt((function(n){p.onsuccess=e,e()})),r.continue=i,r.continuePrimaryKey=o,r.advance=a,e(),t},n(r)}else n(null)}),c)}))},count:function(n){var e=n.query,r=n.trans,i=e.index,a=e.range;return new Promise((function(n,e){var u=r.objectStore(t),c=i.isPrimaryKey?u:u.index(i.name),s=o(a),l=s?c.count(s):c.count();l.onsuccess=Qt((function(t){return n(t.target.result)})),l.onerror=We(e)}))}}}(n)})),l={};return s.forEach((function(n){return l[n.name]=n})),{stack:"dbcore",transaction:n.transaction.bind(n),table:function(n){if(!l[n])throw new Error("Table '"+n+"' not found");return l[n]},cmp:i,MIN_KEY:-1/0,MAX_KEY:ze(e),schema:u}}function ir(n,t,e,r){var i=e.IDBKeyRange;return{dbcore:function(n,t){return t.reduce((function(n,t){var e=t.create;return tn(tn({},n),e(n))}),n)}(rr(t,e.indexedDB,i,r),n.dbcore)}}function or(n,t){var e=t.db,r=ir(n._middlewares,e,n._deps,t);n.core=r.dbcore,n.tables.forEach((function(t){var e=t.name;n.core.schema.tables.some((function(n){return n.name===e}))&&(t.core=n.core.table(e),n[e]instanceof n.Table&&(n[e].core=t.core))}))}function ar(n,t,e,r){e.forEach((function(e){var i=r[e];t.forEach((function(t){e in t||(t===n.Transaction.prototype||t instanceof n.Transaction?dn(t,e,{get:function(){return this.table(e)},set:function(n){hn(this,e,{value:n,writable:!0,configurable:!0,enumerable:!0})}}):t[e]=new n.Table(e,i))}))}))}function ur(n,t){t.forEach((function(t){for(var e in t)t[e]instanceof n.Table&&delete t[e]}))}function cr(n,t){return n._cfg.version-t._cfg.version}function sr(n,t,e,r){var i=n._dbSchema,o=n._createTransaction("readwrite",n._storeNames,i);o.create(e),o._completion.catch(r);var a=o._reject.bind(o),u=Rt.transless||Rt;ee((function(){Rt.trans=o,Rt.transless=u,0===t?(rn(i).forEach((function(n){lr(e,n,i[n].primKey,i[n].indexes)})),or(n,e),Tt.follow((function(){return n.on.populate.fire(o)})).catch(a)):function(n,t,e,r){var i=[],o=n._versions,a=n._dbSchema=hr(n,n.idbdb,r),u=!1;function c(){return i.length?Tt.resolve(i.shift()(e.idbtrans)).then(c):Tt.resolve()}return o.filter((function(n){return n._cfg.version>=t})).forEach((function(o){i.push((function(){var i=a,c=o._cfg.dbschema;dr(n,i,r),dr(n,c,r),a=n._dbSchema=c;var s=function(n,t){var e,r={del:[],add:[],change:[]};for(e in n)t[e]||r.del.push(e);for(e in t){var i=n[e],o=t[e];if(i){var a={name:e,def:o,recreate:!1,del:[],add:[],change:[]};if(i.primKey.src===o.primKey.src||ge){var u=i.idxByName,c=o.idxByName,s=void 0;for(s in u)c[s]||a.del.push(s);for(s in c){var l=u[s],f=c[s];l?l.src!==f.src&&a.change.push(f):a.add.push(f)}(a.del.length>0||a.add.length>0||a.change.length>0)&&r.change.push(a)}else a.recreate=!0,r.change.push(a)}else r.add.push([e,o])}return r}(i,c);s.add.forEach((function(n){lr(r,n[0],n[1].primKey,n[1].indexes)})),s.change.forEach((function(n){if(n.recreate)throw new tt.Upgrade("Not yet support for changing primary key");var t=r.objectStore(n.name);n.add.forEach((function(n){return fr(t,n)})),n.change.forEach((function(n){t.deleteIndex(n.name),fr(t,n)})),n.del.forEach((function(n){return t.deleteIndex(n)}))}));var l=o._cfg.contentUpgrade;if(l&&o._cfg.version>t){or(n,r),u=!0;var f=En(c);s.del.forEach((function(n){f[n]=i[n]})),ur(n,[n.Transaction.prototype]),ar(n,[n.Transaction.prototype],rn(f),f),e.schema=f;var h,d=Mn(l);d&&re();var p=Tt.follow((function(){if((h=l(e))&&d){var n=ie.bind(null,null);h.then(n,n)}}));return h&&"function"==typeof h.then?Tt.resolve(h):p.then((function(){return h}))}})),i.push((function(t){u&&be||function(n,t){for(var e=0;e<t.db.objectStoreNames.length;++e){var r=t.db.objectStoreNames[e];null==n[r]&&t.db.deleteObjectStore(r)}}(o._cfg.dbschema,t);ur(n,[n.Transaction.prototype]),ar(n,[n.Transaction.prototype],n._storeNames,n._dbSchema),e.schema=n._dbSchema}))})),c().then((function(){var n,t;t=r,rn(n=a).forEach((function(e){t.db.objectStoreNames.contains(e)||lr(t,e,n[e].primKey,n[e].indexes)}))}))}(n,t,o,e).catch(a)}))}function lr(n,t,e,r){var i=n.db.createObjectStore(t,e.keyPath?{keyPath:e.keyPath,autoIncrement:e.auto}:{autoIncrement:e.auto});return r.forEach((function(n){return fr(i,n)})),i}function fr(n,t){n.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function hr(n,t,e){var r={};return mn(t.objectStoreNames,0).forEach((function(n){for(var t=e.objectStore(n),i=t.keyPath,o=Qe(Ye(i),i||"",!1,!1,!!t.autoIncrement,i&&"string"!=typeof i,!0),a=[],u=0;u<t.indexNames.length;++u){var c=t.index(t.indexNames[u]);i=c.keyPath;var s=Qe(c.name,i,!!c.unique,!!c.multiEntry,!1,i&&"string"!=typeof i,!1);a.push(s)}r[n]=Xe(n,o,a)})),r}function dr(n,t,e){for(var r=e.db.objectStoreNames,i=0;i<r.length;++i){var o=r[i],a=e.objectStore(o);n._hasGetAll="getAll"in a;for(var u=0;u<a.indexNames.length;++u){var c=a.indexNames[u],s=a.index(c).keyPath,l="string"==typeof s?s:"["+mn(s).join("+")+"]";if(t[o]){var f=t[o].idxByName[l];f&&(f.name=c,delete t[o].idxByName[l],t[o].idxByName[c]=f)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&an.WorkerGlobalScope&&an instanceof an.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(n._hasGetAll=!1)}var pr,vr=function(){function n(){}return n.prototype._parseStoresSpec=function(n,t){rn(n).forEach((function(e){if(null!==n[e]){var r=n[e].split(",").map((function(n,t){var e=(n=n.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(e)?e.match(/^\[(.*)\]$/)[1].split("+"):e;return Qe(e,r||null,/\&/.test(n),/\*/.test(n),/\+\+/.test(n),on(r),0===t)})),i=r.shift();if(i.multi)throw new tt.Schema("Primary key cannot be multi-valued");r.forEach((function(n){if(n.auto)throw new tt.Schema("Only primary key can be marked as autoIncrement (++)");if(!n.keyPath)throw new tt.Schema("Index must have a name and cannot be an empty string")})),t[e]=Xe(e,i,r)}}))},n.prototype.stores=function(n){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?un(this._cfg.storesSource,n):n;var e=t._versions,r={},i={};return e.forEach((function(n){un(r,n._cfg.storesSource),i=n._cfg.dbschema={},n._parseStoresSpec(r,i)})),t._dbSchema=i,ur(t,[t._allTables,t,t.Transaction.prototype]),ar(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],rn(i),i),t._storeNames=rn(i),this},n.prototype.upgrade=function(n){return this._cfg.contentUpgrade=n,this},n}();function yr(n){return ee((function(){return Rt.letThrough=!0,n()}))}function mr(n){var t=n._state,e=n._deps.indexedDB;if(t.isBeingOpened||n.idbdb)return t.dbReadyPromise.then((function(){return t.dbOpenError?pe(t.dbOpenError):n}));Nn&&(t.openCanceller._stackHolder=Ln()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.dbReadyResolve,i=null;return Tt.race([t.openCanceller,new Tt((function(r,o){if(!e)throw new tt.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var a=n.name,u=t.autoSchema?e.open(a):e.open(a,Math.round(10*n.verno));if(!u)throw new tt.MissingAPI("IndexedDB API not available");u.onerror=We(o),u.onblocked=Qt(n._fireOnBlocked),u.onupgradeneeded=Qt((function(r){if(i=u.transaction,t.autoSchema&&!n._options.allowEmptyDB){u.onerror=Ge,i.abort(),u.result.close();var c=e.deleteDatabase(a);c.onsuccess=c.onerror=Qt((function(){o(new tt.NoSuchDatabase("Database "+a+" doesnt exist"))}))}else{i.onerror=We(o);var s=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;n.idbdb=u.result,sr(n,s/10,i,o)}}),o),u.onsuccess=Qt((function(){i=null;var e=n.idbdb=u.result,o=mn(e.objectStoreNames);if(o.length>0)try{var c=e.transaction(Le(o),"readonly");t.autoSchema?function(n,t,e){n.verno=t.version/10;var r=n._dbSchema=hr(0,t,e);n._storeNames=mn(t.objectStoreNames,0),ar(n,[n._allTables],rn(r),r)}(n,e,c):dr(n,n._dbSchema,c),or(n,c)}catch(n){}me.push(n),e.onversionchange=Qt((function(e){t.vcFired=!0,n.on("versionchange").fire(e)})),pr.add(a),r()}),o)}))]).then((function(){return t.onReadyBeingFired=[],Tt.resolve(yr(n.on.ready.fire)).then((function n(){if(t.onReadyBeingFired.length>0){var e=t.onReadyBeingFired.reduce(ht,it);return t.onReadyBeingFired=[],Tt.resolve(yr(e)).then(n)}}))})).finally((function(){t.onReadyBeingFired=null})).then((function(){return t.isBeingOpened=!1,n})).catch((function(e){try{i&&i.abort()}catch(n){}return t.isBeingOpened=!1,n.close(),t.dbOpenError=e,pe(t.dbOpenError)})).finally((function(){t.openComplete=!0,r()}))}function gr(n){var t=function(t){return n.next(t)},e=i(t),r=i((function(t){return n.throw(t)}));function i(n){return function(t){var i=n(t),o=i.value;return i.done?o:o&&"function"==typeof o.then?o.then(e,r):on(o)?Promise.all(o).then(e,r):e(o)}}return i(t)()}function br(n,t,e){var r=arguments.length;if(r<2)throw new tt.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];e=i.pop();var o=On(i);return[n,o,e]}function _r(n,t,e,r,i){return Tt.resolve().then((function(){var o=Rt.transless||Rt,a=n._createTransaction(t,e,n._dbSchema,r),u={trans:a,transless:o};r?a.idbtrans=r.idbtrans:a.create();var c,s=Mn(i);s&&re();var l=Tt.follow((function(){if(c=i.call(a,a))if(s){var n=ie.bind(null,null);c.then(n,n)}else"function"==typeof c.next&&"function"==typeof c.throw&&(c=gr(c))}),u);return(c&&"function"==typeof c.then?Tt.resolve(c).then((function(n){return a.active?n:pe(new tt.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):l.then((function(){return c}))).then((function(n){return r&&a._resolve(),a._completion.then((function(){return n}))})).catch((function(n){return a._reject(n),pe(n)}))}))}function wr(n,t,e){for(var r=on(n)?n.slice():[n],i=0;i<e;++i)r.push(t);return r}var xr={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(n){return tn(tn({},n),{table:function(t){var e=n.table(t),r=e.schema,i={},o=[];function a(n,t,e){var r=er(n),u=i[r]=i[r]||[],c=null==n?0:"string"==typeof n?1:n.length,s=t>0,l=tn(tn({},e),{isVirtual:s,isPrimaryKey:!s&&e.isPrimaryKey,keyTail:t,keyLength:c,extractKey:Je(n),unique:!s&&e.unique});(u.push(l),l.isPrimaryKey||o.push(l),c>1)&&a(2===c?n[0]:n.slice(0,c-1),t+1,e);return u.sort((function(n,t){return n.keyTail-t.keyTail})),l}var u=a(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[u];for(var c=0,s=r.indexes;c<s.length;c++){var l=s[c];a(l.keyPath,0,l)}function f(t){var e,r,i=t.query.index;return i.isVirtual?tn(tn({},t),{query:{index:i,range:(e=t.query.range,r=i.keyTail,{type:1===e.type?2:e.type,lower:wr(e.lower,e.lowerOpen?n.MAX_KEY:n.MIN_KEY,r),lowerOpen:!0,upper:wr(e.upper,e.upperOpen?n.MIN_KEY:n.MAX_KEY,r),upperOpen:!0})}}):t}return tn(tn({},e),{schema:tn(tn({},r),{primaryKey:u,indexes:o,getIndexByKeyPath:function(n){var t=i[er(n)];return t&&t[0]}}),count:function(n){return e.count(f(n))},query:function(n){return e.query(f(n))},openCursor:function(t){var r=t.query.index,i=r.keyTail,o=r.isVirtual,a=r.keyLength;if(!o)return e.openCursor(t);return e.openCursor(f(t)).then((function(e){return e&&function(e){return Object.create(e,{continue:{value:function(r){null!=r?e.continue(wr(r,t.reverse?n.MAX_KEY:n.MIN_KEY,i)):t.unique?e.continue(wr(e.key,t.reverse?n.MIN_KEY:n.MAX_KEY,i)):e.continue()}},continuePrimaryKey:{value:function(t,r){e.continuePrimaryKey(wr(t,n.MAX_KEY,i),r)}},key:{get:function(){var n=e.key;return 1===a?n[0]:n.slice(0,a)}},value:{get:function(){return e.value}}})}(e)}))}})}})}},kr={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(n){return tn(tn({},n),{table:function(t){var e=n.table(t),r=e.schema.primaryKey;return tn(tn({},e),{mutate:function(n){var i=Rt.trans,o=i.table(t).hook,a=o.deleting,u=o.creating,c=o.updating;switch(n.type){case"add":if(u.fire===it)break;return i._promise("readwrite",(function(){return s(n)}),!0);case"put":if(u.fire===it&&c.fire===it)break;return i._promise("readwrite",(function(){return s(n)}),!0);case"delete":if(a.fire===it)break;return i._promise("readwrite",(function(){return s(n)}),!0);case"deleteRange":if(a.fire===it)break;return i._promise("readwrite",(function(){return function(n){return function n(t,i,o){return e.query({trans:t,values:!1,query:{index:r,range:i},limit:o}).then((function(e){var r=e.result;return s({type:"delete",keys:r,trans:t}).then((function(e){return e.numFailures>0?Promise.reject(e.failures[0]):r.length<o?{failures:[],numFailures:0,lastResult:void 0}:n(t,tn(tn({},i),{lower:r[r.length-1],lowerOpen:!0}),o)}))}))}(n.trans,n.range,1e4)}(n)}),!0)}return e.mutate(n);function s(n){var t=Rt.trans,i=n.keys||Ze(r,n);if(!i)throw new Error("Keys missing");return"delete"!==(n="add"===n.type||"put"===n.type?tn(tn({},n),{keys:i,wantResults:!0}):tn({},n)).type&&(n.values=en(n.values)),n.keys&&(n.keys=en(n.keys)),function(n,t,e){return"add"===t.type?Promise.resolve(new Array(t.values.length)):n.getMany({trans:t.trans,keys:e})}(e,n,i).then((function(o){var s=i.map((function(e,i){var s=o[i],l={onerror:null,onsuccess:null};if("delete"===n.type)a.fire.call(l,e,s,t);else if("add"===n.type||void 0===s){var f=u.fire.call(l,e,n.values[i],t);null==e&&null!=f&&(e=f,n.keys[i]=e,r.outbound||kn(n.values[i],r.keyPath,e))}else{var h=Cn(s,n.values[i]),d=c.fire.call(l,h,e,s,t);if(d){var p=n.values[i];Object.keys(d).forEach((function(n){kn(p,n,d[n])}))}}return l}));return e.mutate(n).then((function(t){for(var e=t.failures,r=t.results,a=t.numFailures,u=t.lastResult,c=0;c<i.length;++c){var l=r?r[c]:i[c],f=s[c];null==l?f.onerror&&f.onerror(e[c]):f.onsuccess&&f.onsuccess("put"===n.type&&o[c]?n.values[c]:l)}return{failures:e,results:r,numFailures:a,lastResult:u}})).catch((function(n){return s.forEach((function(t){return t.onerror&&t.onerror(n)})),Promise.reject(n)}))}))}}})}})}},Er=function(){function n(t,e){var r=this;this._middlewares={},this.verno=0;var i=n.dependencies;this._options=e=tn({addons:n.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},e),this._deps={indexedDB:e.indexedDB,IDBKeyRange:e.IDBKeyRange};var o=e.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null;var a={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:it,dbReadyPromise:null,cancelOpen:it,openCanceller:null,autoSchema:!0};a.dbReadyPromise=new Tt((function(n){a.dbReadyResolve=n})),a.openCanceller=new Tt((function(n,t){a.cancelOpen=t})),this._state=a,this.name=t,this.on=Pe(this,"populate","blocked","versionchange",{ready:[ht,it]}),this.on.ready.subscribe=gn(this.on.ready.subscribe,(function(t){return function(e,i){n.vip((function(){var n=r._state;if(n.openComplete)n.dbOpenError||Tt.resolve().then(e),i&&t(e);else if(n.onReadyBeingFired)n.onReadyBeingFired.push(e),i&&t(e);else{t(e);var o=r;i||t((function n(){o.on.ready.unsubscribe(e),o.on.ready.unsubscribe(n)}))}}))}})),this.Collection=function(n){return Oe(Ce.prototype,(function(t,e){this.db=n;var r=ke,i=null;if(e)try{r=e()}catch(n){i=n}var o=t._ctx,a=o.table,u=a.hook.reading.fire;this._ctx={table:a,index:o.index,isPrimKey:!o.index||a.schema.primKey.keyPath&&o.index===a.schema.primKey.name,range:r,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:i,or:o.or,valueMapper:u!==ot?u:null}}))}(this),this.Table=function(n){return Oe(Ee.prototype,(function(t,e,r){this.db=n,this._tx=r,this.name=t,this.schema=e,this.hook=n._allTables[t]?n._allTables[t].hook:Pe(null,{creating:[ct,it],reading:[at,ot],updating:[lt,it],deleting:[st,it]})}))}(this),this.Transaction=function(n){return Oe(He.prototype,(function(t,e,r,i){var o=this;this.db=n,this.mode=t,this.storeNames=e,this.schema=r,this.idbtrans=null,this.on=Pe(this,"complete","error","abort"),this.parent=i||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Tt((function(n,t){o._resolve=n,o._reject=t})),this._completion.then((function(){o.active=!1,o.on.complete.fire()}),(function(n){var t=o.active;return o.active=!1,o.on.error.fire(n),o.parent?o.parent._reject(n):t&&o.idbtrans&&o.idbtrans.abort(),pe(n)}))}))}(this),this.Version=function(n){return Oe(vr.prototype,(function(t){this.db=n,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(n){return Oe(Ue.prototype,(function(t,e,r){this.db=n,this._ctx={table:t,index:":id"===e?null:e,or:r};var i=n._deps.indexedDB;if(!i)throw new tt.MissingAPI("indexedDB API missing");this._cmp=this._ascending=i.cmp.bind(i),this._descending=function(n,t){return i.cmp(t,n)},this._max=function(n,t){return i.cmp(n,t)>0?n:t},this._min=function(n,t){return i.cmp(n,t)<0?n:t},this._IDBKeyRange=n._deps.IDBKeyRange}))}(this),this.on("versionchange",(function(n){n.newVersion>0?console.warn("Another connection wants to upgrade database '"+r.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+r.name+"'. Closing db now to resume the delete request."),r.close()})),this.on("blocked",(function(n){!n.newVersion||n.newVersion<n.oldVersion?console.warn("Dexie.delete('"+r.name+"') was blocked"):console.warn("Upgrade '"+r.name+"' blocked by other connection holding version "+n.oldVersion/10)})),this._maxKey=ze(e.IDBKeyRange),this._createTransaction=function(n,t,e,i){return new r.Transaction(n,t,e,i)},this._fireOnBlocked=function(n){r.on("blocked").fire(n),me.filter((function(n){return n.name===r.name&&n!==r&&!n._state.vcFired})).map((function(t){return t.on("versionchange").fire(n)}))},this.use(xr),this.use(kr),o.forEach((function(n){return n(r)}))}return n.prototype.version=function(n){if(isNaN(n)||n<.1)throw new tt.Type("Given version is not a positive number");if(n=Math.round(10*n)/10,this.idbdb||this._state.isBeingOpened)throw new tt.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var t=this._versions,e=t.filter((function(t){return t._cfg.version===n}))[0];return e||(e=new this.Version(n),t.push(e),t.sort(cr),e.stores({}),this._state.autoSchema=!1,e)},n.prototype._whenReady=function(n){var t=this;return this._state.openComplete||Rt.letThrough?n():new Tt((function(n,e){if(!t._state.isBeingOpened){if(!t._options.autoOpen)return void e(new tt.DatabaseClosed);t.open().catch(it)}t._state.dbReadyPromise.then(n,e)})).then(n)},n.prototype.use=function(n){var t=n.stack,e=n.create,r=n.level,i=n.name;i&&this.unuse({stack:t,name:i});var o=this._middlewares[t]||(this._middlewares[t]=[]);return o.push({stack:t,create:e,level:null==r?10:r,name:i}),o.sort((function(n,t){return n.level-t.level})),this},n.prototype.unuse=function(n){var t=n.stack,e=n.name,r=n.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter((function(n){return r?n.create!==r:!!e&&n.name!==e}))),this},n.prototype.open=function(){return mr(this)},n.prototype.close=function(){var n=me.indexOf(this),t=this._state;if(n>=0&&me.splice(n,1),this.idbdb){try{this.idbdb.close()}catch(n){}this.idbdb=null}this._options.autoOpen=!1,t.dbOpenError=new tt.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError),t.dbReadyPromise=new Tt((function(n){t.dbReadyResolve=n})),t.openCanceller=new Tt((function(n,e){t.cancelOpen=e}))},n.prototype.delete=function(){var n=this,t=arguments.length>0,e=this._state;return new Tt((function(r,i){var o=function(){n.close();var t=n._deps.indexedDB.deleteDatabase(n.name);t.onsuccess=Qt((function(){pr.remove(n.name),r()})),t.onerror=We(i),t.onblocked=n._fireOnBlocked};if(t)throw new tt.InvalidArgument("Arguments not allowed in db.delete()");e.isBeingOpened?e.dbReadyPromise.then(o):o()}))},n.prototype.backendDB=function(){return this.idbdb},n.prototype.isOpen=function(){return null!==this.idbdb},n.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&"DatabaseClosed"===n.name},n.prototype.hasFailed=function(){return null!==this._state.dbOpenError},n.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(n.prototype,"tables",{get:function(){var n=this;return rn(this._allTables).map((function(t){return n._allTables[t]}))},enumerable:!0,configurable:!0}),n.prototype.transaction=function(){var n=br.apply(this,arguments);return this._transaction.apply(this,n)},n.prototype._transaction=function(n,t,e){var r=this,i=Rt.trans;i&&i.db===this&&-1===n.indexOf("!")||(i=null);var o,a,u=-1!==n.indexOf("?");n=n.replace("!","").replace("?","");try{if(a=t.map((function(n){var t=n instanceof r.Table?n.name:n;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t})),"r"==n||"readonly"===n)o="readonly";else{if("rw"!=n&&"readwrite"!=n)throw new tt.InvalidArgument("Invalid transaction mode: "+n);o="readwrite"}if(i){if("readonly"===i.mode&&"readwrite"===o){if(!u)throw new tt.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&a.forEach((function(n){if(i&&-1===i.storeNames.indexOf(n)){if(!u)throw new tt.SubTransaction("Table "+n+" not included in parent transaction.");i=null}})),u&&i&&!i.active&&(i=null)}}catch(n){return i?i._promise(null,(function(t,e){e(n)})):pe(n)}var c=_r.bind(null,this,o,a,i,e);return i?i._promise(o,c,"lock"):Rt.trans?le(Rt.transless,(function(){return r._whenReady(c)})):this._whenReady(c)},n.prototype.table=function(n){if(!ln(this._allTables,n))throw new tt.InvalidTable("Table "+n+" does not exist");return this._allTables[n]},n}(),Pr=Er;fn(Pr,tn(tn({},rt),{delete:function(n){return new Pr(n).delete()},exists:function(n){return new Pr(n,{addons:[]}).open().then((function(n){return n.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(n){return pr?pr.getDatabaseNames().then(n):Tt.resolve([])},defineClass:function(){return function(n){un(this,n)}},ignoreTransaction:function(n){return Rt.trans?le(Rt.transless,n):n()},vip:yr,async:function(n){return function(){try{var t=gr(n.apply(this,arguments));return t&&"function"==typeof t.then?t:Tt.resolve(t)}catch(n){return pe(n)}}},spawn:function(n,t,e){try{var r=gr(n.apply(e,t||[]));return r&&"function"==typeof r.then?r:Tt.resolve(r)}catch(n){return pe(n)}},currentTransaction:{get:function(){return Rt.trans||null}},waitFor:function(n,t){var e=Tt.resolve("function"==typeof n?Pr.ignoreTransaction(n):n).timeout(t||6e4);return Rt.trans?Rt.trans.waitFor(e):e},Promise:Tt,debug:{get:function(){return Nn},set:function(n){qn(n,"dexie"===n?function(){return!0}:we)}},derive:pn,extend:un,props:fn,override:gn,Events:Pe,getByKeyPath:xn,setByKeyPath:kn,delByKeyPath:function(n,t){"string"==typeof t?kn(n,t,void 0):"length"in t&&[].map.call(t,(function(t){kn(n,t,void 0)}))},shallowClone:En,deepClone:In,getObjectDiff:Cn,asap:_n,minKey:-1/0,addons:[],connections:me,errnames:Zn,dependencies:function(){try{return{indexedDB:an.indexedDB||an.mozIndexedDB||an.webkitIndexedDB||an.msIndexedDB,IDBKeyRange:an.IDBKeyRange||an.webkitIDBKeyRange}}catch(n){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:"3.0.1",version:"3.0.1".split(".").map((function(n){return parseInt(n)})).reduce((function(n,t,e){return n+t/Math.pow(10,2*e)})),default:Pr,Dexie:Pr})),Pr.maxKey=ze(Pr.dependencies.IDBKeyRange),function(n){try{pr=function(n){var t,e=n&&"function"==typeof n.databases;if(!e){var r=new Er("__dbnames",{addons:[]});r.version(1).stores({dbnames:"name"}),t=r.table("dbnames")}return{getDatabaseNames:function(){return e?Tt.resolve(n.databases()).then((function(n){return n.map((function(n){return n.name})).filter((function(n){return"__dbnames"!==n}))})):t.toCollection().primaryKeys()},add:function(n){return!e&&"__dbnames"!==n&&t.put({name:n}).catch(it)},remove:function(n){return!e&&"__dbnames"!==n&&t.delete(n).catch(it)}}}(n)}catch(n){}}(Er.dependencies.indexedDB),Tt.rejectionMapper=function(n,t){if(!n||n instanceof Qn||n instanceof TypeError||n instanceof SyntaxError||!n.name||!et[n.name])return n;var e=new et[n.name](t||n.message,n);return"stack"in n&&dn(e,"stack",{get:function(){return this.inner.stack}}),e},qn(Nn,we);var Or,Sr={files:"&file_id, hash, *user_tags, *service_names_to_statuses_to_tags.all_known_tags"};function jr(){return Or||(Or=new Er("miia-cache")).version(1).stores(Sr),Or.files}function Ar(n){if("service_names_to_statuses_to_tags"in n){var t=n.service_names_to_statuses_to_tags;for(var e in t){if(t.hasOwnProperty(e))t[e.split(" ").join("_")]=Ir(t[e]),delete t[e]}n.service_names_to_statuses_to_tags=t}return n}function Ir(n){var t=[];for(var e in n)n.hasOwnProperty(e)&&(t=t.concat(n[e]));return t}function Rr(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;return new Promise((function(e){setTimeout(e.bind(null,t),n)}))}function Dr(n){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(n){return!1}}();return function(){var i,o=e(n);if(t){var a=e(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return r(this,i)}}function Kr(n){var t,e,r,i=n[13].message+"";return{c:function(){t=l("div"),e=l("pre"),r=E(i),this.h()},l:function(n){t=f(n,"DIV",{class:!0});var o=h(t);e=f(o,"PRE",{style:!0});var a=h(e);r=P(a,i),a.forEach(d),o.forEach(d),this.h()},h:function(){O(e,"color","red"),p(t,"class","card-body")},m:function(n,i){y(n,t,i),S(t,e),S(e,r)},p:function(n,t){1&t&&i!==(i=n[13].message+"")&&j(r,i)},d:function(n){n&&d(t)}}}function Cr(n){var t,e,r,i;return{c:function(){t=l("img"),this.h()},l:function(n){t=f(n,"IMG",{src:!0,alt:!0,id:!0,class:!0}),this.h()},h:function(){t.src!==(e=URL.createObjectURL(n[12]))&&p(t,"src",e),p(t,"alt",n[0]),p(t,"id",n[0]),p(t,"class","svelte-1x1zhyt")},m:function(e,o){y(e,t,o),n[8](t),r||(i=[A(t,"load",n[4]),A(t,"click",n[5])],r=!0)},p:function(n,r){1&r&&t.src!==(e=URL.createObjectURL(n[12]))&&p(t,"src",e),1&r&&p(t,"alt",n[0]),1&r&&p(t,"id",n[0])},d:function(e){e&&d(t),n[8](null),r=!1,I(i)}}}function Tr(n){var t,e,r,i,o,a;return{c:function(){t=l("div"),e=l("div"),r=R(),i=l("p"),o=E("Querying "),a=E(n[0]),this.h()},l:function(u){t=f(u,"DIV",{class:!0});var c=h(t);e=f(c,"DIV",{class:!0,role:!0,"aria-hidden":!0}),h(e).forEach(d),r=D(c),i=f(c,"P",{});var s=h(i);o=P(s,"Querying "),a=P(s,n[0]),s.forEach(d),c.forEach(d),this.h()},h:function(){p(e,"class","spinner-border"),p(e,"role","status"),p(e,"aria-hidden","true"),p(t,"class","card-body loading svelte-1x1zhyt")},m:function(n,u){y(n,t,u),S(t,e),S(t,r),S(t,i),S(i,o),S(i,a)},p:function(n,t){1&t&&j(a,n[0])},d:function(n){n&&d(t)}}}function Br(n){var t,e,r={ctx:n,current:null,token:null,pending:Tr,then:Cr,catch:Kr,value:12,error:13};return s(e=n[3](n[0]),r),{c:function(){t=l("div"),r.block.c(),this.h()},l:function(n){t=f(n,"DIV",{class:!0});var e=h(t);r.block.l(e),e.forEach(d),this.h()},h:function(){p(t,"class","card svelte-1x1zhyt"),v(t,"active",n[1])},m:function(n,e){y(n,t,e),r.block.m(t,r.anchor=null),r.mount=function(){return t},r.anchor=null},p:function(i,o){var a=m(o,1)[0];if(n=i,r.ctx=n,1&a&&e!==(e=n[3](n[0]))&&s(e,r));else{var u=n.slice();u[12]=r.resolved,r.block.p(u,a)}2&a&&v(t,"active",n[1])},i:g,o:g,d:function(n){n&&d(t),r.block.d(),r.token=null,r=null}}}function $r(n,t,e){var r,i=t.file_id,o=t.max_width,a=void 0===o?200:o,u=t.max_height,c=void 0===u?200:u,s=t.active,l=void 0!==s&&s,f=b();function h(){return(h=w(x.mark((function n(t){var e;return x.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=X(),n.next=3,e.get_thumbnail({file_id:t});case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return _(w(x.mark((function n(){return x.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:case"end":return n.stop()}}),n)})))),n.$set=function(n){"file_id"in n&&e(0,i=n.file_id),"max_width"in n&&e(6,a=n.max_width),"max_height"in n&&e(7,c=n.max_height),"active"in n&&e(1,l=n.active)},[i,l,r,function(n){return h.apply(this,arguments)},function(){var n,t,i,o,u,s=(n=r.naturalWidth,t=r.naturalHeight,i=a,o=c,u=Math.min(i/n,o/t),{width:n*u,height:t*u});e(2,r.width=s.width,r),e(2,r.height=s.height,r)},function(n){f("click",{source_event:n,file_id:i,dom_image:r})},a,c,function(n){k[n?"unshift":"push"]((function(){e(2,r=n)}))}]}var Fr=function(n){t(r,c);var e=Dr(r);function r(n){var t;return i(this,r),t=e.call(this),o(u(t),n,$r,Br,a,{file_id:0,max_width:6,max_height:7,active:1}),t}return r}();function Mr(n){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(n){return!1}}();return function(){var i,o=e(n);if(t){var a=e(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return r(this,i)}}function Nr(n){var t,e,r={ctx:n,current:null,token:null,pending:Ur,then:Vr,catch:qr,value:7,error:8};return s(e=n[3](n[0]),r),{c:function(){t=l("div"),r.block.c(),this.h()},l:function(n){t=f(n,"DIV",{class:!0});var e=h(t);r.block.l(e),e.forEach(d),this.h()},h:function(){p(t,"class","media-container svelte-wqnnid")},m:function(n,e){y(n,t,e),r.block.m(t,r.anchor=null),r.mount=function(){return t},r.anchor=null},p:function(t,i){if(n=t,r.ctx=n,1&i&&e!==(e=n[3](n[0]))&&s(e,r));else{var o=n.slice();o[7]=r.resolved,r.block.p(o,i)}},d:function(n){n&&d(t),r.block.d(),r.token=null,r=null}}}function qr(n){var t,e,r,i=n[8].message+"";return{c:function(){t=R(),e=l("pre"),r=E(i),this.h()},l:function(n){t=D(n),e=f(n,"PRE",{style:!0});var o=h(e);r=P(o,i),o.forEach(d),this.h()},h:function(){O(e,"color","red")},m:function(n,i){y(n,t,i),y(n,e,i),S(e,r)},p:function(n,t){1&t&&i!==(i=n[8].message+"")&&j(r,i)},d:function(n){n&&d(t),n&&d(e)}}}function Vr(n){var t,e;return{c:function(){t=l("img"),this.h()},l:function(n){t=f(n,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h:function(){p(t,"class","img-fluid svelte-wqnnid"),t.src!==(e=n[7])&&p(t,"src",e),p(t,"alt","")},m:function(n,e){y(n,t,e)},p:function(n,r){1&r&&t.src!==(e=n[7])&&p(t,"src",e)},d:function(n){n&&d(t)}}}function Ur(n){var t,e,r,i,o;return{c:function(){t=l("div"),r=R(),i=l("h4"),o=E(n[0]),this.h()},l:function(e){t=f(e,"DIV",{class:!0,role:!0,title:!0,"aria-hidden":!0}),h(t).forEach(d),r=D(e),i=f(e,"H4",{});var a=h(i);o=P(a,n[0]),a.forEach(d),this.h()},h:function(){p(t,"class","spinner-border svelte-wqnnid"),p(t,"role","status"),p(t,"title",e="Downloading "+n[0]),p(t,"aria-hidden","true")},m:function(n,e){y(n,t,e),y(n,r,e),y(n,i,e),S(i,o)},p:function(n,r){1&r&&e!==(e="Downloading "+n[0])&&p(t,"title",e),1&r&&j(o,n[0])},d:function(n){n&&d(t),n&&d(r),n&&d(i)}}}function Lr(t){var e,r=t[2]&&"object"===n(t[1])&&J(t[1].mime),i=r&&Nr(t);return{c:function(){i&&i.c(),e=K()},l:function(n){i&&i.l(n),e=K()},m:function(n,t){i&&i.m(n,t),y(n,e,t)},p:function(t,o){var a=m(o,1)[0];6&a&&(r=t[2]&&"object"===n(t[1])&&J(t[1].mime)),r?i?i.p(t,a):((i=Nr(t)).c(),i.m(e.parentNode,e)):i&&(i.d(1),i=null)},i:g,o:g,d:function(n){i&&i.d(n),n&&d(e)}}}function zr(n,t,e){var r,i=t.file_id,o=t.metadata,a=void 0===o?void 0:o,u=t.enabled,c=void 0!==u&&u,s=t.file,l=void 0===s?null:s;function f(){return(f=w(x.mark((function n(t){var o,u;return x.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r&&URL.revokeObjectURL(r),o=X(),n.next=4,o.get_file({file_id:i});case 4:return u=n.sent,e(4,l=new File([u],String(i)+a.ext,{type:a.mime})),r=URL.createObjectURL(l),n.abrupt("return",r);case 8:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return _((function(){return function(){r&&URL.revokeObjectURL(r)}})),n.$set=function(n){"file_id"in n&&e(0,i=n.file_id),"metadata"in n&&e(1,a=n.metadata),"enabled"in n&&e(2,c=n.enabled),"file"in n&&e(4,l=n.file)},[i,a,c,function(n){return f.apply(this,arguments)},l]}var Wr=function(n){t(r,c);var e=Mr(r);function r(n){var t;return i(this,r),t=e.call(this),o(u(t),n,zr,Lr,a,{file_id:0,metadata:1,enabled:2,file:4}),t}return r}();function Gr(n){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(n){return!1}}();return function(){var i,o=e(n);if(t){var a=e(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return r(this,i)}}function Hr(n){var t,e,r,i,o,a,u,c,s,v,m,g,b,_=[Yr,Qr],w=[];function x(n,t){return"number"==typeof n[0]?0:1}i=x(n),o=w[i]=_[i](n);var k=n[0]>0&&ni(n),O=n[0]<n[2].length-1&&ti(n);return{c:function(){t=l("div"),e=l("div"),r=l("div"),o.c(),a=R(),k&&k.c(),u=R(),O&&O.c(),c=R(),s=l("button"),v=E(""),this.h()},l:function(n){t=f(n,"DIV",{class:!0});var i=h(t);e=f(i,"DIV",{class:!0});var l=h(e);r=f(l,"DIV",{class:!0});var p=h(r);o.l(p),p.forEach(d),l.forEach(d),a=D(i),k&&k.l(i),u=D(i),O&&O.l(i),c=D(i),s=f(i,"BUTTON",{class:!0});var y=h(s);v=P(y,""),y.forEach(d),i.forEach(d),this.h()},h:function(){p(r,"class","file current svelte-10eztrw"),p(e,"class","files svelte-10eztrw"),p(s,"class","close svelte-10eztrw"),p(t,"class","background svelte-10eztrw")},m:function(o,l){y(o,t,l),S(t,e),S(e,r),w[i].m(r,null),S(t,a),k&&k.m(t,null),S(t,u),O&&O.m(t,null),S(t,c),S(t,s),S(s,v),m=!0,g||(b=A(s,"click",n[6]),g=!0)},p:function(n,e){var a=i;(i=x(n))===a?w[i].p(n,e):(C(),T(w[a],1,1,(function(){w[a]=null})),B(),(o=w[i])||(o=w[i]=_[i](n)).c(),$(o,1),o.m(r,null)),n[0]>0?k?k.p(n,e):((k=ni(n)).c(),k.m(t,u)):k&&(k.d(1),k=null),n[0]<n[2].length-1?O?O.p(n,e):((O=ti(n)).c(),O.m(t,c)):O&&(O.d(1),O=null)},i:function(n){m||($(o),m=!0)},o:function(n){T(o),m=!1},d:function(n){n&&d(t),w[i].d(),k&&k.d(),O&&O.d(),g=!1,b()}}}function Qr(n){var t,e,r,i,o;return{c:function(){t=l("pre"),e=E("index ["),r=E(n[0]),i=E("] is not a number"),o=R(),this.h()},l:function(a){t=f(a,"PRE",{style:!0});var u=h(t);e=P(u,"index ["),r=P(u,n[0]),i=P(u,"] is not a number"),u.forEach(d),o=D(a),this.h()},h:function(){O(t,"color","red")},m:function(n,a){y(n,t,a),S(t,e),S(t,r),S(t,i),y(n,o,a)},p:function(n,t){1&t&&j(r,n[0])},i:g,o:g,d:function(n){n&&d(t),n&&d(o)}}}function Yr(n){var t,e,r,i={ctx:n,current:null,token:null,pending:Zr,then:Jr,catch:Xr,value:9,error:10,blocks:[,,,]};return s(e=n[3](n[2][n[0]]),i),{c:function(){t=K(),i.block.c()},l:function(n){t=K(),i.block.l(n)},m:function(n,e){y(n,t,e),i.block.m(n,i.anchor=e),i.mount=function(){return t.parentNode},i.anchor=t,r=!0},p:function(t,r){if(n=t,i.ctx=n,5&r&&e!==(e=n[3](n[2][n[0]]))&&s(e,i));else{var o=n.slice();o[9]=i.resolved,i.block.p(o,r)}},i:function(n){r||($(i.block),r=!0)},o:function(n){for(var t=0;t<3;t+=1){var e=i.blocks[t];T(e)}r=!1},d:function(n){n&&d(t),i.block.d(n),i.token=null,i=null}}}function Xr(n){var t,e,r,i,o,a,u,c,s,p,v,m,b,_,w,x,k=n[2].length+"",A=n[2][n[0]]+"",I=n[10].message+"";return{c:function(){t=l("p"),e=E("Querying\n              "),r=l("code"),i=E(n[0]),o=E("\n              of\n              "),a=l("code"),u=E("file_ids["),c=E(k),s=E("]"),p=R(),v=E(A),m=E("'s metadata"),b=R(),_=l("pre"),w=E(I),x=R(),this.h()},l:function(l){t=f(l,"P",{style:!0});var y=h(t);e=P(y,"Querying\n              "),r=f(y,"CODE",{});var g=h(r);i=P(g,n[0]),g.forEach(d),o=P(y,"\n              of\n              "),a=f(y,"CODE",{});var E=h(a);u=P(E,"file_ids["),c=P(E,k),s=P(E,"]"),E.forEach(d),p=D(y),v=P(y,A),m=P(y,"'s metadata"),y.forEach(d),b=D(l),_=f(l,"PRE",{style:!0});var O=h(_);w=P(O,I),O.forEach(d),x=D(l),this.h()},h:function(){O(t,"color","yellow"),O(_,"color","red")},m:function(n,l){y(n,t,l),S(t,e),S(t,r),S(r,i),S(t,o),S(t,a),S(a,u),S(a,c),S(a,s),S(t,p),S(t,v),S(t,m),y(n,b,l),y(n,_,l),S(_,w),y(n,x,l)},p:function(n,t){1&t&&j(i,n[0]),4&t&&k!==(k=n[2].length+"")&&j(c,k),5&t&&A!==(A=n[2][n[0]]+"")&&j(v,A),5&t&&I!==(I=n[10].message+"")&&j(w,I)},i:g,o:g,d:function(n){n&&d(t),n&&d(b),n&&d(_),n&&d(x)}}}function Jr(n){var t,e;return t=new Wr({props:{file_id:n[2][n[0]],metadata:n[9],enabled:!0}}),{c:function(){F(t.$$.fragment)},l:function(n){M(t.$$.fragment,n)},m:function(n,r){N(t,n,r),e=!0},p:function(n,e){var r={};5&e&&(r.file_id=n[2][n[0]]),5&e&&(r.metadata=n[9]),t.$set(r)},i:function(n){e||($(t.$$.fragment,n),e=!0)},o:function(n){T(t.$$.fragment,n),e=!1},d:function(n){q(t,n)}}}function Zr(n){var t,e;return{c:function(){t=l("div"),this.h()},l:function(n){t=f(n,"DIV",{class:!0,role:!0,title:!0}),h(t).forEach(d),this.h()},h:function(){p(t,"class","spinner-border svelte-10eztrw"),p(t,"role","status"),p(t,"title",e="Querying "+n[2][n[0]]+"'s metadata")},m:function(n,e){y(n,t,e)},p:function(n,r){5&r&&e!==(e="Querying "+n[2][n[0]]+"'s metadata")&&p(t,"title",e)},i:g,o:g,d:function(n){n&&d(t)}}}function ni(n){var t,e,r,i;return{c:function(){t=l("button"),e=E(""),this.h()},l:function(n){t=f(n,"BUTTON",{id:!0,class:!0});var r=h(t);e=P(r,""),r.forEach(d),this.h()},h:function(){p(t,"id","previous"),p(t,"class","nav-buttons svelte-10eztrw")},m:function(o,a){y(o,t,a),S(t,e),r||(i=A(t,"click",n[4]),r=!0)},p:g,d:function(n){n&&d(t),r=!1,i()}}}function ti(n){var t,e,r,i;return{c:function(){t=l("button"),e=E(""),this.h()},l:function(n){t=f(n,"BUTTON",{id:!0,class:!0});var r=h(t);e=P(r,""),r.forEach(d),this.h()},h:function(){p(t,"id","next"),p(t,"class","nav-buttons svelte-10eztrw")},m:function(o,a){y(o,t,a),S(t,e),r||(i=A(t,"click",n[5]),r=!0)},p:g,d:function(n){n&&d(t),r=!1,i()}}}function ei(n){var t,e,r=n[1]&&Hr(n);return{c:function(){r&&r.c(),t=K()},l:function(n){r&&r.l(n),t=K()},m:function(n,i){r&&r.m(n,i),y(n,t,i),e=!0},p:function(n,e){var i=m(e,1)[0];n[1]?r?(r.p(n,i),2&i&&$(r,1)):((r=Hr(n)).c(),$(r,1),r.m(t.parentNode,t)):r&&(C(),T(r,1,1,(function(){r=null})),B())},i:function(n){e||($(r),e=!0)},o:function(n){T(r),e=!1},d:function(n){r&&r.d(n),n&&d(t)}}}function ri(n,t,e){var r=t.file_ids,i=void 0===r?[]:r,o=t.index,a=void 0===o?0:o,u=t.enabled,c=void 0!==u&&u;function s(){return(s=w(x.mark((function n(t){var e;return x.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(e={}).files=jr(),n.next=4,e.files.get({file_id:t});case 4:return n.abrupt("return",n.sent);case 5:case"end":return n.stop()}}),n)})))).apply(this,arguments)}_((function(){}));return n.$set=function(n){"file_ids"in n&&e(2,i=n.file_ids),"index"in n&&e(0,a=n.index),"enabled"in n&&e(1,c=n.enabled)},[a,c,i,function(n){return s.apply(this,arguments)},function(){e(0,a--,a)},function(){e(0,a++,a)},function(){e(1,c=!1)}]}var ii=function(n){t(r,c);var e=Gr(r);function r(n){var t;return i(this,r),t=e.call(this),o(u(t),n,ri,ei,a,{file_ids:2,index:0,enabled:1}),t}return r}();function oi(n){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(n){return!1}}();return function(){var i,o=e(n);if(t){var a=e(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return r(this,i)}}function ai(n,t){var e;if("undefined"==typeof Symbol||null==n[Symbol.iterator]){if(Array.isArray(n)||(e=function(n,t){if(!n)return;if("string"==typeof n)return ui(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);"Object"===e&&n.constructor&&(e=n.constructor.name);if("Map"===e||"Set"===e)return Array.from(n);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return ui(n,t)}(n))||t&&n&&"number"==typeof n.length){e&&(n=e);var r=0,i=function(){};return{s:i,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=n[Symbol.iterator]()},n:function(){var n=e.next();return a=n.done,n},e:function(n){u=!0,o=n},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function ui(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}var ci=H.Map;function si(n,t,e){var r=n.slice();return r[22]=t[e],r[24]=e,r}function li(n,t){var e,r,i,o=t[24];(r=new Fr({props:{file_id:t[22],active:t[0]==t[24]}})).$on("click",(function(){for(var n,e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return(n=t)[12].apply(n,[t[24]].concat(r))}));var a=function(){return t[13](e,o)},u=function(){return t[13](null,o)};return{key:n,first:null,c:function(){e=l("div"),F(r.$$.fragment),this.h()},l:function(n){e=f(n,"DIV",{class:!0});var t=h(e);M(r.$$.fragment,t),t.forEach(d),this.h()},h:function(){p(e,"class","entry svelte-bpbmli"),this.first=e},m:function(n,t){y(n,e,t),N(r,e,null),a(),i=!0},p:function(n,e){t=n;var i={};4&e&&(i.file_id=t[22]),5&e&&(i.active=t[0]==t[24]),r.$set(i),o!==t[24]&&(u(),o=t[24],a())},i:function(n){i||($(r.$$.fragment,n),i=!0)},o:function(n){T(r.$$.fragment,n),i=!1},d:function(n){n&&d(e),q(r),u()}}}function fi(n){var t,e,r,i,o,a,u,c,s,v,m,g,b,_,w,x,k,I,K,C,T=n[2].length+"",B=n[1].length+"",$=n[2].length+"";return{c:function(){t=l("div"),e=l("div"),r=l("p"),i=E("Loaded "),o=E(T),a=E(" / "),u=E(B),c=R(),s=l("div"),v=l("div"),m=E($),_=R(),w=l("div"),x=l("button"),k=E("Load More"),this.h()},l:function(n){t=f(n,"DIV",{class:!0});var l=h(t);e=f(l,"DIV",{class:!0});var p=h(e);r=f(p,"P",{});var y=h(r);i=P(y,"Loaded "),o=P(y,T),a=P(y," / "),u=P(y,B),y.forEach(d),c=D(p),s=f(p,"DIV",{class:!0});var g=h(s);v=f(g,"DIV",{class:!0,role:!0,style:!0,"aria-valuenow":!0,"aria-valuemin":!0,"aria-valuemax":!0});var b=h(v);m=P(b,$),b.forEach(d),g.forEach(d),p.forEach(d),l.forEach(d),_=D(n),w=f(n,"DIV",{class:!0});var E=h(w);x=f(E,"BUTTON",{class:!0,disabled:!0});var O=h(x);k=P(O,"Load More"),O.forEach(d),E.forEach(d),this.h()},h:function(){p(v,"class","progress-bar"),p(v,"role","progressbar"),O(v,"width",n[2].length/n[1].length*100+"%"),p(v,"aria-valuenow",g=n[2].length),p(v,"aria-valuemin","0"),p(v,"aria-valuemax",b=n[1].length),p(s,"class","progress"),p(e,"class","col col-12"),p(t,"class","row"),p(x,"class","btn btn-primary m-3"),x.disabled=I=n[2].length>=n[1].length,p(w,"class","col")},m:function(l,f){y(l,t,f),S(t,e),S(e,r),S(r,i),S(r,o),S(r,a),S(r,u),S(e,c),S(e,s),S(s,v),S(v,m),y(l,_,f),y(l,w,f),S(w,x),S(x,k),K||(C=A(x,"click",U(n[7])),K=!0)},p:function(n,t){4&t&&T!==(T=n[2].length+"")&&j(o,T),2&t&&B!==(B=n[1].length+"")&&j(u,B),4&t&&$!==($=n[2].length+"")&&j(m,$),6&t&&O(v,"width",n[2].length/n[1].length*100+"%"),4&t&&g!==(g=n[2].length)&&p(v,"aria-valuenow",g),2&t&&b!==(b=n[1].length)&&p(v,"aria-valuemax",b),6&t&&I!==(I=n[2].length>=n[1].length)&&(x.disabled=I)},d:function(n){n&&d(t),n&&d(_),n&&d(w),K=!1,C()}}}function hi(n){var t,e,r,i,o,a,u,c,s,v,g=[],b=new ci;function _(t){n[9].call(null,t)}function w(t){n[10].call(null,t)}function x(t){n[11].call(null,t)}var E={};void 0!==n[0]&&(E.index=n[0]),void 0!==n[5]&&(E.enabled=n[5]),void 0!==n[2]&&(E.file_ids=n[2]),t=new ii({props:E}),k.push((function(){return V(t,"index",_)})),k.push((function(){return V(t,"enabled",w)})),k.push((function(){return V(t,"file_ids",x)}));for(var P=n[2],j=function(n){return n[22]},A=0;A<P.length;A+=1){var I=si(n,P,A),K=j(I);b.set(K,g[A]=li(K,I))}var U=n[1]&&n[1].length>0&&fi(n);return{c:function(){F(t.$$.fragment),o=R(),a=l("div");for(var n=0;n<g.length;n+=1)g[n].c();u=R(),c=l("div"),s=l("div"),U&&U.c(),this.h()},l:function(n){M(t.$$.fragment,n),o=D(n),a=f(n,"DIV",{class:!0});for(var e=h(a),r=0;r<g.length;r+=1)g[r].l(e);u=D(e),c=f(e,"DIV",{class:!0,style:!0});var i=h(c);s=f(i,"DIV",{class:!0});var l=h(s);U&&U.l(l),l.forEach(d),i.forEach(d),e.forEach(d),this.h()},h:function(){p(s,"class","container"),p(c,"class","next-batch-placeholder text-center svelte-bpbmli"),O(c,"background-color",n[1]&&n[1].length?"":"transparent"),p(a,"class","gallery")},m:function(e,r){N(t,e,r),y(e,o,r),y(e,a,r);for(var i=0;i<g.length;i+=1)g[i].m(a,null);S(a,u),S(a,c),S(c,s),U&&U.m(s,null),n[14](c),n[15](a),v=!0},p:function(n,o){var l=m(o,1)[0],f={};if(!e&&1&l&&(e=!0,f.index=n[0],L((function(){return e=!1}))),!r&&32&l&&(r=!0,f.enabled=n[5],L((function(){return r=!1}))),!i&&4&l&&(i=!0,f.file_ids=n[2],L((function(){return i=!1}))),t.$set(f),45&l){var h=n[2];C(),g=z(g,l,j,1,n,h,b,a,W,li,u,si),B()}n[1]&&n[1].length>0?U?U.p(n,l):((U=fi(n)).c(),U.m(s,null)):U&&(U.d(1),U=null),(!v||2&l)&&O(c,"background-color",n[1]&&n[1].length?"":"transparent")},i:function(n){if(!v){$(t.$$.fragment,n);for(var e=0;e<P.length;e+=1)$(g[e]);v=!0}},o:function(n){T(t.$$.fragment,n);for(var e=0;e<g.length;e+=1)T(g[e]);v=!1},d:function(e){q(t,e),e&&d(o),e&&d(a);for(var r=0;r<g.length;r+=1)g[r].d();U&&U.d(),n[14](null),n[15](null)}}}function di(n,t,e){var r,i,o=t.file_ids,a=void 0===o?[]:o,u=[],c=t.range,s=void 0===c?10:c,l=t.index,f=void 0===l?0:l,h=0,d=[],p=[],v=0,y=!1;function m(){if(a.length>0&&a.length!==d.length){var n=d.length,t=n+s-1,r=a.slice(n,Math.min(t,a.length));e(2,d=d.concat(r))}}function g(){return(g=w(x.mark((function n(){return x.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r.scrollHeight<window.innerHeight)){n.next=8;break}return m(),n.next=4,G();case 4:return n.next=6,Rr(200);case 6:n.next=0;break;case 8:case"end":return n.stop()}}),n)})))).apply(this,arguments)}_((function(){var n=new IntersectionObserver((function(n){var t,e=ai(n);try{for(e.s();!(t=e.n()).done;){switch(t.value.target){case i:m()}}}catch(n){e.e(n)}finally{e.f()}}));return n.observe(i),function(){n.disconnect()}}));return n.$set=function(n){"file_ids"in n&&e(1,a=n.file_ids),"range"in n&&e(8,s=n.range),"index"in n&&e(0,f=n.index)},n.$$.update=function(){65538&n.$$.dirty&&a!==u&&(e(16,u=a),e(18,v=0),e(0,f=0),e(17,h=0),e(2,d=[])),262145&n.$$.dirty&&e(18,v=Math.max(f,v)),262150&n.$$.dirty&&v>=d.length-2&&a.length>0&&(0===d.length?function(){g.apply(this,arguments)}():m()),131083&n.$$.dirty&&a.length>0&&f!==h&&p&&p[f]&&(e(17,h=f),p[f].scrollIntoView({behavior:"smooth",block:"center",inline:"center"}))},[f,a,d,p,r,y,i,m,s,function(n){e(0,f=n)},function(n){e(5,y=n)},function(n){e(2,d=n)},function(n,t){e(0,f=n),e(5,y=!0)},function(n,t){p[t]!==n&&k[n?"unshift":"push"]((function(){p[t]=n,e(3,p),e(2,d)}))},function(n){k[n?"unshift":"push"]((function(){e(6,i=n)}))},function(n){k[n?"unshift":"push"]((function(){e(4,r=n)}))}]}var pi=function(n){t(r,c);var e=oi(r);function r(n){var t;return i(this,r),t=e.call(this),o(u(t),n,di,hi,a,{file_ids:1,range:8,index:0}),t}return r}();function vi(n){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(n){return!1}}();return function(){var i,o=e(n);if(t){var a=e(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return r(this,i)}}function yi(n,t){var e;if("undefined"==typeof Symbol||null==n[Symbol.iterator]){if(Array.isArray(n)||(e=function(n,t){if(!n)return;if("string"==typeof n)return mi(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);"Object"===e&&n.constructor&&(e=n.constructor.name);if("Map"===e||"Set"===e)return Array.from(n);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return mi(n,t)}(n))||t&&n&&"number"==typeof n.length){e&&(n=e);var r=0,i=function(){};return{s:i,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){e=n[Symbol.iterator]()},n:function(){var n=e.next();return a=n.done,n},e:function(n){u=!0,o=n},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw o}}}}function mi(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}function gi(n,t,e){var r=n.slice();return r[13]=t[e],r}function bi(n){var t,e,r=n[13]+"";return{c:function(){t=l("span"),e=E(r),this.h()},l:function(n){t=f(n,"SPAN",{class:!0});var i=h(t);e=P(i,r),i.forEach(d),this.h()},h:function(){p(t,"class","badge bg-secondary")},m:function(n,r){y(n,t,r),S(t,e)},p:function(n,t){2&t&&r!==(r=n[13]+"")&&j(e,r)},d:function(n){n&&d(t)}}}function _i(n){for(var t,e,r,i,o,a,u,c,s,v,m,g=n[1],b=[],_=0;_<g.length;_+=1)b[_]=bi(gi(n,g,_));return v=new Z({props:{tags:n[1],onSearch:n[4]}}),{c:function(){t=l("div"),e=l("div"),r=l("details"),i=l("summary"),o=l("span"),a=E("Search:"),u=R();for(var n=0;n<b.length;n+=1)b[n].c();c=R(),s=l("div"),F(v.$$.fragment),this.h()},l:function(n){t=f(n,"DIV",{class:!0});var l=h(t);e=f(l,"DIV",{class:!0});var p=h(e);r=f(p,"DETAILS",{});var y=h(r);i=f(y,"SUMMARY",{class:!0});var m=h(i);o=f(m,"SPAN",{});var g=h(o);a=P(g,"Search:"),g.forEach(d),u=D(m);for(var _=0;_<b.length;_+=1)b[_].l(m);m.forEach(d),c=D(y),s=f(y,"DIV",{class:!0});var w=h(s);M(v.$$.fragment,w),w.forEach(d),y.forEach(d),p.forEach(d),l.forEach(d),this.h()},h:function(){p(i,"class","card-header"),p(s,"class","card-body"),p(e,"class","card"),p(t,"class","col")},m:function(l,f){y(l,t,f),S(t,e),S(e,r),S(r,i),S(i,o),S(o,a),S(i,u);for(var h=0;h<b.length;h+=1)b[h].m(i,null);n[3](i),S(r,c),S(r,s),N(v,s,null),m=!0},p:function(n,t){if(2&t){var e;for(g=n[1],e=0;e<g.length;e+=1){var r=gi(n,g,e);b[e]?b[e].p(r,t):(b[e]=bi(r),b[e].c(),b[e].m(i,null))}for(;e<b.length;e+=1)b[e].d(1);b.length=g.length}var o={};2&t&&(o.tags=n[1]),2&t&&(o.onSearch=n[4]),v.$set(o)},i:function(n){m||($(v.$$.fragment,n),m=!0)},o:function(n){T(v.$$.fragment,n),m=!1},d:function(e){e&&d(t),Y(b,e),n[3](null),q(v)}}}function wi(n){var t,e,r,i,o,a,u;function c(t){n[5].call(null,t)}document.title=t=n[1].join(", ")+" - Miia Web!",r=new nn({props:{$$slots:{default:[_i]},$$scope:{ctx:n}}});var s={};return void 0!==n[0]&&(s.file_ids=n[0]),o=new pi({props:s}),k.push((function(){return V(o,"file_ids",c)})),{c:function(){e=R(),F(r.$$.fragment),i=R(),F(o.$$.fragment)},l:function(n){Q('[data-svelte="svelte-1sagjvz"]',document.head).forEach(d),e=D(n),M(r.$$.fragment,n),i=D(n),M(o.$$.fragment,n)},m:function(n,t){y(n,e,t),N(r,n,t),y(n,i,t),N(o,n,t),u=!0},p:function(n,e){var i=m(e,1)[0];(!u||2&i)&&t!==(t=n[1].join(", ")+" - Miia Web!")&&(document.title=t);var c={};65542&i&&(c.$$scope={dirty:i,ctx:n}),r.$set(c);var s={};!a&&1&i&&(a=!0,s.file_ids=n[0],L((function(){return a=!1}))),o.$set(s)},i:function(n){u||($(r.$$.fragment,n),$(o.$$.fragment,n),u=!0)},o:function(n){T(r.$$.fragment,n),T(o.$$.fragment,n),u=!1},d:function(n){n&&d(e),q(r,n),n&&d(i),q(o,n)}}}function xi(n,t,e){var r,i=[],o=[],a=!1;function u(){return(u=w(x.mark((function n(t){var r,o;return x.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!a){n.next=9;break}return r=X(),n.next=4,r.search_files(t,!0,!0);case 4:return o=n.sent,e(0,i=o.file_ids),console.log("Recieved ",i.length," files."),n.next=9,c(i);case 9:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function c(n){return s.apply(this,arguments)}function s(){return(s=w(x.mark((function n(t){var e,r,i,o,u,c,s,l;return x.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!a){n.next=13;break}return e=X(),(r={}).files=jr(),n.next=6,e.get_file_metadata({file_ids:t});case 6:i=n.sent,o=i.metadata,u=[],c=yi(o);try{for(c.s();!(s=c.n()).done;)l=s.value,u.push(Ar(l))}catch(n){c.e(n)}finally{c.f()}return n.next=13,r.files.bulkPut(u);case 13:case"end":return n.stop()}}),n)})))).apply(this,arguments)}_((function(){a=!0;var n=window.location.search,t=new URLSearchParams(n),r=t.get("q");if(r){var i=JSON.parse(r);e(1,o=i)}t.get("id")}));return n.$$.update=function(){2&n.$$.dirty&&function(n){u.apply(this,arguments)}(o)},[i,o,r,function(n){k[n?"unshift":"push"]((function(){e(2,r=n)}))},function(n){console.log("tags set"),e(1,o=n)},function(n){e(0,i=n)}]}var ki=function(n){t(r,c);var e=vi(r);function r(n){var t;return i(this,r),t=e.call(this),o(u(t),n,xi,wi,a,{}),t}return r}();export default ki;
