import{N as e,a as t,O as r,c as n,j as a,r as s,P as i,_ as u,b as o}from"./client.9cafd7a0.js";function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _(t,r,n){return(_=c()?Reflect.construct:function(t,r,n){var a=[null];a.push.apply(a,r);var s=new(Function.bind.apply(t,a));return n&&e(s,n.prototype),s}).apply(null,arguments)}function l(r){var n="function"==typeof Map?new Map:void 0;return(l=function(r){if(null===r||(a=r,-1===Function.toString.call(a).indexOf("[native code]")))return r;var a;if("function"!=typeof r)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(r))return n.get(r);n.set(r,s)}function s(){return _(r,arguments,t(this).constructor)}return s.prototype=Object.create(r.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),e(s,r)})(r)}function f(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=t(e);if(r){var s=t(this).constructor;n=Reflect.construct(a,arguments,s)}else n=a.apply(this,arguments);return o(this,n)}}var p,h={API_VERSION:"/api_version",SESSION_KEY:"/session_key",REQUEST_NEW_PERMISSIONS:"/request_new_permissions",VERIFY_ACCESS_KEY:"/verify_access_key",ADD_FILE:"/add_files/add_file",CLEAN_TAGS:"/add_tags/clean_tags",GET_TAG_SERVICES:"/add_tags/get_tag_services",ADD_TAGS:"/add_tags/add_tags",GET_URL_FILES:"/add_urls/get_url_files",GET_URL_INFO:"/add_urls/get_url_info",ADD_URL:"/add_urls/add_url",ASSOCIATE_URL:"/add_urls/associate_url",GET_COOKIES:"/manage_cookies/get_cookies",SET_COOKIES:"/manage_cookies/set_cookies",GET_PAGES:"/manage_pages/get_pages",GET_PAGE_INFO:"/manage_pages/get_page_info",FOCUS_PAGE:"/manage_pages/focus_page",SEARCH_FILES:"/get_files/search_files",GET_FILE:"/get_files/file",GET_THUMBNAIL:"/get_files/thumbnail",GET_FILE_METADATA:"/get_files/file_metadata"},d={NOT_IN_DATABASE:0,SUCCESSFUL:1,ALREADY_IN_DATABASE:2,PREVIOUSLY_DELETED:3,FAILED:4,VETOED:7},y={ADD_TO_LOCAL:0,DELETE_FROM_LOCAL:1,PEND_TO_REPOSITORY:2,RESCIND_PEND_FROM_REPOSITORY:3,PETITION_FROM_REPOSITORY:4,RESCIND_A_PETITION_FROM_REPOSITORY:5},E={POST_URL:0,FILE_URL:2,GALLERY_URL:3,WATCHABLE_URL:4,UNKNOWN_URL:5},g={IMPORT_URLS:0,IMPORT_FILES:1,ADD_TAGS:2,SEARCH_FILES:3,MANAGE_PAGES:4,MANAGE_COOKIES:5},v={Current:0,Pending:1,Deleted:2,Petitioned:3},b={"Gallery downloader":1,"Simple downloader":2,"Hard drive import":3,Petitions:5,"File search":6,"URL downloader":7,Duplicates:8,"Thread watcher":9,"Page of pages":10},k=function(e){u(r,e);var t=f(r);function r(e){var a;return n(this,r),(a=t.call(this,e)).name=a.constructor.name,a}return r}(l(Error)),S=function(e){u(r,e);var t=f(r);function r(e){var a;return n(this,r),(a=t.call(this,e)).name=a.constructor.name,a}return r}(l(Error)),w=function(e){u(r,e);var t=f(r);function r(e){var a;return n(this,r),(a=t.call(this,e)).name=a.constructor.name,a}return r}(l(Error)),m=function(e){u(r,e);var t=f(r);function r(e){var a;return n(this,r),(a=t.call(this,e)).name=a.constructor.name,a}return r}(l(Error)),T=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,e),this.address="address"in t?t.address:e.default_api_address,this.access_key="key"in t?t.key:""}var t,u,o,c,_,l,f,p,T,x,A,O,I,R,G,P,L,N,D,C,F,U,j;return r(e,[{key:"build_call",value:(j=a(s.mark((function e(t,r){var n,a,u,o,c,_,l=arguments;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>2&&void 0!==l[2]?l[2]:{},""!==this.access_key&&("headers"in n&&"Hydrus-Client-API-Access-Key"in n.headers||("headers"in n||(n.headers={}),n.headers["Hydrus-Client-API-Access-Key"]=this.access_key)),a=this.address+r,"queries"in n){for(u in a+="?",n.queries)n.queries.hasOwnProperty(u)&&(o=n.queries[u],"object"===i(o)&&(o=JSON.stringify(o)),a+=u+"="+o+"&");a=a.substr(0,a.length-1)}return a=encodeURI(a),c="parse"in n?n.parse:"json",e.next=8,fetch(a,{method:t,headers:n.headers,body:"data"in n?n.data:n.json});case 8:if(!(_=e.sent).ok){e.next=21;break}e.t0=c,e.next="blob"===e.t0?13:(e.t0,16);break;case 13:return e.next=15,_.blob();case 15:return e.abrupt("return",e.sent);case 16:return e.next=18,_.json();case 18:return e.abrupt("return",e.sent);case 19:e.next=22;break;case 21:throw new k(_.statusText);case 22:case"end":return e.stop()}}),e,this)}))),function(e,t){return j.apply(this,arguments)})},{key:"api_version",value:(U=a(s.mark((function e(){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.build_call("GET",h.API_VERSION);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(){return U.apply(this,arguments)})},{key:"api_check",value:(F=a(s.mark((function e(){var t,r;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api_version();case 2:if(t=e.sent,!((r=t.version)>13)){e.next=8;break}throw new m("You are using an older version of hydrus.js (".concat(13,") that may not work with the newer api (").concat(r,"). Please check if there is an update available!"));case 8:if(!(13>r)){e.next=10;break}throw new m("This version of hydrus.js (".concat(13,") is built for a newer version of the api than what your hydrus installation is currently using (").concat(r,"). Please update your hydrus."));case 10:case"end":return e.stop()}}),e,this)}))),function(){return F.apply(this,arguments)})},{key:"session_key",value:(C=a(s.mark((function e(){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.build_call("GET",h.SESSION_KEY);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(){return C.apply(this,arguments)})},{key:"request_new_permissions",value:(D=a(s.mark((function e(t,r){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.build_call("GET",h.REQUEST_NEW_PERMISSIONS,{queries:{name:t,basic_permissions:JSON.stringify(r)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return D.apply(this,arguments)})},{key:"verify_access_key",value:(N=a(s.mark((function e(){var t,r,n=arguments;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:"",r=""!==t?{headers:{"Hydrus-Client-API-Access-Key":t}}:{},e.next=4,this.build_call("GET",h.VERIFY_ACCESS_KEY,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(){return N.apply(this,arguments)})},{key:"add_file",value:(L=a(s.mark((function e(t){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.warn("add_file is not tested"),e.next=3,this.build_call("POST",h.ADD_FILE,"path"in t?{json:{path:t.path}}:{headers:{"Content-Type":"application/octet-stream"},data:t.bytes});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return L.apply(this,arguments)})},{key:"add_tags",value:(P=a(s.mark((function e(t,r){var n;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={},"service_names_to_tags"in t||"service_names_to_actions_to_tags"in t){e.next=5;break}throw new S("You must have at least one 'service_names...' argument");case 5:if("object"===i(r)?Object.keys(r).length>1?n.hashes=r:n.hash=r[0]:n.hash=r,"service_names_to_tags"in t&&(n.service_names_to_tags=t.service_names_to_tags),"service_names_to_actions_to_tags"in t&&(n.service_names_to_actions_to_tags=t.service_names_to_actions_to_tags),!("add_siblings_and_parents"in t)){e.next=14;break}if(i(t.add_siblings_and_parents)!==boolean){e.next=13;break}n.add_siblings_and_parents=t.add_siblings_and_parents,e.next=14;break;case 13:throw new w("value of add_siblings_and_parents is of improper type: expects boolean");case 14:return e.next=16,this.build_call("POST",h.ADD_TAGS,{json:n});case 16:return e.abrupt("return",e.sent);case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return P.apply(this,arguments)})},{key:"clean_tags",value:(G=a(s.mark((function e(t){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.build_call("GET",h.CLEAN_TAGS,{queries:{tags:JSON.stringify(t)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return G.apply(this,arguments)})},{key:"get_tag_services",value:(R=a(s.mark((function e(){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.build_call("GET",h.GET_TAG_SERVICES);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(){return R.apply(this,arguments)})},{key:"get_url_files",value:(I=a(s.mark((function e(t){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.build_call("GET",h.GET_URL_FILES,{queries:{url:t}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return I.apply(this,arguments)})},{key:"get_url_info",value:(O=a(s.mark((function e(t,r){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.build_call("GET",h.GET_URL_INFO,{queries:{url:t}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return O.apply(this,arguments)})},{key:"add_url",value:(A=a(s.mark((function e(t){var r;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={},"url"in t){e.next=5;break}throw new S("You must have a url argument");case 5:if(r.url=t.url,"destination_page_name"in t&&(r.destination_page_name=t.destination_page_name),"destination_page_key"in t&&(r.destination_page_key=t.destination_page_key),!("show_destination_page"in t)){e.next=14;break}if("boolean"!=typeof t.show_destination_page){e.next=13;break}r.show_destination_page=t.show_destination_page,e.next=14;break;case 13:throw new w("value of show_destination_page is of improper type: expects boolean");case 14:if(!("service_names_to_tags"in t)){e.next=20;break}if("object"!==i(t.service_names_to_tags)){e.next=19;break}r.service_names_to_tags=t.service_names_to_tags,e.next=20;break;case 19:throw new w("value of service_names_to_tags is of improper type: expects object");case 20:return e.next=22,this.build_call("POST",h.ADD_URL,{json:r});case 22:return e.abrupt("return",e.sent);case 23:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"associate_url",value:(x=a(s.mark((function e(t,r){var n;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={},"to_add"in t||"to_delete"in t){e.next=5;break}throw new S("You must have at least one 'to_delete' or 'to_add' argument");case 5:"to_add"in t&&("object"===i(t.to_add)?Object.keys(t.to_add).length>1?n.urls_to_add=t.to_add:n.url_to_add=t.to_add[0]:n.url_to_add=t.to_add),"to_delete"in t&&("object"===i(t.to_delete)?Object.keys(t.to_delete).length>1?n.urls_to_delete=t.to_delete:n.url_to_delete=t.to_delete[0]:n.url_to_delete=t.to_delete),"object"===i(r)?Object.keys(r).length>1?n.hashes=r:n.hash=r[0]:n.hash=r;case 8:return e.next=10,this.build_call("POST",h.ASSOCIATE_URL,{json:n});case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)}))),function(e,t){return x.apply(this,arguments)})},{key:"search_files",value:(T=a(s.mark((function e(t){var r,n,a=arguments;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]&&a[1],n=a.length>2&&void 0!==a[2]&&a[2],e.next=4,this.build_call("GET",h.SEARCH_FILES,{queries:{tags:JSON.stringify(t),system_inbox:r,system_archive:n}});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return T.apply(this,arguments)})},{key:"get_file_metadata",value:(p=a(s.mark((function e(t){var r;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={},!("file_ids"in t)||!("hashes"in t)){e.next=5;break}throw new w("only one argument is required, choose either file_ids or hashes");case 5:if(!("file_ids"in t)){e.next=11;break}if("object"!==i(t.file_ids)){e.next=10;break}r.file_ids=JSON.stringify(t.file_ids),e.next=11;break;case 10:throw new w("value of file_ids is of improper type: expects list");case 11:if(!("hashes"in t)){e.next=17;break}if("object"!==i(t.hashes)){e.next=16;break}r.hashes=JSON.stringify(t.hashes),e.next=17;break;case 16:throw new w("value of hashes is of improper type: expects list");case 17:"only_return_identifiers"in t&&(r.only_return_identifiers=t.only_return_identifiers);case 18:return console.log(r),e.next=21,this.build_call("GET",h.GET_FILE_METADATA,{queries:r});case 21:return e.abrupt("return",e.sent);case 22:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"get_file",value:(f=a(s.mark((function e(t){var r;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={},!("file_id"in t)||!("hash"in t)){e.next=5;break}throw new w("only one argument is required, choose either file_id or hash");case 5:"file_id"in t&&(r.file_id=t.file_id),"hash"in t&&(r.hash=t.hash);case 7:return e.next=9,this.build_call("GET",h.GET_FILE,{parse:"blob",queries:r});case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"get_thumbnail",value:(l=a(s.mark((function e(t){var r;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={},!("file_id"in t)||!("hash"in t)){e.next=5;break}throw new w("only one argument is required, choose either file_id or hash");case 5:"file_id"in t&&(r.file_id=t.file_id),"hash"in t&&(r.hash=t.hash);case 7:return e.next=9,this.build_call("GET",h.GET_THUMBNAIL,{parse:"blob",queries:r});case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"get_cookies",value:(_=a(s.mark((function e(t){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.build_call("GET",h.GET_COOKIES,{queries:{domain:t}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return _.apply(this,arguments)})},{key:"set_cookies",value:(c=a(s.mark((function e(t){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.build_call("POST",h.SET_COOKIES,{json:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"get_pages",value:(o=a(s.mark((function e(){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.build_call("GET",h.GET_PAGES);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"get_page_info",value:(u=a(s.mark((function e(t){var r;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={},"page_key"in t){e.next=5;break}throw new w("page_key argument required");case 5:r.page_key=t.page_key,"simple"in t&&(r.simple=t.simple);case 7:return e.next=9,this.build_call("GET",h.GET_PAGE_INFO,{queries:r});case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"focus_page",value:(t=a(s.mark((function e(t){var r;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={},!("page_key"in t)){e.next=5;break}r.page_key=t.page_key,e.next=6;break;case 5:throw new w("page_key argument required");case 6:return e.next=8,this.build_call("POST",h.FOCUS_PAGE,{json:r});case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}],[{key:"default_api_address",get:function(){return"http://127.0.0.1:45869"}},{key:"ENDPOINTS",get:function(){return h}},{key:"FILE_STATUS",get:function(){return d}},{key:"TAG_ACTIONS",get:function(){return y}},{key:"URL_TYPE",get:function(){return E}},{key:"PERMISSIONS",get:function(){return g}},{key:"STATUS_NUMBERS",get:function(){return v}},{key:"PAGE_TYPES",get:function(){return b}}]),e}(),x=["image/jpg","image/png","image/gif"];function A(e){return x.includes(e)}function O(e,t){var r={address:e||R()};return r.key=t||function(){try{return JSON.parse(localStorage.getItem("access_key"))}catch(e){return}}(),p=new T(r)}function I(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return p||O(e,t),p.fetch=fetch,p}function R(){try{return JSON.parse(localStorage.getItem("address"))}catch(e){return T.default_api_address}}var G=[T.PERMISSIONS.SEARCH_FILES,T.PERMISSIONS.MANAGE_PAGES];export{I as G,A as I,G as r};
